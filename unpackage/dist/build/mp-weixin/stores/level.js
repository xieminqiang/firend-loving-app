"use strict";const e=require("../common/vendor.js"),t=require("../api/user.js"),s=e.defineStore("level",{state:()=>({serviceLevels:[],isLoading:!1,lastUpdateTime:null}),getters:{sortedServiceLevels:e=>[...e.serviceLevels].sort(((e,t)=>e.level_order-t.level_order)),needUpdate:e=>{if(!e.lastUpdateTime)return!0;return Date.now()-e.lastUpdateTime>36e5}},actions:{setServiceLevels(e){this.serviceLevels=e,this.lastUpdateTime=Date.now()},async fetchServiceLevels(){if(this.serviceLevels.length>0&&!this.needUpdate)return this.serviceLevels;this.isLoading=!0;try{const e=await t.getServiceLevels();if(e.data&&0===e.data.code&&e.data.data){const t=e.data.data||[];return this.setServiceLevels(t),t}return[]}catch(e){return console.error("获取服务等级列表失败:",e),[]}finally{this.isLoading=!1}},clearServiceLevels(){this.serviceLevels=[],this.lastUpdateTime=null}},persist:{key:"level-store",paths:["serviceLevels","lastUpdateTime"]}});exports.useLevelStore=s;
