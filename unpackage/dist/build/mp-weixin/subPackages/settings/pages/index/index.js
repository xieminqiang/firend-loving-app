"use strict";const e=require("../../../../common/vendor.js"),o=require("../../../../common/assets.js"),s=require("../../../../stores/user.js"),n=require("../../../../stores/level.js");require("../../../../config/http.js");const a={__name:"index",setup(a){const i=s.useUserStore(),t=n.useLevelStore(),c=e.computed((()=>i.userInfo&&Object.keys(i.userInfo).length>0)),l=e.computed((()=>i.userInfo||{})),u=e=>{console.log("设置页面收到登录成功事件:",e)};e.onMounted((()=>{e.index.$on("loginSuccess",u)})),e.onUnmounted((()=>{e.index.$off("loginSuccess",u)})),e.onLoad((async()=>{var e,o;console.log("设置页面载入"),console.log("当前用户信息:",i.userInfo),console.log("登录状态:",c.value),console.log("用户昵称:",null==(e=l.value)?void 0:e.nickname),console.log("用户头像:",null==(o=l.value)?void 0:o.avatar)}));const r=()=>{c.value?e.index.navigateTo({url:"/subPackages/settings/pages/index/edit"}):e.index.showModal({title:"提示",content:"请先登录后再设置头像",confirmText:"去登录",cancelText:"取消",success:o=>{o.confirm&&e.index.navigateTo({url:"/subPackages/login/index"})}})},d=()=>{e.index.navigateTo({url:"/subPackages/login/policy"})},g=()=>{e.index.navigateTo({url:"/subPackages/login/agreement"})},v=()=>{e.index.showModal({title:"提示",content:"确认退出账号？",success:async function(o){o.confirm&&(i.clearUserInfo(),t.clearServiceLevels(),e.index.$emit("logoutSuccess"),e.index.showToast({title:"已退出登录",icon:"success"}),setTimeout((()=>{e.index.navigateBack({delta:1})}),1e3))}})};return(s,n)=>e.e({a:c.value},c.value?e.e({b:l.value.head_img},l.value.head_img?{c:s.$imgBaseUrl+l.value.head_img}:{},{d:o._imports_0$3,e:e.o(r)}):{},{f:c.value},c.value?{g:e.t(l.value.nick_name||"未设置昵称"),h:o._imports_0$3,i:e.o(r)}:{},{j:o._imports_0$3,k:e.o(d),l:o._imports_0$3,m:e.o(g),n:c.value},c.value?{o:e.o(v)}:{})}},i=e._export_sfc(a,[["__scopeId","data-v-d0c3d7c0"]]);wx.createPage(i);
