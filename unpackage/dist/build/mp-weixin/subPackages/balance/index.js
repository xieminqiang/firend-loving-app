"use strict";const e=require("../../common/vendor.js"),a=require("../../common/assets.js"),t=require("../../api/order.js"),o=require("../../api/user.js");if(!Array){(e.resolveComponent("u-popup")+e.resolveComponent("u-button")+e.resolveComponent("u-modal"))()}Math||((()=>"../../uni_modules/uview-plus/components/u-popup/u-popup.js")+(()=>"../../uni_modules/uview-plus/components/u-button/u-button.js")+(()=>"../../uni_modules/uview-plus/components/u-modal/u-modal.js"))();const n={__name:"index",setup(n){const l=e.ref({balance:0,available_balance:0,frozen_balance:0}),r=e.ref(!1),s=e.ref([]),u=e.ref(!1),c=e=>{if(!e&&0!==e)return"0.00";const a=Math.floor(e/100),t=e%100;return 0===t?a+".00":t<10?a+".0"+t:a+"."+t},i=e=>{if(!e)return"";const a=new Date(e);return`${(a.getMonth()+1).toString().padStart(2,"0")}-${a.getDate().toString().padStart(2,"0")} ${a.getHours().toString().padStart(2,"0")}:${a.getMinutes().toString().padStart(2,"0")}`},d=()=>{s.value.length>0?r.value=!0:e.index.navigateTo({url:"/subPackages/balance/Withdraw"})},p=()=>{e.index.navigateTo({url:"/subPackages/balance/detail"})},v=()=>{r.value=!1},g=a=>{e.wx$1.canIUse("requestMerchantTransfer")?e.wx$1.requestMerchantTransfer({mchId:"1724024386",appId:e.wx$1.getAccountInfoSync().miniProgram.appId,package:a.package_info,success:e=>{console.log("微信转账确认成功:",e);const t=s.value.findIndex((e=>e.id===a.id));t>-1&&s.value.splice(t,1),u.value=!0,0===s.value.length&&v()},fail:e=>{console.log("微信转账确认失败:",e)}}):e.wx$1.showModal({content:"你的微信版本过低，请更新至最新版本。",showCancel:!1})},m=()=>{u.value=!1};return e.onMounted((()=>{})),e.onShow((()=>{(async()=>{try{const e=await o.getPendingWithdrawList();e.data&&0===e.data.code&&(console.log("待确认提现列表:",e.data.data),s.value=e.data.data.list||[],s.value.length>0&&(r.value=!0))}catch(e){console.error("获取待确认提现列表失败:",e)}})(),(async()=>{try{const e=await t.getCompanionBalanceDetail({});e.data&&0===e.data.code&&(l.value=e.data.data||{balance:0,available_balance:0,frozen_balance:0},console.log("余额信息:",l.value))}catch(e){console.error("获取余额详情失败:",e)}})()})),(t,o)=>({a:a._imports_0$8,b:e.o(p),c:a._imports_0$9,d:e.t(c(l.value.available_balance)),e:e.o(d),f:e.o(v),g:e.f(s.value,((a,t,o)=>{return{a:e.t(i(a.created_at)),b:e.t((n=a.amount,n||0===n?(n/100).toFixed(2):"0.00")),c:e.o((e=>(e=>{console.log("确认收款:",e),g(e)})(a)),a.id),d:a.id};var n})),h:e.o(v),i:e.p({show:r.value,mode:"bottom",round:20,closeOnClickOverlay:!0}),j:e.o(m),k:e.p({text:"确定",type:"success",shape:"circle"}),l:e.o((()=>u.value=!1)),m:e.p({title:"提现已提交成功",show:u.value,content:"您的提现请求已成功提交。提现状态会在后台处理后更新，请稍后查看账户余额或联系客服确认。",closeOnClickOverlay:!0,showCancelButton:!0})})}},l=e._export_sfc(n,[["__scopeId","data-v-7f8f7371"]]);wx.createPage(l);
