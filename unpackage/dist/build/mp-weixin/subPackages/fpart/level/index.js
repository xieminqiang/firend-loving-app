"use strict";const e=require("../../../common/vendor.js"),l=require("../../../api/user.js"),a=require("../../../stores/level.js"),o={__name:"index",setup(o){const r=e.ref(!1),t=e.ref(null),n=e.ref(0),u=a.useLevelStore(),v=e.computed((()=>u.sortedServiceLevels)),i=e.computed((()=>{if(!t.value||!v.value.length)return null;const e=t.value.level_order;return v.value.find((l=>l.level_order>e))})),c=e.computed((()=>{if(!i.value||!n.value)return 0;const e=n.value/i.value.min_stars*100;return Math.min(e,100)})),s=async()=>{r.value=!0;try{await _()}catch(e){console.error("刷新数据失败:",e)}finally{r.value=!1}},d=()=>{r.value=!1},_=async()=>{await(async()=>{try{await u.fetchServiceLevels(),console.log("服务等级列表加载完成")}catch(l){console.error("获取服务等级列表失败:",l),e.index.showToast({title:"获取等级信息失败",icon:"none"})}})(),await(async()=>{try{const e=await l.getApplicatioInfo();if(e.data&&0===e.data.code&&e.data.data){const l=e.data;n.value=l.data.growth_value||0,console.log("userGrowthValue.value",n.value);const a=l.data.level_order;console.log("currentLevelOrder",l),t.value=v.value.find((e=>e.level_order===a))}}catch(e){console.error("获取用户申请信息失败:",e)}})()};return e.onMounted((()=>{_()})),(l,a)=>{var o,u,_,m,f,p,h;return e.e({a:null==(o=t.value)?void 0:o.icon_url,b:e.t((null==(u=t.value)?void 0:u.level_name)||"见习"),c:e.t(n.value),d:e.t(100*((null==(_=t.value)?void 0:_.commission_rate)||.65)),e:i.value},i.value?{f:(null==(m=t.value)?void 0:m.icon_url)||"/static/icons/profile/crown.png",g:e.t((null==(f=t.value)?void 0:f.level_name)||"见习"),h:i.value.icon_url,i:e.t(i.value.level_name),j:e.t(i.value.description),k:e.t(n.value||0),l:c.value+"%",m:e.t(i.value.min_stars)}:{},{n:e.t(100*((null==(p=t.value)?void 0:p.commission_rate)||.65)),o:e.t(100*((null==(h=t.value)?void 0:h.commission_rate)||.65)),p:e.f(v.value,((l,a,o)=>{var r;return{a:l.icon_url,b:e.t(l.level_name),c:e.t(l.description),d:e.t(100*l.commission_rate),e:l.id,f:l.level_order===(null==(r=t.value)?void 0:r.level_order)?1:""}})),q:r.value,r:e.o(s),s:e.o(d)})}}},r=e._export_sfc(o,[["__scopeId","data-v-55be5f31"]]);wx.createPage(r);
