"use strict";const r=require("../common/vendor.js"),i=require("../api/user.js"),a=r.defineStore("level",{state:()=>({serviceLevels:[],isLoading:!1,lastUpdateTime:null}),getters:{sortedServiceLevels:e=>[...e.serviceLevels].sort((t,s)=>t.level_order-s.level_order),needUpdate:e=>{if(!e.lastUpdateTime)return!0;const t=Date.now(),s=60*60*1e3;return t-e.lastUpdateTime>s}},actions:{setServiceLevels(e){this.serviceLevels=e,this.lastUpdateTime=Date.now()},async fetchServiceLevels(){if(this.serviceLevels.length>0&&!this.needUpdate)return this.serviceLevels;this.isLoading=!0;try{const e=await i.getServiceLevels();if(e.data&&e.data.code===0&&e.data.data){const t=e.data.data||[];return this.setServiceLevels(t),t}return[]}catch(e){return r.index.__f__("error","at stores/level.js:54","获取服务等级列表失败:",e),[]}finally{this.isLoading=!1}},clearServiceLevels(){this.serviceLevels=[],this.lastUpdateTime=null}},persist:{key:"level-store",paths:["serviceLevels","lastUpdateTime"]}});exports.useLevelStore=a;
//# sourceMappingURL=../../.sourcemap/mp-weixin/stores/level.js.map
