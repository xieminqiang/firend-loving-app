"use strict";const e=require("../../common/vendor.js"),b=require("../../api/user.js"),h=require("../../stores/level.js");Math||(P+k)();const P=()=>"./components/Workbench.js",k=()=>"./components/Profile.js",m={__name:"index",setup(w){const d=h.useLevelStore(),f=e.ref(0),t=e.ref(0),r=e.ref(null),o=e.ref(!1),s=e.ref(!1);e.onMounted(()=>{const a=e.index.getSystemInfoSync();f.value=a.statusBarHeight||0,i(),e.index.$on("applicationStatusChanged",l),e.index.$on("refreshApplicationInfo",u)}),e.onUnmounted(()=>{e.index.$off("applicationStatusChanged",l),e.index.$off("refreshApplicationInfo",u)});const l=a=>{e.index.__f__("log","at subPackages/partner/index.vue:125","收到申请状态变化事件:",a),a.type==="video_uploaded"&&(e.index.__f__("log","at subPackages/partner/index.vue:129","视频上传成功，刷新申请信息"),i(),d.clearServiceLevels())},u=()=>{e.index.__f__("log","at subPackages/partner/index.vue:145","收到刷新申请信息事件"),i()},p=async()=>{e.index.__f__("log","at subPackages/partner/index.vue:151","开始下拉刷新"),s.value=!0;try{await i()}catch(a){e.index.__f__("error","at subPackages/partner/index.vue:160","下拉刷新失败:",a),e.index.showToast({title:"刷新失败，请重试",icon:"error",duration:2e3})}finally{setTimeout(()=>{s.value=!1},500)}},v=()=>{e.index.__f__("log","at subPackages/partner/index.vue:178","刷新状态恢复")},g=()=>{e.index.__f__("log","at subPackages/partner/index.vue:183","刷新状态中止"),s.value=!1},i=async()=>{var a,c;try{e.index.__f__("log","at subPackages/partner/index.vue:190","开始请求申请信息");const n=await b.getApplicatioInfo();if(e.index.__f__("log","at subPackages/partner/index.vue:192","申请信息请求成功:",n),n.data&&n.data.code===0)r.value=n.data.data,e.index.__f__("log","at subPackages/partner/index.vue:196","申请信息:",r.value),o.value=!0,e.index.__f__("log","at subPackages/partner/index.vue:200","数据准备完成，可以渲染Workbench组件");else throw e.index.__f__("warn","at subPackages/partner/index.vue:202","获取申请信息失败:",((a=n.data)==null?void 0:a.msg)||"未知错误"),o.value=!0,new Error(((c=n.data)==null?void 0:c.msg)||"获取申请信息失败")}catch(n){throw e.index.__f__("error","at subPackages/partner/index.vue:210","获取申请信息失败:",n),o.value=!0,n}},_=a=>{t.value=a},x=a=>{t.value=a.detail.current};return(a,c)=>e.e({a:!o.value},o.value?{b:e.p({applicationInfo:r.value}),c:e.p({applicationInfo:r.value}),d:t.value,e:e.o(x),f:s.value,g:e.o(p),h:e.o(v),i:e.o(g)}:{},{j:o.value},o.value?{k:t.value===0?"/static/icons/tabbar/grid-fill.png":"/static/icons/tabbar/grid.png",l:t.value===0?1:"",m:e.o(n=>_(0)),n:t.value===1?"/static/icons/tabbar/profile-fill.png":"/static/icons/tabbar/profile.png",o:t.value===1?1:"",p:e.o(n=>_(1))}:{})}},I=e._export_sfc(m,[["__scopeId","data-v-16ee0c05"]]);wx.createPage(I);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/subPackages/partner/index.js.map
