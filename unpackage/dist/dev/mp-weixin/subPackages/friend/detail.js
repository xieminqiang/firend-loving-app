"use strict";const e=require("../../common/vendor.js"),o=require("../../common/assets.js"),x=require("../../api/friends.js"),q=require("../../stores/level.js"),L={__name:"detail",setup(C){const l=e.ref({}),f=q.useLevelStore(),$=["提供项目","TA的动态","客户评价"],c=e.ref(0);function w(i){c.value=i}const r=e.ref({}),b=e.ref([]),_=e.ref([]),d=e.computed(()=>!r.value.level_order||!f.sortedServiceLevels.length?null:f.sortedServiceLevels.find(i=>i.level_order===r.value.level_order)),p=[],y=i=>{e.index.navigateTo({url:`/subPackages/order/submit?service_id=${i.service_id}&price_template_id=${i.price_template_id||""}&companion_id=${r.value.application_id}&level_order=${r.value.level_order||""}&nickname=${r.value.nickname}`})},S=async()=>{var i;try{const u={city_code:l.value.city_code,application_id:l.value.id};l.value.latitude&&l.value.longitude&&(u.latitude=parseFloat(l.value.latitude),u.longitude=parseFloat(l.value.longitude));const v=await x.getCityServices(u);if(e.index.__f__("log","at subPackages/friend/detail.vue:194","城市服务信息响应:",v),v.data&&v.data.code===0){const t=v.data.data;e.index.__f__("log","at subPackages/friend/detail.vue:199","城市服务数据:",t),t&&(r.value={avatar:t.avatar,nickname:t.nickname||"未知用户",verified:!0,age:t.age,weight:t.weight,height:t.height,distance:t.distance,tags:t.tags||[],level_order:t.level_order,levelIcon:"",gender:t.gender||""},t.photos&&t.photos.length>0&&(b.value=t.photos.map(g=>({img:g}))),t.services&&t.services.length>0&&(_.value=t.services))}else e.index.__f__("error","at subPackages/friend/detail.vue:233","获取城市服务失败:",((i=v.data)==null?void 0:i.message)||"未知错误")}catch(u){e.index.__f__("error","at subPackages/friend/detail.vue:236","获取城市服务异常:",u)}};return e.onMounted(async()=>{await f.fetchServiceLevels();const i=getCurrentPages(),u=i[i.length-1];l.value=u.options||{},e.index.__f__("log","at subPackages/friend/detail.vue:251","页面参数:",l.value),e.index.__f__("log","at subPackages/friend/detail.vue:252","经纬度参数:",{latitude:l.value.latitude,longitude:l.value.longitude}),l.value.id&&l.value.city_code&&S()}),(i,u)=>{var v,t,g,m;return e.e({a:r.value.avatar,b:e.t(r.value.nickname),c:r.value.verified&&d.value},r.value.verified&&d.value?{d:(v=d.value)==null?void 0:v.icon_url}:{},{e:(t=d.value)==null?void 0:t.level_name},(g=d.value)!=null&&g.level_name?{f:e.t((m=d.value)==null?void 0:m.level_name)}:{},{g:r.value.gender==="女"?"/static/icons/friend/white_nv.png":"/static/icons/friend/white_nan.png",h:e.t(r.value.age),i:e.t(r.value.weight),j:e.t(r.value.height),k:r.value.distance!==""},r.value.distance!==""?{l:o._imports_0$7,m:e.t(r.value.distance)}:{},{n:e.f(b.value,(a,s,h)=>({a:a.img,b:s})),o:o._imports_1$6,p:o._imports_2$4,q:o._imports_3$2,r:e.f($,(a,s,h)=>e.e({a:e.t(a),b:c.value===s},c.value===s?{}:{},{c:a,d:e.n({active:c.value===s}),e:e.o(n=>w(s),a)})),s:_.value.length>0},_.value.length>0?{t:e.f(_.value,(a,s,h)=>({a:i.$imgBaseUrl+a.service_image_url,b:e.t(a.service_name),c:e.f(a.service_tags,(n,k,P)=>({a:e.t(n),b:n})),d:e.t(a.price),e:e.t(a.unit||"小时"),f:e.o(n=>y(a),a.title),g:a.title}))}:{v:o._imports_3},{w:c.value===0,x:o._imports_3,y:c.value===1,z:p.length>0},p.length>0?{A:e.f(p,(a,s,h)=>({a:a.avatar,b:e.t(a.name),c:e.f(5,(n,k,P)=>({a:n,b:e.n({filled:n<=a.stars})})),d:e.t(a.stars>=4?"好评":"中评"),e:e.f(a.tags,(n,k,P)=>({a:e.t(n),b:n})),f:e.t(a.content),g:e.t(a.date),h:s}))}:{B:o._imports_3},{C:c.value===2})}}},T=e._export_sfc(L,[["__scopeId","data-v-21c5b98b"]]);wx.createPage(T);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/subPackages/friend/detail.js.map
