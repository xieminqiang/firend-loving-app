"use strict";const e=require("../../common/vendor.js"),n=require("../../common/assets.js"),v=require("../../api/home.js"),p={__name:"detail",setup(x){const o=e.ref({}),r=e.ref(!0),u=e.ref(""),a=e.ref({}),s=e.ref({});e.onMounted(()=>{const l=getCurrentPages(),i=l[l.length-1];if(o.value=i.options||{},e.index.__f__("log","at subPackages/home/detail.vue:133","详情页参数:",o.value),!o.value.id){u.value="缺少服务ID参数",r.value=!1;return}_()});const _=async()=>{r.value=!0,u.value="";try{const l=await v.getServiceDetail(o.value.id);if(l.data&&l.data.code===0){a.value=l.data.data;const i=o.value.price_template_id||a.value.price_template_id;if(i){e.index.__f__("log","at subPackages/home/detail.vue:159","加载价格模板详情, ID:",i);try{const t=await v.getPriceTemplateDetail(i);t.data&&t.data.code===0?(s.value=t.data.data,e.index.__f__("log","at subPackages/home/detail.vue:164","价格模板加载成功:",s.value)):e.index.__f__("warn","at subPackages/home/detail.vue:166","价格模板接口返回错误:",t.data)}catch(t){e.index.__f__("warn","at subPackages/home/detail.vue:169","获取价格模板失败:",t)}}else e.index.__f__("log","at subPackages/home/detail.vue:172","没有价格模板ID，跳过价格模板加载")}else throw new Error(l.data&&l.data.message||"获取服务详情失败")}catch(l){e.index.__f__("error","at subPackages/home/detail.vue:179","加载数据失败:",l),u.value=l.message||"加载失败，请重试"}finally{r.value=!1}},c=()=>{e.index.__f__("log","at subPackages/home/detail.vue:193","图片加载失败")},d=()=>{if(a.value&&a.value.image_url){const i=a.value.image_url.startsWith("http")?a.value.image_url:"https://sbx-server.oss-cn-shenzhen.aliyuncs.com"+a.value.image_url;e.index.__f__("log","at subPackages/home/detail.vue:206","预览图片URL:",i),e.index.previewImage({urls:[i],current:i,success:()=>{e.index.__f__("log","at subPackages/home/detail.vue:212","图片预览成功")},fail:t=>{e.index.__f__("error","at subPackages/home/detail.vue:215","图片预览失败:",t),e.index.showToast({title:"图片预览失败",icon:"none"})}})}else e.index.showToast({title:"图片加载中，请稍后再试",icon:"none"})},g=()=>{e.index.navigateTo({url:`/subPackages/friend/friend-select?service_id=${a.value.id}`})};return(l,i)=>e.e({a:r.value},r.value?{}:u.value?{}:e.e({c:l.$imgBaseUrl+a.value.image_url,d:e.o(c),e:e.o(d),f:e.t(a.value.name||"服务详情"),g:a.value.min_price},a.value.min_price?e.e({h:e.t(a.value.min_price),i:s.value.unit},s.value.unit?{j:e.t(s.value.unit)}:{}):{},{k:a.value.tags&&a.value.tags.length>0},a.value.tags&&a.value.tags.length>0?{l:e.f(a.value.tags,(t,m,f)=>({a:e.t(t),b:t}))}:{},{m:s.value&&s.value.levels&&s.value.levels.length>0},s.value&&s.value.levels&&s.value.levels.length>0?{n:n._imports_0$1,o:e.f(s.value.levels,(t,m,f)=>e.e({a:e.t(t.level_name),b:t.level_order<=2},t.level_order<=2?{c:e.t(t.level_order===1?"入门":"推荐")}:{},{d:e.t(t.price),e:e.t(t.unit),f:t.id}))}:{},{p:n._imports_1,q:e.t(a.value.description||"暂无详细说明")}),{b:!u.value,r:!r.value&&!u.value},!r.value&&!u.value?{s:e.o(g)}:{},{t:u.value},u.value?{v:n._imports_3,w:e.t(u.value),x:e.o(_)}:{})}},h=e._export_sfc(p,[["__scopeId","data-v-5b390ea8"]]);wx.createPage(h);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/subPackages/home/detail.js.map
