"use strict";const e=require("../../common/vendor.js"),n=require("../../common/assets.js"),v=require("../../api/home.js"),h={__name:"detail",setup(b){const o=e.ref({}),u=e.ref(!0),i=e.ref(""),a=e.ref({}),s=e.ref({});e.onMounted(()=>{const l=getCurrentPages(),r=l[l.length-1];if(o.value=r.options||{},e.index.__f__("log","at subPackages/home/detail.vue:133","详情页参数:",o.value),!o.value.id){i.value="缺少服务ID参数",u.value=!1;return}_()});const _=async()=>{u.value=!0,i.value="";try{const l=await v.getServiceDetail(o.value.id);if(l.data&&l.data.code===0){a.value=l.data.data;const r=o.value.price_template_id||a.value.price_template_id;if(r){e.index.__f__("log","at subPackages/home/detail.vue:159","加载价格模板详情, ID:",r);try{const t=await v.getPriceTemplateDetail(r);t.data&&t.data.code===0?(s.value=t.data.data,e.index.__f__("log","at subPackages/home/detail.vue:164","价格模板加载成功:",s.value)):e.index.__f__("warn","at subPackages/home/detail.vue:166","价格模板接口返回错误:",t.data)}catch(t){e.index.__f__("warn","at subPackages/home/detail.vue:169","获取价格模板失败:",t)}}else e.index.__f__("log","at subPackages/home/detail.vue:172","没有价格模板ID，跳过价格模板加载")}else throw new Error(l.data&&l.data.message||"获取服务详情失败")}catch(l){e.index.__f__("error","at subPackages/home/detail.vue:179","加载数据失败:",l),i.value=l.message||"加载失败，请重试"}finally{u.value=!1}},c=()=>{e.index.navigateBack()},d=()=>{e.index.__f__("log","at subPackages/home/detail.vue:193","图片加载失败")},g=()=>{if(a.value&&a.value.image_url){const r=a.value.image_url.startsWith("http")?a.value.image_url:"https://sbx-server.oss-cn-shenzhen.aliyuncs.com"+a.value.image_url;e.index.__f__("log","at subPackages/home/detail.vue:206","预览图片URL:",r),e.index.previewImage({urls:[r],current:r,success:()=>{e.index.__f__("log","at subPackages/home/detail.vue:212","图片预览成功")},fail:t=>{e.index.__f__("error","at subPackages/home/detail.vue:215","图片预览失败:",t),e.index.showToast({title:"图片预览失败",icon:"none"})}})}else e.index.showToast({title:"图片加载中，请稍后再试",icon:"none"})},m=()=>{e.index.navigateTo({url:`/subPackages/friend/friend-select?service_id=${a.value.id}`})};return(l,r)=>e.e({a:u.value},u.value?{}:i.value?{}:e.e({c:n._imports_0$4,d:e.o(c),e:l.$imgBaseUrl+a.value.image_url,f:e.o(d),g:e.o(g),h:e.t(a.value.name||"服务详情"),i:a.value.min_price},a.value.min_price?e.e({j:e.t(a.value.min_price),k:s.value.unit},s.value.unit?{l:e.t(s.value.unit)}:{}):{},{m:a.value.tags&&a.value.tags.length>0},a.value.tags&&a.value.tags.length>0?{n:e.f(a.value.tags,(t,f,p)=>({a:e.t(t),b:t}))}:{},{o:s.value&&s.value.levels&&s.value.levels.length>0},s.value&&s.value.levels&&s.value.levels.length>0?{p:n._imports_1$4,q:e.f(s.value.levels,(t,f,p)=>e.e({a:e.t(t.level_name),b:t.level_order<=2},t.level_order<=2?{c:e.t(t.level_order===1?"入门":"推荐")}:{},{d:e.t(t.price),e:e.t(t.unit),f:t.id}))}:{},{r:n._imports_2$3,s:e.t(a.value.description||"暂无详细说明")}),{b:!i.value,t:!u.value&&!i.value},!u.value&&!i.value?{v:e.o(m)}:{},{w:i.value},i.value?{x:n._imports_3,y:e.t(i.value),z:e.o(_)}:{})}},x=e._export_sfc(h,[["__scopeId","data-v-5b390ea8"]]);wx.createPage(x);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/subPackages/home/detail.js.map
