"use strict";const e=require("../../common/vendor.js"),b=require("../../api/user.js"),P=require("../../stores/level.js"),k=require("../../stores/user.js");Math||(m+w)();const m=()=>"./components/Workbench.js",w=()=>"./components/Profile.js",I={__name:"index",setup(y){const u=k.useUserStore(),d=P.useLevelStore(),p=e.ref(0),n=e.ref(0),s=e.ref(null),o=e.ref(!1),r=e.ref(!1);e.onMounted(()=>{const a=e.index.getSystemInfoSync();p.value=a.statusBarHeight||0,i(),e.index.$on("applicationStatusChanged",l),e.index.$on("refreshApplicationInfo",f)}),e.onUnmounted(()=>{e.index.$off("applicationStatusChanged",l),e.index.$off("refreshApplicationInfo",f)});const l=a=>{e.index.__f__("log","at subPackages/fpart/index.vue:127","收到申请状态变化事件:",a),a.type==="video_uploaded"&&(e.index.__f__("log","at subPackages/fpart/index.vue:131","视频上传成功，刷新申请信息"),i(),d.clearServiceLevels())},f=()=>{e.index.__f__("log","at subPackages/fpart/index.vue:147","收到刷新申请信息事件"),i()},v=async()=>{e.index.__f__("log","at subPackages/fpart/index.vue:153","开始下拉刷新"),r.value=!0;try{await i()}catch(a){e.index.__f__("error","at subPackages/fpart/index.vue:162","下拉刷新失败:",a),e.index.showToast({title:"刷新失败，请重试",icon:"error",duration:2e3})}finally{setTimeout(()=>{r.value=!1},500)}},g=()=>{e.index.__f__("log","at subPackages/fpart/index.vue:180","刷新状态恢复")},x=()=>{e.index.__f__("log","at subPackages/fpart/index.vue:185","刷新状态中止"),r.value=!1},i=async()=>{var a,c;try{e.index.__f__("log","at subPackages/fpart/index.vue:192","开始请求申请信息");const t=await b.getApplicatioInfo();if(e.index.__f__("log","at subPackages/fpart/index.vue:194","申请信息请求成功:",t),t.data&&t.data.code===0)s.value=t.data.data,e.index.__f__("log","at subPackages/fpart/index.vue:198","申请信息:",s.value),o.value=!0,e.index.__f__("log","at subPackages/fpart/index.vue:202","数据准备完成，可以渲染Workbench组件");else throw e.index.__f__("warn","at subPackages/fpart/index.vue:204","获取申请信息失败:",((a=t.data)==null?void 0:a.msg)||"未知错误"),o.value=!0,new Error(((c=t.data)==null?void 0:c.msg)||"获取申请信息失败")}catch(t){throw e.index.__f__("error","at subPackages/fpart/index.vue:212","获取申请信息失败:",t),o.value=!0,t}},_=a=>{n.value=a},h=a=>{n.value=a.detail.current};return(a,c)=>e.e({a:e.unref(u).switch==1},e.unref(u).switch==1?e.e({b:!o.value},o.value?{c:e.p({applicationInfo:s.value}),d:e.p({applicationInfo:s.value}),e:n.value,f:e.o(h),g:r.value,h:e.o(v),i:e.o(g),j:e.o(x)}:{},{k:o.value},o.value?{l:n.value===0?"/static/icons/tabbar/grid-fill.png":"/static/icons/tabbar/grid.png",m:n.value===0?1:"",n:e.o(t=>_(0)),o:n.value===1?"/static/icons/tabbar/profile-fill.png":"/static/icons/tabbar/profile.png",p:n.value===1?1:"",q:e.o(t=>_(1))}:{}):{})}},S=e._export_sfc(I,[["__scopeId","data-v-51aa3ed6"]]);wx.createPage(S);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/subPackages/fpart/index.js.map
