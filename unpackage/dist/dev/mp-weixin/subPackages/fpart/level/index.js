"use strict";const e=require("../../../common/vendor.js"),k=require("../../../api/user.js"),y=require("../../../stores/level.js"),S={__name:"index",setup(R){const c=e.ref(!1),r=e.ref(null),l=e.ref(0),v=y.useLevelStore(),u=e.computed(()=>v.sortedServiceLevels),t=e.computed(()=>{if(!r.value||!u.value.length)return null;const a=r.value.level_order;return u.value.find(n=>n.level_order>a)}),h=e.computed(()=>{if(!t.value||!l.value)return 0;const a=l.value,n=t.value.min_stars,o=a/n*100;return Math.min(o,100)}),w=async()=>{c.value=!0;try{await _()}catch(a){e.index.__f__("error","at subPackages/fpart/level/index.vue:219","刷新数据失败:",a)}finally{c.value=!1}},P=()=>{c.value=!1},L=async()=>{try{await v.fetchServiceLevels(),e.index.__f__("log","at subPackages/fpart/level/index.vue:233","服务等级列表加载完成")}catch(a){e.index.__f__("error","at subPackages/fpart/level/index.vue:235","获取服务等级列表失败:",a),e.index.showToast({title:"获取等级信息失败",icon:"none"})}},b=async()=>{try{const a=await k.getApplicatioInfo();if(a.data&&a.data.code===0&&a.data.data){const n=a.data;l.value=n.data.growth_value||0,e.index.__f__("log","at subPackages/fpart/level/index.vue:250","userGrowthValue.value",l.value);const o=n.data.level_order;e.index.__f__("log","at subPackages/fpart/level/index.vue:253","currentLevelOrder",n),r.value=u.value.find(i=>i.level_order===o)}}catch(a){e.index.__f__("error","at subPackages/fpart/level/index.vue:257","获取用户申请信息失败:",a)}},_=async()=>{await L(),await b()};return e.onMounted(()=>{_()}),(a,n)=>{var o,i,d,f,p,m,g;return e.e({a:(o=r.value)==null?void 0:o.icon_url,b:e.t(((i=r.value)==null?void 0:i.level_name)||"见习"),c:e.t(l.value),d:e.t((((d=r.value)==null?void 0:d.commission_rate)||.65)*100),e:t.value},t.value?{f:((f=r.value)==null?void 0:f.icon_url)||"/static/icons/profile/crown.png",g:e.t(((p=r.value)==null?void 0:p.level_name)||"见习"),h:t.value.icon_url,i:e.t(t.value.level_name),j:e.t(t.value.description),k:e.t(l.value||0),l:h.value+"%",m:e.t(t.value.min_stars)}:{},{n:e.t((((m=r.value)==null?void 0:m.commission_rate)||.65)*100),o:e.t((((g=r.value)==null?void 0:g.commission_rate)||.65)*100),p:e.f(u.value,(s,M,O)=>{var x;return{a:s.icon_url,b:e.t(s.level_name),c:e.t(s.description),d:e.t(s.commission_rate*100),e:s.id,f:s.level_order===((x=r.value)==null?void 0:x.level_order)?1:""}}),q:c.value,r:e.o(w),s:e.o(P)})}}},q=e._export_sfc(S,[["__scopeId","data-v-9058efa2"]]);wx.createPage(q);
//# sourceMappingURL=../../../../.sourcemap/mp-weixin/subPackages/fpart/level/index.js.map
