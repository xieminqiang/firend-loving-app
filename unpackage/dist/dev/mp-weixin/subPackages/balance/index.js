"use strict";const e=require("../../common/vendor.js"),f=require("../../common/assets.js"),P=require("../../api/order.js"),D=require("../../api/user.js");if(!Array){const i=e.resolveComponent("u-popup"),s=e.resolveComponent("u-button"),o=e.resolveComponent("u-modal");(i+s+o)()}const k=()=>"../../uni_modules/uview-plus/components/u-popup/u-popup.js",F=()=>"../../uni_modules/uview-plus/components/u-button/u-button.js",A=()=>"../../uni_modules/uview-plus/components/u-modal/u-modal.js";Math||(k+F+A)();const S={__name:"index",setup(i){const s=e.ref({balance:0,available_balance:0,frozen_balance:0}),o=e.ref(!1),n=e.ref([]),c=e.ref(!1),p=async()=>{try{const a=await P.getCompanionBalanceDetail({});a.data&&a.data.code===0&&(s.value=a.data.data||{balance:0,available_balance:0,frozen_balance:0},e.index.__f__("log","at subPackages/balance/index.vue:109","余额信息:",s.value))}catch(a){e.index.__f__("error","at subPackages/balance/index.vue:112","获取余额详情失败:",a)}},g=a=>{if(!a&&a!==0)return"0.00";const u=Math.floor(a/100),t=a%100;return t===0?u+".00":t<10?u+".0"+t:u+"."+t},v=a=>!a&&a!==0?"0.00":(a/100).toFixed(2),m=a=>{if(!a)return"";const u=new Date(a),t=(u.getMonth()+1).toString().padStart(2,"0"),r=u.getDate().toString().padStart(2,"0"),d=u.getHours().toString().padStart(2,"0"),_=u.getMinutes().toString().padStart(2,"0");return`${t}-${r} ${d}:${_}`},h=()=>{n.value.length>0?o.value=!0:e.index.navigateTo({url:"/subPackages/balance/Withdraw"})},b=()=>{e.index.navigateTo({url:"/subPackages/balance/detail"})},l=()=>{o.value=!1},w=a=>{e.index.__f__("log","at subPackages/balance/index.vue:180","确认收款:",a),x(a)},x=a=>{e.wx$1.canIUse("requestMerchantTransfer")?e.wx$1.requestMerchantTransfer({mchId:"1724024386",appId:e.wx$1.getAccountInfoSync().miniProgram.appId,package:a.package_info,success:u=>{e.index.__f__("log","at subPackages/balance/index.vue:194","微信转账确认成功:",u);const t=n.value.findIndex(r=>r.id===a.id);t>-1&&n.value.splice(t,1),c.value=!0,n.value.length===0&&l()},fail:u=>{e.index.__f__("log","at subPackages/balance/index.vue:211","微信转账确认失败:",u)}}):e.wx$1.showModal({content:"你的微信版本过低，请更新至最新版本。",showCancel:!1})},y=()=>{c.value=!1},B=async()=>{try{const a=await D.getPendingWithdrawList();a.data&&a.data.code===0&&(e.index.__f__("log","at subPackages/balance/index.vue:256","待确认提现列表:",a.data.data),n.value=a.data.data.list||[],n.value.length>0&&(o.value=!0))}catch(a){e.index.__f__("error","at subPackages/balance/index.vue:265","获取待确认提现列表失败:",a)}};return e.onMounted(()=>{}),e.onShow(()=>{B(),p()}),(a,u)=>({a:f._imports_0$10,b:e.o(b),c:f._imports_0$11,d:e.t(g(s.value.available_balance)),e:e.o(h),f:e.o(l),g:e.f(n.value,(t,r,d)=>({a:e.t(m(t.created_at)),b:e.t(v(t.amount)),c:e.o(_=>w(t),t.id),d:t.id})),h:e.o(l),i:e.p({show:o.value,mode:"bottom",round:20,closeOnClickOverlay:!0}),j:e.o(y),k:e.p({text:"确定",type:"success",shape:"circle"}),l:e.o(()=>c.value=!1),m:e.p({title:"提现已提交成功",show:c.value,content:"您的提现请求已成功提交。提现状态会在后台处理后更新，请稍后查看账户余额或联系客服确认。",closeOnClickOverlay:!0,showCancelButton:!0})})}},$=e._export_sfc(S,[["__scopeId","data-v-4b29ac1b"]]);wx.createPage($);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/subPackages/balance/index.js.map
