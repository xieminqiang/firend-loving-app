"use strict";const n=require("../common/vendor.js"),a=require("../stores/user.js"),r=require("./config.js"),d=r.config.development.baseUrl,s={invoke(t){var e;t.url.startsWith("http")||(t.url=d+t.url),t.timeout=6e5,t.header={...t.header,"source-client":"miniapp"};const o=(e=a.useUserStore().userInfo)==null?void 0:e.access_token;o&&(t.header.Authorization="Bearer "+o)}};n.index.addInterceptor("request",s);n.index.addInterceptor("uploadFile",s);const c=t=>new Promise((i,o)=>{n.index.request({...t,success(e){if(e.statusCode>=200&&e.statusCode<300){if(n.index.__f__("log","at config/http.js:73","222"),e.data&&e.data.code!==void 0&&e.data.code!==0){o(e);return}i(e)}else e.statusCode===401?(n.index.showToast({icon:"none",title:"请先登录"}),o(e)):(n.index.showToast({icon:"none",title:e.data.msg||"请求错误"}),o(e))},fail(e){n.index.showToast({icon:"none",title:"网络错误，换个网络试试"}),o(e)}})});exports.http=c;
//# sourceMappingURL=../../.sourcemap/mp-weixin/config/http.js.map
