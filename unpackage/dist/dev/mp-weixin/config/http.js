"use strict";const o=require("../common/vendor.js"),s=require("../stores/user.js"),d=require("./config.js"),c=d.config.development.baseUrl,a={invoke(t){var e;t.url.startsWith("http")||(t.url=c+t.url),t.timeout=6e5,t.header={...t.header,"source-client":"miniapp"};const i=s.useUserStore(),n=((e=i.userInfo)==null?void 0:e.access_token)||(i==null?void 0:i.token);n&&(t.header.Authorization="Bearer "+n)}};o.index.addInterceptor("request",a);o.index.addInterceptor("uploadFile",a);const r=t=>new Promise((i,n)=>{o.index.request({...t,success(e){if(e.statusCode>=200&&e.statusCode<300){if(o.index.__f__("log","at config/http.js:73","222"),e.data&&e.data.code!==void 0&&e.data.code!==0){n(e);return}i(e)}else e.statusCode===401?(o.index.showToast({icon:"none",title:"请先登录"}),n(e)):(o.index.showToast({icon:"none",title:e.data.msg||"请求错误"}),n(e))},fail(e){o.index.showToast({icon:"none",title:"网络错误，换个网络试试"}),n(e)}})});exports.http=r;
//# sourceMappingURL=../../.sourcemap/mp-weixin/config/http.js.map
