"use strict";const e=require("../../../../../common/vendor.js"),j=require("../../../../../common/assets.js"),L=require("../../../../../api/discover.js");if(!Array){const n=e.resolveComponent("u-list-item"),d=e.resolveComponent("u-list"),r=e.resolveComponent("uni-transition");(n+d+r)()}const C=()=>"../../../../../uni_modules/uview-plus/components/u-list-item/u-list-item.js",I=()=>"../../../../../uni_modules/uview-plus/components/u-list/u-list.js",z=()=>"../../../../../uni_modules/uni-transition/components/uni-transition/uni-transition.js";Math||(e.unref(A)+C+I+z)();const A=()=>"./square-item.js",M={__name:"square-trends-item",props:{listType:{type:Number,default:1},userLocation:{type:Object,default:null},cityStore:{type:Object,default:null}},emits:["changeSayHello","playVideo"],setup(n,{emit:d}){const r=n,u=e.ref([]),l=e.ref(!1),v=e.ref(!0),i=e.ref({page:1,page_size:20}),f=e.ref(0),c=e.ref(0),m=e.ref(!1),_=e.ref(!1),y=d;e.onLoad(()=>{e.index.__f__("log","at pages/tabbar/home/components/cpns/square-trends-item.vue:81","获取数据888"),m.value=!1,i.value.page=1,p(1)});const h=t=>{e.index.__f__("log","at pages/tabbar/home/components/cpns/square-trends-item.vue:90","播放视频2:",t),y("playVideo",t)},p=async(t=1)=>{if(e.index.__f__("log","at pages/tabbar/home/components/cpns/square-trends-item.vue:96","开始获取动态列表数据，参数:",{page:t,listType:r.listType,loading:l.value}),!l.value)try{l.value=!0;const a={list_type:r.listType,page:t,page_size:i.value.page_size};e.index.__f__("log","at pages/tabbar/home/components/cpns/square-trends-item.vue:113","调用API参数:",a);const o=await L.getMomentsList(a);if(e.index.__f__("log","at pages/tabbar/home/components/cpns/square-trends-item.vue:115","API响应:",o),o.data&&o.data.code===0){const s=o.data.data.moments_list||[];e.index.__f__("log","at pages/tabbar/home/components/cpns/square-trends-item.vue:119","获取到的数据:",s),t===1?u.value=s:u.value=[...u.value,...s],v.value=s.length===i.value.page_size,v.value&&i.value.page++}else e.index.__f__("error","at pages/tabbar/home/components/cpns/square-trends-item.vue:135","API返回错误:",o)}catch(a){e.index.__f__("error","at pages/tabbar/home/components/cpns/square-trends-item.vue:138","获取动态列表失败:",a),e.index.showToast({icon:"none",title:"获取数据失败，请重试"})}finally{l.value=!1}};e.watch(()=>r.listType,(t,a)=>{e.index.__f__("log","at pages/tabbar/home/components/cpns/square-trends-item.vue:150","listType变化:",a,"->",t),e.index.__f__("log","at pages/tabbar/home/components/cpns/square-trends-item.vue:151","newVal获取数据获取数据获取数据",t),t&&(i.value.page=1,p(1))},{immediate:!0});const b=t=>{c.value=t.detail.scrollTop},q=()=>{v.value&&!l.value&&p(i.value.page)},x=t=>{f.value=c.value,e.nextTick$1(()=>{f.value=0})},T=async()=>{e.index.__f__("log","at pages/tabbar/home/components/cpns/square-trends-item.vue:180","刷新中~"),!m.value&&(m.value=!0,_.value=!0,await p(1),m.value=!1,_.value=!1)},w=()=>{_.value="restore"},S=async t=>{y("changeSayHello",t)};return(t,a)=>({a:e.f(u.value,(o,s,g)=>({a:e.o(S,s),b:e.o(h,s),c:"1876a6e4-2-"+g+","+("1876a6e4-1-"+g),d:e.p({item:o,listType:n.listType,userLocation:n.userLocation,cityStore:n.cityStore}),e:s,f:"1876a6e4-1-"+g+",1876a6e4-0"})),b:e.p({height:"100%"}),c:f.value,d:_.value,e:e.o(b),f:e.o(q),g:e.o(T),h:e.o(w),i:j._imports_0$18,j:e.sr("ani","1876a6e4-3"),k:e.p({"custom-class":"transition","mode-class":"slide-right",show:c.value>1e3}),l:c.value>1e3,m:e.o(x)})}},P=e._export_sfc(M,[["__scopeId","data-v-1876a6e4"]]);wx.createComponent(P);
//# sourceMappingURL=../../../../../../.sourcemap/mp-weixin/pages/tabbar/home/components/cpns/square-trends-item.js.map
