"use strict";const u=require("./props.js"),m=require("../../libs/mixin/mpMixin.js"),v=require("../../libs/mixin/mixin.js"),a=require("../../libs/function/index.js"),n=require("../../../../common/vendor.js"),f={name:"u-rate",mixins:[m.mpMixin,v.mixin,u.props],data(){return{elId:a.guid(),elClass:a.guid(),rateBoxLeft:0,activeIndex:this.modelValue,rateWidth:0,moving:!1}},watch:{modelValue(e){this.activeIndex=e},activeIndex:"emitEvent"},emits:["update:modelValue","change"],methods:{addStyle:a.addStyle,addUnit:a.addUnit,init(){a.sleep().then(()=>{this.getRateItemRect(),this.getRateIconWrapRect()})},async getRateItemRect(){await a.sleep(),this.$uGetRect("#"+this.elId).then(e=>{this.rateBoxLeft=e.left})},getRateIconWrapRect(){this.$uGetRect("."+this.elClass).then(e=>{this.rateWidth=e.width})},touchMove(e){if(!this.touchable)return;this.preventEvent(e);const o=e.changedTouches[0].pageX;this.getActiveIndex(o)},touchEnd(e){if(!this.touchable)return;this.preventEvent(e);const o=e.changedTouches[0].pageX;this.getActiveIndex(o)},clickHandler(e,o){if(a.os()==="ios"&&this.moving)return;this.preventEvent(e);let c=0;c=e.changedTouches[0].pageX,this.getActiveIndex(c,!0)},emitEvent(){this.$emit("change",this.activeIndex),this.$emit("update:modelValue",this.activeIndex)},getActiveIndex(e,o=!1){if(this.disabled||this.readonly)return;const c=this.rateWidth*this.count+this.rateBoxLeft;e=a.range(this.rateBoxLeft,c,e)-this.rateBoxLeft;const h=e;let i;if(this.allowHalf){i=Math.floor(h/this.rateWidth);const t=h%this.rateWidth;t<=this.rateWidth/2&&t>0?i+=.5:t>this.rateWidth/2&&i++}else{i=Math.floor(h/this.rateWidth);const t=h%this.rateWidth;o?t>0&&i++:t>this.rateWidth/2&&i++}this.activeIndex=Math.min(i,this.count),this.activeIndex<this.minCount&&(this.activeIndex=this.minCount),setTimeout(()=>{this.moving=!0},10),setTimeout(()=>{this.moving=!1},10)}},mounted(){this.init()}};Array||n.resolveComponent("u-icon")();const g=()=>"../u-icon/u-icon.js";Math||g();function I(e,o,c,h,i,t){return{a:n.f(Number(e.count),(d,s,r)=>n.e({a:"69a384ee-0-"+r,b:n.p({name:Math.floor(i.activeIndex)>s?e.activeIcon:e.inactiveIcon,color:e.disabled?"#c8c9cc":Math.floor(i.activeIndex)>s?e.activeColor:e.inactiveColor,"custom-style":{padding:`0 ${t.addUnit(e.gutter/2)}`},size:e.size}),c:n.o(l=>t.clickHandler(l,s+1),s)},e.allowHalf?{d:"69a384ee-1-"+r,e:n.p({name:Math.ceil(i.activeIndex)>s?e.activeIcon:e.inactiveIcon,color:e.disabled?"#c8c9cc":Math.ceil(i.activeIndex)>s?e.activeColor:e.inactiveColor,"custom-style":{padding:`0 ${t.addUnit(e.gutter/2)}`},size:e.size}),f:n.o(l=>t.clickHandler(l,s+1),s),g:n.s({width:t.addUnit(i.rateWidth/2)})}:{},{h:s})),b:e.allowHalf,c:n.n(i.elClass),d:n.o((...d)=>t.touchMove&&t.touchMove(...d)),e:n.o((...d)=>t.touchEnd&&t.touchEnd(...d)),f:i.elId,g:n.s(t.addStyle(e.customStyle))}}const p=n._export_sfc(f,[["render",I],["__scopeId","data-v-69a384ee"]]);wx.createComponent(p);
//# sourceMappingURL=../../../../../.sourcemap/mp-weixin/uni_modules/uview-plus/components/u-rate/u-rate.js.map
