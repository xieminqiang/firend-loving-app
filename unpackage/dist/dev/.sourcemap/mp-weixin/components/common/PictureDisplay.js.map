{"version":3,"file":"PictureDisplay.js","sources":["components/common/PictureDisplay.vue","/Users/xiaoqiang/Documents/friemd/firend-loving-app/components/common/PictureDisplay.vue?type=component"],"sourcesContent":["<template>\n\t<view class=\"picture-display\">\n\t\t<!-- 照片 -->\n\t\t<template v-if=\"props.list.length === 1\">\n\t\t\t<view class=\"trends-one\">\n\t\t\t\t<template v-if=\"list[0].is_video\">\n\t\t\t\t\t<view class=\"video-container\">\n\t\t\t\t\t\t<video class=\"trends-video-one\" :src=\"proxy.$imgBaseUrl + list[0].path\" \n\t\t\t\t\t\t\t:controls=\"false\" :show-center-play-btn=\"false\"  :show-fullscreen-btn=\"false\" :show-progress=\"false\" :enable-progress-gesture=\"false\"\n\t\t\t\t\t\t\t@tap=\"playVideoFullscreen(proxy.$imgBaseUrl + list[0].path)\">\n\t\t\t\t\t\t</video>\n\t\t\t\t\t\t<view class=\"play-icon-overlay\">\n\t\t\t\t\t\t\t<image src=\"/static/find/play.png\" mode=\"widthFix\" class=\"play-icon\"></image>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t</template>\n\n\t\t\t\t<template v-if=\"!list[0].is_video\">\n\t\t\t\t\t<image class=\"trends-image-one\" :src=\"proxy.$imgBaseUrl + list[0].path\" mode=\"aspectFill\"\n\t\t\t\t\t\t@tap.stop=\"showImage(proxy.$imgBaseUrl + list[0].path, 0)\"></image>\n\t\t\t\t</template>\n\t\t\t</view>\n\t\t</template>\n\n\t\t<template v-if=\"props.list.length === 2\">\n\t\t\t<view class=\"trends-two\">\n\t\t\t\t<template v-for=\"(item, index) in list\" :key=\"index\">\n\t\t\t\t\t<template v-if=\"item.is_video\">\n\t\t\t\t\t\t<view class=\"video-container\">\n\t\t\t\t\t\t\t<video class=\"trends-video-two\" :src=\"proxy.$imgBaseUrl + item.path\" \n\t\t\t\t\t\t\t\t:controls=\"false\" :show-center-play-btn=\"false\" :show-fullscreen-btn=\"false\" :show-progress=\"false\" :enable-progress-gesture=\"false\"\n\t\t\t\t\t\t\t\t@tap=\"playVideoFullscreen(proxy.$imgBaseUrl + item.path)\">\n\t\t\t\t\t\t\t</video>\n\t\t\t\t\t\t\t<view class=\"play-icon-overlay\">\n\t\t\t\t\t\t\t\t<image src=\"/static/find/play.png\" mode=\"widthFix\" class=\"play-icon\"></image>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-if=\"!item.is_video\">\n\t\t\t\t\t\t<image class=\"trends-image-two\" :src=\"proxy.$imgBaseUrl + item.path\" mode=\"aspectFill\"\n\t\t\t\t\t\t\t@tap.stop=\"showImage(proxy.$imgBaseUrl + item.path, index)\">\n\t\t\t\t\t\t</image>\n\t\t\t\t\t</template>\n\t\t\t\t</template>\n\t\t\t</view>\n\t\t</template>\n\n\t\t<template v-if=\"props.list.length === 3\">\n\t\t\t<view class=\"trends\">\n\t\t\t\t<template v-for=\"(item, index) in list\" :key=\"index\">\n\t\t\t\t\t<template v-if=\"item.is_video\">\n\t\t\t\t\t\t<view class=\"video-container\">\n\t\t\t\t\t\t\t<video class=\"trends-video\" :src=\"proxy.$imgBaseUrl + item.path\" \n\t\t\t\t\t\t\t\t:controls=\"false\" :show-center-play-btn=\"false\" :show-play-btn=\"false\" :show-fullscreen-btn=\"false\" :show-progress=\"false\" :enable-progress-gesture=\"false\"\n\t\t\t\t\t\t\t\t@tap=\"playVideoFullscreen(proxy.$imgBaseUrl + item.path)\">\n\t\t\t\t\t\t\t</video>\n\t\t\t\t\t\t\t<view class=\"play-icon-overlay\">\n\t\t\t\t\t\t\t\t<image src=\"/static/find/play.png\" mode=\"widthFix\" class=\"play-icon\"></image>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-if=\"!item.is_video\">\n\t\t\t\t\t\t<image class=\"trends-image\" :src=\"proxy.$imgBaseUrl + item.path\" mode=\"aspectFill\"\n\t\t\t\t\t\t\t@tap.stop=\"showImage(proxy.$imgBaseUrl + item.path, index)\">\n\t\t\t\t\t\t</image>\n\t\t\t\t\t</template>\n\t\t\t\t</template>\n\t\t\t</view>\n\t\t</template>\n\n\t\t<template v-if=\"props.list.length === 4\">\n\t\t\t<view class=\"trends-four\">\n\t\t\t\t<template v-for=\"(item, index) in list\" :key=\"index\">\n\t\t\t\t\t<template v-if=\"item.is_video\">\n\t\t\t\t\t\t<view class=\"video-container\">\n\t\t\t\t\t\t\t<video class=\"trends-video-four\" :src=\"proxy.$imgBaseUrl + item.path\" \n\t\t\t\t\t\t\t\t:controls=\"false\" :show-center-play-btn=\"false\" :show-play-btn=\"false\" :show-fullscreen-btn=\"false\" :show-progress=\"false\" :enable-progress-gesture=\"false\"\n\t\t\t\t\t\t\t\t@tap=\"playVideoFullscreen(proxy.$imgBaseUrl + item.path)\">\n\t\t\t\t\t\t\t</video>\n\t\t\t\t\t\t\t<view class=\"play-icon-overlay\">\n\t\t\t\t\t\t\t\t<image src=\"/static/find/play.png\" mode=\"widthFix\" class=\"play-icon\"></image>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-if=\"!item.is_video\">\n\t\t\t\t\t\t<image class=\"trends-image-four\" :src=\"proxy.$imgBaseUrl + item.path\" mode=\"aspectFill\"\n\t\t\t\t\t\t\t@tap.stop=\"showImage(proxy.$imgBaseUrl + item.path, index)\">\n\t\t\t\t\t\t</image>\n\t\t\t\t\t</template>\n\t\t\t\t</template>\n\t\t\t</view>\n\t\t</template>\n\n\t\t<view class=\"hotspot\">\n\t\t\t<template v-for=\"itemTopicList in topicList\" :key=\"itemTopicList\">\n\t\t\t\t<view class=\"hotspot-title\">{{itemTopicList.topic_desc}}</view>\n\t\t\t</template>\n\t\t</view>\n\n\n\n\t</view>\n</template>\n\n<script setup>\n\timport {\n\t\tref,\n\t\tnextTick,\n\t\tgetCurrentInstance,\n\t\twatch,\n\t\tonMounted\n\t} from \"vue\";\n\timport {\n\t\tonLoad,\n\t\tonBackPress\n\t} from '@dcloudio/uni-app'\n\t\n\t// 获取当前实例以访问全局属性\n\tconst { proxy } = getCurrentInstance()\n\t\n\n\t\n\tconst props = defineProps({\n\t\tlist: {\n\t\t\ttype: Array,\n\t\t\tdefault: () => []\n\t\t},\n\t\ttopicList: {\n\t\t\ttype: Array,\n\t\t\tdefault: () => []\n\t\t}\n\t})\n\n\t// 定义emit事件\n\tconst emit = defineEmits(['playVideo'])\n\n\t// 禁止返回\n\t// onBackPress((options) => {\n\t// \tif (options.from == 'backbutton') {\n\t// \t\tsaveShow.value = false\n\t// \t\tpreviewImage.value.show = false\n\t// \t\tclose()\n\t// \t\treturn true;\n\t// \t} else if (options.from == 'navigateBack') {\n\t// \t\treturn false;\n\t// \t}\n\t// })\n\n\t// 预览图片\n\tconst showImage = (item, index) => {\n\t\t// 过滤出只有图片的文件，排除视频\n\t\tconst imageList = props.list.filter(img => !img.is_video)\n\t\t\n\t\t// 如果没有图片，直接返回\n\t\tif (imageList.length === 0) {\n\t\t\tuni.showToast({\n\t\t\t\ttitle: '没有可预览的图片',\n\t\t\t\ticon: 'none',\n\t\t\t\tduration: 1000\n\t\t\t})\n\t\t\treturn\n\t\t}\n\t\t\n\t\t// 构建完整的图片URL数组\n\t\tconst urls = imageList.map(img => {\n\t\t\t// 如果img.path已经是完整路径，直接使用；否则拼接$imgBaseUrl\n\t\t\tif (img.path.startsWith('http')) {\n\t\t\t\treturn img.path\n\t\t\t}\n\t\t\treturn proxy.$imgBaseUrl + img.path\n\t\t})\n\t\t\n\t\t// 计算当前图片在过滤后列表中的索引\n\t\tlet currentIndex = 0\n\t\tif (index !== undefined) {\n\t\t\t// 找到当前点击的图片在过滤后列表中的位置\n\t\t\tconst currentItem = props.list[index]\n\t\t\tif (currentItem && !currentItem.is_video) {\n\t\t\t\tcurrentIndex = imageList.findIndex(img => img.path === currentItem.path)\n\t\t\t}\n\t\t}\n\t\t\n\t\tuni.previewImage({\n\t\t\turls: urls,\n\t\t\tcurrent: currentIndex,\n\t\t\tindicator: 'number',\n\t\t\tloop: true,\n\t\t\tshow: true,\n\t\t\tsuccess: function(res) {\n\t\t\t\tconsole.log('图片预览成功', res);\n\t\t\t},\n\t\t\tfail: function(err) {\n\t\t\t\tconsole.error('图片预览失败', err);\n\t\t\t}\n\t\t});\n\t}\n\t\n\t// 点击视频播放\n\tconst playVideoFullscreen = (videoPath) => {\n\t\tuni.navigateTo({\n\t\t\turl: '/subPackages/dt/video-show',\n\t\t\tanimationType: 'zoom-fade-out',\n\t\t\tanimationDuration: 200,\n\t\t\tsuccess(res) {\n\t\t\t\tres.eventChannel.emit('videoUrl', {\n\t\t\t\t\tdata: videoPath\n\t\t\t\t})\n\t\t\t}\n\t\t})\n\t\t// try {\n\t\t// \tconsole.log('尝试播放视频:', videoPath)\n\t\t// \t// 触发事件，让父组件处理弹框\n\t\t// \temit('playVideo', videoPath)\n\t\t// } catch (error) {\n\t\t// \tconsole.error('视频播放失败:', error)\n\t\t// \tuni.showToast({\n\t\t// \t\ttitle: '视频播放失败',\n\t\t// \t\ticon: 'none',\n\t\t// \t\tduration: 1000\n\t\t// \t})\n\t\t// }\n\t}\n\t\n\n\n\n</script>\n\n<style lang=\"scss\">\n\t.trends-one {\n\t\tpadding-top: 6rpx;\n\t\tdisplay: flex;\n\t\tjustify-content: flex-start;\n\t\tflex-wrap: wrap;\n\n\t\t.trends-image-one {\n\t\t\twidth: 340rpx;\n\t\t\theight: 520rpx;\n\t\t\tborder-radius: 10rpx;\n\t\t\tposition: relative;\n\t\t}\n\n\t\t.trends-video-one {\n\t\t\twidth: 340rpx;\n\t\t\theight: 520rpx;\n\t\t\tborder-radius: 10rpx;\n\t\t\tobject-fit: cover;\n\t\t}\n\t}\n\n\t.trends-two {\n\t\tdisplay: flex;\n\t\tjustify-content: flex-start;\n\t\tflex-wrap: wrap;\n\n\t\t.trends-image-two {\n\t\t\tmargin-right: 6rpx;\n\t\t\tmargin-top: 6rpx;\n\t\t\twidth: 240rpx;\n\t\t\theight: 240rpx;\n\t\t\tborder-radius: 10rpx;\n\t\t}\n\n\t\t.trends-video-two {\n\t\t\tmargin-right: 6rpx;\n\t\t\tmargin-top: 6rpx;\n\t\t\twidth: 240rpx;\n\t\t\theight: 240rpx;\n\t\t\tborder-radius: 10rpx;\n\t\t\tobject-fit: cover;\n\t\t}\n\t}\n\n\t.trends {\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\tjustify-content: flex-start;\n\n\t\t.trends-image {\n\t\t\tmargin-top: 20rpx;\n\t\t\twidth: 198rpx;\n\t\t\theight: 198rpx;\n\t\t\tborder-radius: 10rpx;\n\n\t\t\t&:nth-child(2) {\n\t\t\t\tmargin-left: 6rpx;\n\t\t\t\tmargin-right: 6rpx;\n\t\t\t}\n\t\t}\n\n\t\t.trends-video {\n\t\t\tmargin-top: 20rpx;\n\t\t\twidth: 198rpx;\n\t\t\theight: 198rpx;\n\t\t\tborder-radius: 10rpx;\n\t\t\tobject-fit: cover;\n\n\t\t\t&:nth-child(2) {\n\t\t\t\tmargin-left: 6rpx;\n\t\t\t\tmargin-right: 6rpx;\n\t\t\t}\n\t\t}\n\t}\n\n\t.trends-four {\n\t\tdisplay: flex;\n\t\tjustify-content: flex-start;\n\t\tflex-wrap: wrap;\n\n\t\t.trends-image-four {\n\t\t\tmargin-right: 6rpx;\n\t\t\tmargin-top: 6rpx;\n\t\t\twidth: 240rpx;\n\t\t\theight: 240rpx;\n\t\t\tborder-radius: 10rpx;\n\t\t}\n\n\t\t.trends-video-four {\n\t\t\tmargin-right: 6rpx;\n\t\t\tmargin-top: 6rpx;\n\t\t\twidth: 240rpx;\n\t\t\theight: 240rpx;\n\t\t\tborder-radius: 10rpx;\n\t\t\tobject-fit: cover;\n\t\t}\n\t}\n\n\t.hotspot {\n\t\tmargin-top: 20rpx;\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\tflex-wrap: nowrap;\n\t\tjustify-content: flex-start;\n\n\t\t.hotspot-title {\n\t\t\tmargin-right: 20rpx;\n\t\t\tmargin-bottom: 20rpx;\n\t\t\tfont-size: 24rpx;\n\t\t\tcolor: rgba(115, 99, 255, 1);\n\t\t}\n\t}\n\n\t// 视频容器和播放图标样式\n\t.video-container {\n\t\tposition: relative;\n\t\tdisplay: inline-block;\n\n\t\t.play-icon-overlay {\n\t\t\tposition: absolute;\n\t\t\ttop: 50%;\n\t\t\tleft: 50%;\n\t\t\ttransform: translate(-50%, -50%);\n\t\t\tz-index: 10;\n\t\t\tpointer-events: none; // 确保点击事件能穿透到视频元素\n\n\t\t\t.play-icon {\n\t\t\t\twidth: 60rpx;\n\t\t\t\theight: 60rpx;\n\t\t\t\topacity: 0.8;\n\t\t\t}\n\t\t}\n\t}\n\t\n\t.my-shwo-cal-box {\n\t\tz-index: 99999 !important;\n\t}\n\n\t.my-shwo-cal {\n\t\tmargin: 0 24rpx 24rpx;\n\t\theight: 100rpx;\n\t\tline-height: 100rpx;\n\t\tfont-size: 28rpx;\n\t\tfont-weight: 500;\n\t\t// color: #7363FF;\n\t\ttext-align: center;\n\t\tbackground-color: #ffffff;\n\t\tborder-radius: 20rpx;\n\n\t\t&:active {\n\t\t\tcolor: #7363FF;\n\t\t\tbackground-color: #f2f2f2;\n\t\t}\n\t}\n\n\t:deep(.u-popup__content) {\n\t\tbackground-color: transparent;\n\t}\n\n\n</style>","import Component from '/Users/xiaoqiang/Documents/friemd/firend-loving-app/components/common/PictureDisplay.vue'\nwx.createComponent(Component)"],"names":["proxy","getCurrentInstance","props","__props","showImage","item","index","imageList","img","uni","urls","currentIndex","currentItem","res","err","playVideoFullscreen","videoPath","Component"],"mappings":"2OAsHC,KAAM,CAAE,MAAAA,CAAO,EAAGC,qBAAoB,EAIhCC,EAAQC,EA2BRC,EAAY,CAACC,EAAMC,IAAU,CAElC,MAAMC,EAAYL,EAAM,KAAK,OAAOM,GAAO,CAACA,EAAI,QAAQ,EAGxD,GAAID,EAAU,SAAW,EAAG,CAC3BE,EAAAA,MAAI,UAAU,CACb,MAAO,WACP,KAAM,OACN,SAAU,GACd,CAAI,EACD,MACA,CAGD,MAAMC,EAAOH,EAAU,IAAIC,GAEtBA,EAAI,KAAK,WAAW,MAAM,EACtBA,EAAI,KAELR,EAAM,YAAcQ,EAAI,IAC/B,EAGD,IAAIG,EAAe,EACnB,GAAIL,IAAU,OAAW,CAExB,MAAMM,EAAcV,EAAM,KAAKI,CAAK,EAChCM,GAAe,CAACA,EAAY,WAC/BD,EAAeJ,EAAU,UAAUC,GAAOA,EAAI,OAASI,EAAY,IAAI,EAExE,CAEDH,EAAAA,MAAI,aAAa,CAChB,KAAMC,EACN,QAASC,EACT,UAAW,SACX,KAAM,GACN,KAAM,GACN,QAAS,SAASE,EAAK,CACtBJ,kEAAY,SAAUI,CAAG,CACzB,EACD,KAAM,SAASC,EAAK,CACnBL,oEAAc,SAAUK,CAAG,CAC3B,CACJ,CAAG,CACD,EAGKC,EAAuBC,GAAc,CAC1CP,EAAAA,MAAI,WAAW,CACd,IAAK,6BACL,cAAe,gBACf,kBAAmB,IACnB,QAAQI,EAAK,CACZA,EAAI,aAAa,KAAK,WAAY,CACjC,KAAMG,CACX,CAAK,CACD,CACJ,CAAG,CAaD,61CC5NF,GAAG,gBAAgBC,CAAS"}