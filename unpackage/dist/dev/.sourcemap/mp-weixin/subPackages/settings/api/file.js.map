{"version":3,"file":"file.js","sources":["subPackages/settings/api/file.js"],"sourcesContent":["/**\n * 文件上传相关 API 接口\n */\nimport { http } from '@/config/http.js'\nimport config from '@/config/config.js';\n // const baseURL = 'http://192.168.1.11:8883/v1'\n\nconst baseURL =  process.env.NODE_ENV === 'development' ? config.development.baseUrl : config.production.baseUrl;\n/**\n * 上传文件\n * @param {Object} fileData - 文件数据\n * @param {string} fileData.filePath - 文件路径\n * @param {string} fileData.name - 文件名称\n * @returns {Promise} 返回上传结果\n */\nexport const uploadFile = (fileData) => {\n  return new Promise((resolve, reject) => {\n\t  console.log('开始上传文件:', fileData)\n\n\t   console.log('开始上传文件:eeee', baseURL + '/file/upload')\n    uni.uploadFile({\n      url: baseURL+ '/file/upload',\n      filePath: fileData.filePath,\n      name: 'file',\n      header: {\n        'Authorization': uni.getStorageSync('token') || ''\n      },\n      success: (res) => {\n        try {\n          const data = JSON.parse(res.data)\n          if (data.code === 0) {\n            resolve(data)\n          } else {\n            reject(new Error(data.message || '上传失败'))\n          }\n        } catch (error) {\n          console.error('响应数据解析失败:', error, res.data)\n          reject(new Error('响应数据解析失败'))\n        }\n      },\n      fail: (error) => {\n        console.error('网络请求失败:', error)\n        reject(new Error('网络请求失败'))\n      }\n    })\n  })\n}\n\n/**\n * 批量上传文件\n * @param {Array} fileList - 文件列表\n * @returns {Promise} 返回批量上传结果\n */\nexport const uploadFiles = async (fileList) => {\n  const uploadPromises = fileList.map(fileData => uploadFile(fileData))\n  return Promise.all(uploadPromises)\n}\n\n/**\n * 获取文件上传结果\n * @param {Object} uploadResult - 上传结果\n * @returns {Object} 文件信息\n */\nexport const getUploadResult = (uploadResult) => {\n  if (uploadResult && uploadResult.data) {\n    return {\n      objectKey: uploadResult.data.object_key,\n      url: uploadResult.data.url,\n      cover: uploadResult.data.cover,\n      isVideo: uploadResult.data.is_video\n    }\n  }\n  return null\n}\n"],"names":["baseURL","config","uploadFile","fileData","resolve","reject","uni","res","data","error","getUploadResult","uploadResult"],"mappings":"0IAOMA,EAAoDC,EAAA,OAAO,YAAY,QAQhEC,EAAcC,GAClB,IAAI,QAAQ,CAACC,EAASC,IAAW,CACvCC,EAAA,MAAY,MAAA,MAAA,yCAAA,UAAWH,CAAQ,EAE9BG,EAAA,2DAAY,cAAeN,EAAU,cAAc,EACnDM,EAAAA,MAAI,WAAW,CACb,IAAKN,EAAS,eACd,SAAUG,EAAS,SACnB,KAAM,OACN,OAAQ,CACN,cAAiBG,EAAA,MAAI,eAAe,OAAO,GAAK,EAClD,EACA,QAAUC,GAAQ,CACZ,GAAA,CACF,MAAMC,EAAO,KAAK,MAAMD,EAAI,IAAI,EAC5BC,EAAK,OAAS,EAChBJ,EAAQI,CAAI,EAEZH,EAAO,IAAI,MAAMG,EAAK,SAAW,MAAM,CAAC,QAEnCC,EAAO,CACdH,QAAA,MAAA,QAAA,yCAAc,YAAaG,EAAOF,EAAI,IAAI,EACnCF,EAAA,IAAI,MAAM,UAAU,CAAC,CAC9B,CACF,EACA,KAAOI,GAAU,CACfH,EAAA,MAAA,MAAA,QAAA,yCAAc,UAAWG,CAAK,EACvBJ,EAAA,IAAI,MAAM,QAAQ,CAAC,CAC5B,CAAA,CACD,CAAA,CACF,EAkBUK,EAAmBC,GAC1BA,GAAgBA,EAAa,KACxB,CACL,UAAWA,EAAa,KAAK,WAC7B,IAAKA,EAAa,KAAK,IACvB,MAAOA,EAAa,KAAK,MACzB,QAASA,EAAa,KAAK,QAAA,EAGxB"}