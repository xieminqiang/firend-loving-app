{"version":3,"file":"index.js","sources":["subPackages/settings/pages/index/index.vue","subPackages/settings/pages/index/index.vue?type=page"],"sourcesContent":["<template>\n\t<view class=\"container\">\n\t\t<view class=\"settings-list\">\n\t\t\t<!-- 头像设置 - 仅登录时显示 -->\n\t\t\t<view v-if=\"isLogin\" class=\"setting-item\" @click=\"handleAvatarSetting\">\n\t\t\t\t<view class=\"setting-content flex-between\">\n\t\t\t\t\t<text class=\"setting-text\">头像设置</text>\n\t\t\t\t\t<view class=\"setting-right flex\">\n\t\t\t\t\t\t<view class=\"user-avatar-container\">\n\t\t\t\t\t\t\t<image v-if=\"userInfo.avatar\" \n\t\t\t\t\t\t\t\t:src=\"userInfo.avatar\" \n\t\t\t\t\t\t\t\tclass=\"user-avatar-display\" \n\t\t\t\t\t\t\t\tmode=\"aspectFill\" />\n\t\t\t\t\t\t\t<view v-else class=\"user-avatar-placeholder\">\n\t\t\t\t\t\t\t\t<text class=\"avatar-placeholder-text\">头</text>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t<image class=\"arrow-icon\" src=\"@/static/icons/profile/me_right.png\" mode=\"aspectFit\"></image>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"divider\"></view>\n\t\t\t</view>\n\t\t\t\n\t\t\t<!-- 用户昵称 - 仅登录时显示 -->\n\t\t\t<view v-if=\"isLogin\" class=\"setting-item\" @click=\"handleNicknameSetting\">\n\t\t\t\t<view class=\"setting-content flex-between\">\n\t\t\t\t\t<text class=\"setting-text\">用户昵称</text>\n\t\t\t\t\t<view class=\"setting-right flex\">\n\t\t\t\t\t\t<text class=\"user-nickname\">{{ userInfo.nickname || '未设置昵称' }}</text>\n\t\t\t\t\t\t<image class=\"arrow-icon\" src=\"@/static/icons/profile/me_right.png\" mode=\"aspectFit\"></image>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"divider\"></view>\n\t\t\t</view>\n\t\t\t\n\t\t\t<!-- 隐私政策 -->\n\t\t\t<view class=\"setting-item\" @click=\"handlePrivacyPolicy\">\n\t\t\t\t<view class=\"setting-content flex-between\">\n\t\t\t\t\t<text class=\"setting-text\">隐私政策</text>\n\t\t\t\t\t<image class=\"arrow-icon\" src=\"@/static/icons/profile/me_right.png\" mode=\"aspectFit\"></image>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"divider\"></view>\n\t\t\t</view>\n\t\t\t\n\t\t\t<!-- 用户协议 -->\n\t\t\t<view class=\"setting-item\" @click=\"handleUserAgreement\">\n\t\t\t\t<view class=\"setting-content flex-between\">\n\t\t\t\t\t<text class=\"setting-text\">用户协议</text>\n\t\t\t\t\t<image class=\"arrow-icon\" src=\"@/static/icons/profile/me_right.png\" mode=\"aspectFit\"></image>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"divider\"></view>\n\t\t\t</view>\n\t\t\t\n\t\t\t<!-- 关于我们 -->\n\t\t\t<view class=\"setting-item\" @click=\"handleAboutUs\">\n\t\t\t\t<view class=\"setting-content flex-between\">\n\t\t\t\t\t<text class=\"setting-text\">关于我们</text>\n\t\t\t\t\t<image class=\"arrow-icon\" src=\"@/static/icons/profile/me_right.png\" mode=\"aspectFit\"></image>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\t\t\n\t\t<!-- 退出登录按钮 -->\n\t\t<view class=\"footer-container\" v-if=\"isLogin\">\n\t\t\t<view class=\"logout-btn flex-center\" @click=\"outLogin\">\n\t\t\t\t<text class=\"logout-text\">退出登录</text>\n\t\t\t</view>\n\t\t</view>\n\t</view>\n</template>\n\n<script setup>\n\timport {\n\tref,\n\treactive,\n\tcomputed,\n\tonMounted,\n\tonUnmounted\n} from 'vue'\nimport {\n\tonShow,\n\tonLoad\n} from '@dcloudio/uni-app';\nimport { useUserStore } from '@/stores/user.js'\nimport { useLevelStore } from '@/stores/level.js'\n\nconst userStore = useUserStore()\nconst levelStore = useLevelStore()   \n\t\n\t// 使用computed响应式计算登录状态\n\tconst isLogin = computed(() => {\n\t\treturn userStore.userInfo && Object.keys(userStore.userInfo).length > 0\n\t})\n\t\n\t// 获取用户信息\n\tconst userInfo = computed(() => userStore.userInfo || {})\n\t\n\t// 监听登录成功事件\n\tconst handleLoginSuccess = (data) => {\n\t\tconsole.log('设置页面收到登录成功事件:', data)\n\t\t// 这里可以添加额外的处理逻辑，比如刷新页面数据\n\t}\n\t\n\tonMounted(() => {\n\t\t// 监听登录成功事件\n\t\tuni.$on('loginSuccess', handleLoginSuccess)\n\t})\n\t\n\tonUnmounted(() => {\n\t\t// 移除事件监听\n\t\tuni.$off('loginSuccess', handleLoginSuccess)\n\t})\n\t\n\tonLoad(async () => {\n\t\tconsole.log('设置页面载入')\n\t\tconsole.log('当前用户信息:', userStore.userInfo)\n\t\tconsole.log('登录状态:', isLogin.value)\n\t\tconsole.log('用户昵称:', userInfo.value?.nickname)\n\t\tconsole.log('用户头像:', userInfo.value?.avatar)\n\t});\n\t\n\t// 设置项点击处理\n\tconst handleAvatarSetting = () => {\n\t\tif (!isLogin.value) {\n\t\t\tuni.showModal({\n\t\t\t\ttitle: '提示',\n\t\t\t\tcontent: '请先登录后再设置头像',\n\t\t\t\tconfirmText: '去登录',\n\t\t\t\tcancelText: '取消',\n\t\t\t\tsuccess: (res) => {\n\t\t\t\t\tif (res.confirm) {\n\t\t\t\t\t\tuni.navigateTo({\n\t\t\t\t\t\t\turl: '/subPackages/login/index'\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t\treturn\n\t\t}\n\t\t\n\t\tuni.showToast({\n\t\t\ttitle: '头像设置功能开发中',\n\t\t\ticon: 'none'\n\t\t})\n\t}\n\t\n\tconst handleNicknameSetting = () => {\n\t\tif (!isLogin.value) {\n\t\t\tuni.showModal({\n\t\t\t\ttitle: '提示',\n\t\t\t\tcontent: '请先登录后再设置昵称',\n\t\t\t\tconfirmText: '去登录',\n\t\t\t\tcancelText: '取消',\n\t\t\t\tsuccess: (res) => {\n\t\t\t\t\tif (res.confirm) {\n\t\t\t\t\t\tuni.navigateTo({\n\t\t\t\t\t\t\turl: '/subPackages/login/index'\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t\treturn\n\t\t}\n\t\t\n\t\tuni.showToast({\n\t\t\ttitle: '昵称设置功能开发中',\n\t\t\ticon: 'none'\n\t\t})\n\t}\n\t\n\tconst handlePrivacyPolicy = () => {\n\t\tuni.showToast({\n\t\t\ttitle: '隐私政策页面开发中',\n\t\t\ticon: 'none'\n\t\t})\n\t}\n\t\n\tconst handleUserAgreement = () => {\n\t\tuni.showToast({\n\t\t\ttitle: '用户协议页面开发中',\n\t\t\ticon: 'none'\n\t\t})\n\t}\n\t\n\tconst handleAboutUs = () => {\n\t\tuni.showToast({\n\t\t\ttitle: '关于我们页面开发中',\n\t\t\ticon: 'none'\n\t\t})\n\t}\n\t\n\tconst outLogin = () => {\n\t\tuni.showModal({\n\t\t  title: '提示',\n\t\t  content: '确认退出账号？',\n\t\t  success: async function (res) {\n\t\t    if (!res.confirm) {\n\t\t      return;\n\t\t    }\n\t\t    \n\t\t    // 清除用户信息\n\t\t    userStore.clearUserInfo()\n\t\t    \n\t\t    // 清除等级列表缓存，确保下次登录时获取最新数据\n\t\t    levelStore.clearServiceLevels()\n\t\t    \n\t\t    // 发送退出登录事件，通知其他页面刷新\n\t\t    uni.$emit('logoutSuccess')\n\t\t    \n\t\t    uni.showToast({\n\t\t      title: '已退出登录',\n\t\t      icon: 'success'\n\t\t    })\n\t\t    \n\t\t    // 返回上一页\n\t\t    setTimeout(() => {\n\t\t      uni.navigateBack({\n\t\t        delta: 1\n\t\t      });\n\t\t    }, 1000)\n\t\t  },\n\t\t});\n\t};\n</script>\n\n<style lang=\"scss\" scoped>\n\t@import \"@/styles/variables.scss\";\n\t@import \"@/styles/common.scss\";\n\t\n\t.container {\n\t\twidth: 100vw;\n\t\tmin-height: 100vh;\n\t\tbackground-color: $bg-color-secondary;\n\t\tpadding: 0;\n\t}\n\t\n\t.settings-list {\n\t\tmargin-top: $spacing-base;\n\t\tbackground-color: $bg-color-primary;\n\t\tborder-radius: $border-radius-lg;\n\t\tmargin-left: $spacing-base;\n\t\tmargin-right: $spacing-base;\n\t\toverflow: hidden;\n\t\tbox-shadow: $box-shadow-light;\n\t}\n\t\n\t.setting-item {\n\t\tposition: relative;\n\t\t\n\t\t&:first-child {\n\t\t\t.setting-content {\n\t\t\t\tpadding-top: $spacing-lg;\n\t\t\t}\n\t\t}\n\t\t\n\t\t&:last-child {\n\t\t\t.setting-content {\n\t\t\t\tpadding-bottom: $spacing-lg;\n\t\t\t}\n\t\t\t.divider {\n\t\t\t\tdisplay: none;\n\t\t\t}\n\t\t}\n\t}\n\t\n\t.setting-content {\n\t\tpadding: $spacing-base $spacing-lg;\n\t\tmin-height: 100rpx;\n\t\ttransition: background-color $animation-duration-fast;\n\t\t\n\t\t&:active {\n\t\t\tbackground-color: $bg-color-secondary;\n\t\t}\n\t}\n\t\n\t.setting-right {\n\t\talign-items: center;\n\t\tgap: $spacing-base;\n\t}\n\t\n\t.user-avatar-container {\n\t\twidth: 60rpx;\n\t\theight: 60rpx;\n\t\tborder-radius: 50%;\n\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\toverflow: hidden;\n\t\tbackground: $bg-color-secondary;\n\t}\n\t\n\t.user-avatar-display {\n\t\twidth: 100%;\n\t\theight: 100%;\n\t\tborder-radius: 50%;\n\t}\n\t\n\t.user-avatar-placeholder {\n\t\twidth: 100%;\n\t\theight: 100%;\n\t\tborder-radius: 50%;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tbackground: linear-gradient(135deg, rgba(115, 99, 255, 0.1) 0%, rgba(255, 105, 222, 0.1) 100%);\n\t}\n\t\n\t.avatar-placeholder-text {\n\t\tcolor: $text-color-secondary;\n\t\tfont-size: 20rpx;\n\t\tfont-weight: 500;\n\t}\n\t\n\t.setting-text {\n\t\tcolor: $text-color-primary;\n\t\tfont-size: $font-size-base;\n\t\tfont-weight: 500;\n\t\tline-height: 1.4;\n\t}\n\t\n\t.user-nickname {\n\t\tcolor: $text-color-secondary;\n\t\tfont-size: $font-size-base;\n\t\tfont-weight: 400;\n\t\tmax-width: 240rpx;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t\twhite-space: nowrap;\n\t}\n\t\n\t.arrow-icon {\n\t\twidth: 28rpx;\n\t\theight: 28rpx;\n\n\n\t}\n\t\n\t.divider {\n\t\theight: 1rpx;\n\t\tbackground-color: $border-color-light;\n\t\tmargin-left: $spacing-lg;\n\t\tmargin-right: $spacing-lg;\n\t}\n\t\n\t.footer-container {\n\t\tposition: fixed;\n\t\tbottom: 0;\n\t\tleft: 0;\n\t\tright: 0;\n\t\tpadding: $spacing-base;\n\t\tbackground-color: $bg-color-primary;\n\t    box-sizing: border-box;\n\t\tpadding-bottom: calc(#{$spacing-base} + env(safe-area-inset-bottom));\n\t\tz-index: $z-index-fixed;\n\t}\n\t\n\t.logout-btn {\n\t\twidth: 100%;\n\t\theight: 88rpx;\n\t\tbackground-color: $bg-color-tertiary;\n\t\tborder-radius: $border-radius-xl;\n\t\ttransition: all $animation-duration-fast;\n\t\t\n\t\t&:active {\n\t\t\tbackground-color: #E8E8E8;\n\t\t\ttransform: scale(0.98);\n\t\t}\n\t}\n\t\n\t.logout-text {\n\t\tcolor: $text-color-primary;\n\t\tfont-size: $font-size-base;\n\t\tfont-weight: 500;\n\t}\n</style>","import MiniProgramPage from '/Users/xiaoqiang/Documents/friemd/firend-loving-app/subPackages/settings/pages/index/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["useUserStore","useLevelStore","computed","uni","onMounted","onUnmounted","onLoad"],"mappings":"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"}