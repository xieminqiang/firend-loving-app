{"version":3,"file":"index.js","sources":["subPackages/partner/order/index.vue","subPackages/partner/order/index.vue?type=page"],"sourcesContent":["<template>\n    <view class=\"order-container\">\n      <!-- 状态筛选栏 -->\n      <view class=\"status-filter\">\n        <scroll-view class=\"filter-scroll\" scroll-x=\"true\" show-scrollbar=\"false\">\n          <view class=\"filter-tabs\">\n            <view \n              v-for=\"(tab, index) in statusTabs\" \n              :key=\"index\"\n              class=\"filter-tab\"\n              :class=\"{ active: currentTabIndex === index }\"\n              @click=\"switchStatus(tab.value)\"\n            >\n              <text class=\"tab-text\">{{ tab.label }}</text>\n            </view>\n          </view>\n        </scroll-view>\n      </view>\n  \n      <!-- 订单列表滑动容器 -->\n      <view class=\"order-content\">\n        <swiper\n          class=\"order-swiper\"\n          :current=\"currentTabIndex\"\n          @change=\"onSwiperChange\"\n          :indicator-dots=\"false\"\n          :circular=\"false\"\n          :autoplay=\"false\"\n          :duration=\"300\"\n        >\n          <!-- 每个状态选项卡的内容 -->\n          <swiper-item v-for=\"tab in statusTabs\" :key=\"tab.value\">\n            <scroll-view \n              class=\"order-scroll-view\" \n              scroll-y=\"true\"\n              refresher-enabled=\"true\"\n              :refresher-triggered=\"isRefreshing\"\n              @refresherrefresh=\"onRefresh\"\n              @refresherrestore=\"onRefreshRestore\"\n              @scrolltolower=\"loadMore\"\n            >\n              <!-- 空状态 -->\n              <view v-if=\"getTabOrderList(tab.value).length === 0 && !isLoading\" class=\"empty-state\">\n                <image src=\"@/static/images/empty.png\" class=\"empty-image\" mode=\"aspectFit\" />\n                <text class=\"empty-text\">暂无订单</text>\n                <text class=\"empty-desc\">继续努力，订单会越来越多的</text>\n              </view>\n  \n              <!-- 订单卡片列表 -->\n              <view v-else class=\"order-cards\">\n                <view \n                  v-for=\"order in getTabOrderList(tab.value)\" \n                  :key=\"order.id\"\n                  class=\"order-card\"\n                  @click=\"navigateToDetail(order.id)\"\n                >\n                  <!-- 订单头部 -->\n                  <view class=\"order-header\">\n                    <view class=\"order-info\">\n                      <text class=\"order-time\">{{ formatTime(order.created_at) }}</text>\n                    </view>\n                    <view class=\"order-status\" :class=\"getStatusClass(order.status)\">\n                      <text class=\"status-text\">{{ getStatusText(order.status) }}</text>\n                    </view>\n                  </view>\n  \n                \n  \n                  <!-- 服务信息 -->\n                  <view class=\"service-info\">\n                    <image :src=\"$imgBaseUrl + order.service_image_url\" class=\"service-image\" mode=\"aspectFill\" />\n                    <view class=\"service-details\">\n                      <text class=\"service-name\">{{ order.service_name }}</text>\n                      <view class=\"service-meta\">\n                        <text class=\"service-price\">¥{{ order.unit_price }}/{{ order.unit }}</text>\n                        <text class=\"service-duration\">x{{ order.quantity }}</text>\n                      </view>\n                      <view class=\"service-amount\">\n                        <text class=\"amount-label\">总金额：</text>\n                        <text class=\"amount-value\">¥{{ order.total_amount }}</text>\n                      </view>\n                    </view>\n                  </view>\n  \n                  <!-- 服务信息 服务地址和时间 -->\n                  <view v-if=\"[2, 3, 4, 5, 11].includes(order.status)\" class=\"service-location-time\">\n\n                    <view class=\"location-info\" v-if=\"order.status != 2 && order.user\">\n                      <text class=\"location-label\">服务信息：</text>\n                      <text class=\"location-value\">{{ order?.user?.nick_name }}  {{ order?.user?.phone }}</text>\n                    </view>\n                    <view class=\"location-info\">\n                      <text class=\"location-label\">服务地址：</text>\n                      <view class=\"location-value-container\">\n                        <text class=\"location-value\">{{ order.service_address }}</text>\n                        <view class=\"location-actions\">\n                          <view class=\"nav-btn\" @click.stop=\"openLocation(order)\">\n                            <text class=\"nav-text\">导航</text>\n                          </view>\n                        </view>\n                      </view>\n                    </view>\n                    <view class=\"time-info\">\n                      <text class=\"time-label\">预约时间：</text>\n                      <text class=\"time-value\">{{ formatServiceDateTime(order.service_date, order.service_time) }}</text>\n                    </view>\n                  </view>\n\n                  <!-- 状态4的提示语 -->\n                  <view v-if=\"order.status === 4\" class=\"tip-container\">\n                    <view class=\"auto-start-tip\">\n                      <image src=\"@/static/icons/common/shijian.png\" class=\"tip-icon\" mode=\"aspectFit\" />\n                      <text class=\"tip-text\">您已到达服务地点，5分钟后将自动开始计时服务</text>\n                    </view>\n                  </view>\n  \n                  <!-- 操作按钮 -->\n                  <view class=\"order-actions\">\n                    <view \n                      v-for=\"(action, actionIndex) in getOrderActions(order.status, order)\" \n                      :key=\"actionIndex\"\n                      class=\"action-btn\"\n                      :class=\"action.type\"\n                      @click.stop=\"handleOrderAction(action.action, order)\"\n                    >\n                      <text class=\"action-text\">{{ action.text }}</text>\n                    </view>\n                  </view>\n                </view>\n  \n                <!-- 加载更多 -->\n                <view v-if=\"hasMore && getTabOrderList(tab.value).length > 0\" class=\"load-more\">\n                  <text v-if=\"isLoadingMore\" class=\"loading-text\">加载中...</text>\n                </view>\n              </view>\n\t\t\t         <view style=\"height: 50rpx;\"></view>\n            </scroll-view>\n          </swiper-item>\n        </swiper>\n      </view>\n    </view>\n  </template>\n  \n  <script setup>\n  import { ref, computed, watch, onUnmounted } from 'vue'\n  import { onLoad } from '@dcloudio/uni-app'\n  import { \n  getCompanionOrderList, \n  deleteCompanionOrder,\n  acceptCompanionOrder,\n  rejectCompanionOrder,\n  arrivedCompanionOrder,\n  departCompanionOrder,\n  startCompanionService,\n  endCompanionService\n} from '@/api/order.js'\n  \n  // 页面状态\n  const currentStatus = ref('all')\n  const currentTabIndex = ref(0)\n  const isRefreshing = ref(false)\n  const isLoading = ref(false)\n  const isLoadingMore = ref(false)\n  const hasMore = ref(true)\n  const page = ref(1)\n  const pageSize = ref(20)\n  const companionId = ref(null)\n  \n  // 订单列表数据缓存 - 为每个状态维护独立的列表\n  const orderListCache = ref({})\n  const orderListData = ref({\n    'all': [],\n    'pending_accept': [],\n    'pending_service': [],\n    'in_service': [],\n    'completed': []\n  })\n  \n  // 防抖定时器\n  let swiperChangeTimer = null\n  \n  // 页面卸载时清除定时器\n  onUnmounted(() => {\n    if (swiperChangeTimer) {\n      clearTimeout(swiperChangeTimer)\n    }\n  })\n  \n  // 状态筛选标签\n  const statusTabs = ref([\n    { label: '全部', value: 'all', count: 0 },\n    { label: '待接单', value: 'pending_accept', count: 0 },\n    { label: '待服务', value: 'pending_service', count: 0 },\n    { label: '服务中', value: 'in_service', count: 0 },\n    { label: '已完成', value: 'completed', count: 0 }\n  ])\n  \n  // 处理页面参数\n  onLoad((options) => {\n    console.log('友伴订单页面接收到的参数:', options)\n    \n    // 保存companion_id\n    if (options.companion_id) {\n      console.log('设置companion_id为:', options.companion_id)\n      companionId.value = options.companion_id\n    }\n    \n    if (options.status) {\n      console.log('设置订单状态为:', options.status)\n      currentStatus.value = options.status\n      // 设置对应的选项卡索引\n      const statusIndex = statusTabs.value.findIndex(tab => tab.value === options.status)\n      if (statusIndex !== -1) {\n        currentTabIndex.value = statusIndex\n      }\n      // 重置页面状态\n      page.value = 1\n      hasMore.value = true\n      // 清除缓存，强制重新加载\n      delete orderListCache.value[options.status]\n    } else {\n      console.log('没有传递状态参数，使用默认状态: all')\n      currentStatus.value = 'all'\n      currentTabIndex.value = 0\n    }\n    \n    // 在onLoad中加载数据\n    console.log('onLoad中加载数据，当前状态:', currentStatus.value)\n    loadOrderList()\n  })\n  \n  // 监听状态变化\n  watch(currentStatus, (newStatus, oldStatus) => {\n    console.log('状态变化:', oldStatus, '->', newStatus)\n  })\n  \n  // 切换状态筛选\n  const switchStatus = async (status) => {\n    if (currentStatus.value === status) return // 避免重复切换\n    \n    currentStatus.value = status\n    const statusIndex = statusTabs.value.findIndex(tab => tab.value === status)\n    if (statusIndex !== -1) {\n      currentTabIndex.value = statusIndex\n    }\n    \n    // 检查缓存中是否已有该状态的数据\n    if (orderListCache.value[status]) {\n      // 从缓存恢复数据\n      orderListData.value[status] = orderListCache.value[status].list\n      page.value = orderListCache.value[status].page\n      hasMore.value = orderListCache.value[status].hasMore\n    } else {\n      // 缓存中没有数据，需要请求\n      page.value = 1\n      hasMore.value = true\n      orderListData.value[status] = []\n      \n      try {\n        await loadOrderList()\n      } catch (error) {\n        console.error('切换状态失败:', error)\n      }\n    }\n  }\n  \n  // swiper滑动改变时的处理\n  const onSwiperChange = async (e) => {\n    const index = e.detail.current\n    const newStatus = statusTabs.value[index].value\n    const oldStatus = currentStatus.value\n    \n    currentTabIndex.value = index\n    currentStatus.value = newStatus\n    \n    // 清除之前的定时器\n    if (swiperChangeTimer) {\n      clearTimeout(swiperChangeTimer)\n    }\n    \n    // 如果切换到新的状态且该状态未加载数据，则延迟加载数据（防抖）\n    if (oldStatus !== newStatus && !orderListCache.value[newStatus]) {\n      swiperChangeTimer = setTimeout(async () => {\n        page.value = 1\n        hasMore.value = true\n        orderListData.value[newStatus] = []\n        await loadOrderList()\n      }, 300) // 300ms防抖延迟\n    }\n  }\n  \n  // 获取指定状态的订单列表\n  const getTabOrderList = (status) => {\n    return orderListData.value[status] || []\n  }\n  \n  // 加载订单列表\n  const loadOrderList = async () => {\n    if (isLoading.value) return\n    \n    isLoading.value = true\n    \n    try {\n      const params = {\n        page: page.value,\n        page_size: pageSize.value,\n        companion_id: Number(companionId.value)\n      }\n      \n      // 根据状态添加不同的参数\n      if (currentStatus.value === 'all') {\n        // 全部状态不传状态参数\n      } else if (currentStatus.value === 'pending_accept') {\n        params.status = 2\n      } else if (currentStatus.value === 'pending_service') {\n        params.status_group = 'pending_service'\n      } else if (currentStatus.value === 'in_service') {\n        params.status = 5\n      } else if (currentStatus.value === 'completed') {\n        params.status = 6\n      }\n      \n      const response = await getCompanionOrderList(params)\n      console.log(\"response.data\", response.data)\n      \n      if (response.data.code === 0) {\n        const { list, total } = response.data.data\n        \n        if (page.value === 1) {\n          orderListData.value[currentStatus.value] = list || []\n          // 更新当前状态的计数\n          updateCurrentStatusCount(total)\n        } else {\n          orderListData.value[currentStatus.value].push(...(list || []))\n        }\n        \n        hasMore.value = orderListData.value[currentStatus.value].length < total\n        \n        // 缓存当前状态的数据\n        orderListCache.value[currentStatus.value] = {\n          list: [...orderListData.value[currentStatus.value]],\n          page: page.value,\n          hasMore: hasMore.value\n        }\n      } else {\n        throw new Error(response.data.msg || '获取订单列表失败')\n      }\n    } catch (error) {\n      console.error('加载订单列表失败:', error)\n      uni.showToast({\n        title: error.message || '加载失败',\n        icon: 'none'\n      })\n    } finally {\n      isLoading.value = false\n    }\n  }\n  \n  // 更新当前状态的计数\n  const updateCurrentStatusCount = (total) => {\n    const currentTab = statusTabs.value.find(tab => tab.value === currentStatus.value)\n    if (currentTab) {\n      currentTab.count = total || 0\n    }\n  }\n  \n  // 下拉刷新\n  const onRefresh = async () => {\n    if (isRefreshing.value) return // 防止重复刷新\n    \n    isRefreshing.value = true\n    page.value = 1\n    hasMore.value = true\n    \n    // 清除当前状态的缓存，强制重新加载\n    delete orderListCache.value[currentStatus.value]\n    \n    try {\n      await loadOrderList()\n      \n      // 模拟加载时间，确保用户能看到刷新动画\n      await new Promise(resolve => setTimeout(resolve, 800))\n    } catch (error) {\n      console.error('刷新失败:', error)\n    } finally {\n      isRefreshing.value = false\n    }\n  }\n  \n  const onRefreshRestore = () => {\n    isRefreshing.value = false\n  }\n  \n  // 加载更多\n  const loadMore = async () => {\n    if (isLoadingMore.value || !hasMore.value) return\n    \n    isLoadingMore.value = true\n    page.value++\n    \n    try {\n      await loadOrderList()\n    } catch (error) {\n      console.error('加载更多失败:', error)\n      page.value--\n    } finally {\n      isLoadingMore.value = false\n    }\n  }\n  \n  // 获取状态样式类\n  const getStatusClass = (status) => {\n    const statusMap = {\n      1: 'status-pending',      // 待付款\n      2: 'status-to-serve',     // 已支付待确认\n      3: 'status-to-serve',     // 已确认待到达\n      4: 'status-to-serve',     // 已到达待开始\n      5: 'status-in-progress',  // 进行中\n      6: 'status-completed',    // 已完成\n      7: 'status-cancelled',    // 已取消\n      8: 'status-cancelled',    // 已取消（原已退款）\n      9: 'status-cancelled',    // 已取消（原退款中）\n      11: 'status-to-serve'     // 已确认待开始出发\n    }\n    return statusMap[status] || 'status-default'\n  }\n  \n  // 获取状态文本\n  const getStatusText = (status) => {\n    const statusMap = {\n      1: '待付款',\n      2: '等待接单',\n      3: '我已出发',\n      4: '已到达，等待开始服务',\n      5: '服务中',\n      6: '已完成',\n      7: '已取消',\n      8: '已取消',\n      9: '已取消',\n      11: '待服务'\n    }\n    return statusMap[status] || '未知状态'\n  }\n  \n  // 获取订单操作按钮\n  const getOrderActions = (status, order) => {\n    const actionMap = {\n      2: [ // 已支付待确认\n        { text: '拒绝', action: 'reject', type: 'secondary' },\n        { text: '接单', action: 'accept', type: 'primary' }\n      ],\n      3: [ // 已确认待到达\n        { text: '电话联系', action: 'contact', type: 'secondary' },\n        { text: '我已到达服务地点', action: 'arrived', type: 'primary' }\n      ],\n      4: [ // 已到达待开始\n        { text: '电话联系', action: 'call', type: 'secondary' }\n      ],\n      5: [ // 服务中\n        { text: '电话联系', action: 'contact', type: 'secondary' },\n        { text: '结束服务', action: 'end', type: 'primary' }\n      ],\n      6: [ // 已完成\n        ...(order.is_comment === 1 ? [{ text: '查看评价', action: 'review', type: 'secondary' }] : []),\n        { text: '删除订单', action: 'delete', type: 'secondary' }\n        // { text: '再次服务', action: 'rebook', type: 'primary' }\n      ],\n      7: [ // 已取消\n        { text: '删除订单', action: 'delete', type: 'secondary' }\n      ],\n      8: [ // 已取消（原已退款）\n\n        { text: '删除订单', action: 'delete', type: 'secondary' }\n      ],\n      9: [ // 已取消（原退款中）\n        { text: '订单已取消，给客户退款中', action: 'info', type: 'info' }\n      ],\n      11: [ // 已确认待开始出发\n        { text: '电话联系', action: 'contact', type: 'secondary' },\n        { text: '我已出发', action: 'depart', type: 'depart' }\n      ]\n    }\n    return actionMap[status] || []\n  }\n  \n  // 处理订单操作\n  const handleOrderAction = (action, order) => {\n    switch (action) {\n      case 'contact':\n        handleContactCustomer(order)\n        break\n      case 'accept':\n        handleAcceptOrder(order)\n        break\n      case 'reject':\n        handleRejectOrder(order)\n        break\n      case 'arrived':\n        handleArrived(order)\n        break\n      case 'depart':\n        handleDepart(order)\n        break\n      case 'call':\n        handleCallCustomer(order)\n        break\n      case 'start':\n        handleStartService(order)\n        break\n      case 'end':\n        handleEndService(order)\n        break\n      case 'review':\n        handleViewReview(order)\n        break\n      case 'rebook':\n        handleRebookService(order)\n        break\n      case 'delete':\n        handleDeleteOrder(order)\n        break\n      case 'info':\n        // 信息提示，不执行任何操作\n        break\n    }\n  }\n  \n  // 电话联系客户\n  const handleContactCustomer = (order) => {\n    if (order.user && order.user.phone) {\n      uni.showModal({\n        title: '电话联系',\n        content: `是否拨打客户 ${order.user.nick_name} 的电话？`,\n        confirmText: '拨打',\n        cancelText: '取消',\n        success: (res) => {\n          if (res.confirm) {\n            uni.makePhoneCall({\n              phoneNumber: order.user.phone\n            })\n          }\n        }\n      })\n    }\n  }\n\n  // 接单\n  const handleAcceptOrder = (order) => {\n    uni.showModal({\n      title: '确认接单',\n      content: '确定要接受这个订单吗？',\n      confirmText: '接单',\n      cancelText: '取消',\n      success: async (res) => {\n        if (res.confirm) {\n          try {\n            uni.showLoading({\n              title: '处理中...'\n            })\n            \n            const response = await acceptCompanionOrder({ \n              order_id: order.id,\n              companion_id: Number(companionId.value)\n            })\n            \n            if (response.data.code === 0) {\n              uni.showToast({\n                title: '接单成功',\n                icon: 'success'\n              })\n              \n              // 跳转到待服务状态\n              const pendingServiceIndex = statusTabs.value.findIndex(tab => tab.value === 'pending_service')\n              if (pendingServiceIndex !== -1) {\n                currentTabIndex.value = pendingServiceIndex\n                currentStatus.value = 'pending_service'\n              }\n              \n              // 清除待服务状态的缓存，强制重新加载\n              delete orderListCache.value['pending_service']\n              \n              // 刷新待服务状态的列表\n              page.value = 1\n              hasMore.value = true\n              orderListData.value['pending_service'] = []\n              await loadOrderList()\n            } else {\n              throw new Error(response.data.msg || '接单失败')\n            }\n          } catch (error) {\n            console.error('接单失败:', error)\n            uni.showToast({\n              title: error.message || '接单失败',\n              icon: 'none'\n            })\n          } finally {\n            uni.hideLoading()\n          }\n        }\n      }\n    })\n  }\n\n  // 拒绝订单\n  const handleRejectOrder = (order) => {\n    uni.showModal({\n      title: '拒绝订单',\n      content: '确定要拒绝这个订单吗？',\n      confirmText: '拒绝',\n      cancelText: '取消',\n      success: async (res) => {\n        if (res.confirm) {\n          try {\n            uni.showLoading({\n              title: '处理中...'\n            })\n            \n            const response = await rejectCompanionOrder({ \n              order_id: order.id,\n              companion_id: Number(companionId.value)\n            })\n            \n            if (response.data.code === 0) {\n              uni.showToast({\n                title: '已拒绝订单',\n                icon: 'success'\n              })\n              \n              // 刷新列表\n              onRefresh()\n            } else {\n              throw new Error(response.data.msg || '拒绝订单失败')\n            }\n          } catch (error) {\n            console.error('拒绝订单失败:', error)\n            uni.showToast({\n              title: error.message || '操作失败',\n              icon: 'none'\n            })\n          } finally {\n            uni.hideLoading()\n          }\n        }\n      }\n    })\n  }\n\n  // 我已到达\n  const handleArrived = (order) => {\n    uni.showModal({\n      title: '确认到达',\n      content: '确认您已到达服务地点？',\n      confirmText: '确认',\n      cancelText: '取消',\n      success: async (res) => {\n        if (res.confirm) {\n          try {\n            uni.showLoading({\n              title: '更新中...'\n            })\n            \n            const response = await arrivedCompanionOrder({ \n              order_id: order.id,\n              companion_id: Number(companionId.value)\n            })\n            \n            if (response.data.code === 0) {\n              uni.showToast({\n                title: '已确认到达',\n                icon: 'success'\n              })\n              \n              // 刷新列表\n              onRefresh()\n            } else {\n              throw new Error(response.data.msg || '确认到达失败')\n            }\n          } catch (error) {\n            console.error('确认到达失败:', error)\n            uni.showToast({\n              title: error.message || '操作失败',\n              icon: 'none'\n            })\n          } finally {\n            uni.hideLoading()\n          }\n        }\n      }\n    })\n  }\n\n  // 电话联系客户\n  const handleCallCustomer = (order) => {\n    if (order.user && order.user.phone) {\n      uni.showModal({\n        title: '电话联系',\n        content: `是否拨打客户 ${order.user.nick_name} 的电话？`,\n        confirmText: '拨打',\n        cancelText: '取消',\n        success: (res) => {\n          if (res.confirm) {\n            uni.makePhoneCall({\n              phoneNumber: order.user.phone\n            })\n          }\n        }\n      })\n    }\n  }\n\n  // 我已出发\n  const handleDepart = (order) => {\n    uni.showModal({\n      title: '确认出发',\n      content: '确认您已开始出发前往服务地点？',\n      confirmText: '确认',\n      cancelText: '取消',\n      success: async (res) => {\n        if (res.confirm) {\n          try {\n            uni.showLoading({\n              title: '更新中...'\n            })\n            \n            const response = await departCompanionOrder({ \n              order_id: order.id,\n              companion_id: Number(companionId.value)\n            })\n            \n            if (response.data.code === 0) {\n              uni.showToast({\n                title: '已确认出发',\n                icon: 'success'\n              })\n              \n              // 刷新列表\n              onRefresh()\n            } else {\n              throw new Error(response.data.msg || '确认出发失败')\n            }\n          } catch (error) {\n            console.error('确认出发失败:', error)\n            uni.showToast({\n              title: error.message || '操作失败',\n              icon: 'none'\n            })\n          } finally {\n            uni.hideLoading()\n          }\n        }\n      }\n    })\n  }\n  \n  // 开始服务\n  const handleStartService = (order) => {\n    uni.showModal({\n      title: '开始服务',\n      content: '确定要开始服务吗？',\n      confirmText: '开始',\n      cancelText: '取消',\n      success: async (res) => {\n        if (res.confirm) {\n          try {\n            uni.showLoading({\n              title: '更新中...'\n            })\n            \n            const response = await startCompanionService({ \n              order_id: order.id,\n              companion_id: Number(companionId.value)\n            })\n            \n            if (response.data.code === 0) {\n              uni.showToast({\n                title: '服务已开始',\n                icon: 'success'\n              })\n              \n              // 刷新列表\n              onRefresh()\n            } else {\n              throw new Error(response.data.msg || '开始服务失败')\n            }\n          } catch (error) {\n            console.error('开始服务失败:', error)\n            uni.showToast({\n              title: error.message || '操作失败',\n              icon: 'none'\n            })\n          } finally {\n            uni.hideLoading()\n          }\n        }\n      }\n    })\n  }\n  \n  // 结束服务\n  const handleEndService = (order) => {\n    uni.showModal({\n      title: '结束服务',\n      content: '确定要结束服务吗？',\n      confirmText: '结束',\n      cancelText: '取消',\n      success: async (res) => {\n        if (res.confirm) {\n          try {\n            uni.showLoading({\n              title: '更新中...'\n            })\n            \n            const response = await endCompanionService({ \n              order_id: order.id,\n              companion_id: Number(companionId.value)\n            })\n            \n            if (response.data.code === 0) {\n              uni.showToast({\n                title: '服务已结束',\n                icon: 'success'\n              })\n              \n              // 刷新列表\n              onRefresh()\n            } else {\n              throw new Error(response.data.msg || '结束服务失败')\n            }\n          } catch (error) {\n            console.error('结束服务失败:', error)\n            uni.showToast({\n              title: error.message || '操作失败',\n              icon: 'none'\n            })\n          } finally {\n            uni.hideLoading()\n          }\n        }\n      }\n    })\n  }\n  \n  // 查看评价\n  const handleViewReview = (order) => {\n    uni.navigateTo({\n      url: `/subPackages/partner/order/partner-evaluate?orderId=${order.id}&companion_id=${companionId.value}`\n    })\n  }\n  \n  // 再次服务\n  const handleRebookService = (order) => {\n    uni.navigateTo({\n      url: `/subPackages/partner/rebook?orderId=${order.id}`\n    })\n  }\n  \n  // 删除订单\n  const handleDeleteOrder = (order) => {\n    uni.showModal({\n      title: '删除订单',\n      content: '确定要删除这个订单吗？删除后不可恢复。',\n      confirmText: '删除',\n      cancelText: '取消',\n      success: async (res) => {\n        if (res.confirm) {\n          try {\n            uni.showLoading({\n              title: '删除中...'\n            })\n            \n            // 调用删除订单API\n            const deleteData = {\n              order_id: order.id,\n              companion_id: companionId.value\n            }\n            \n            const response = await deleteCompanionOrder(deleteData)\n            \n            if (response.data.code === 0) {\n              // 前端移除\n              orderListData.value[currentStatus.value] = orderListData.value[currentStatus.value].filter(o => o.id !== order.id)\n              uni.showToast({\n                title: '订单已删除',\n                icon: 'success'\n              })\n            } else {\n              throw new Error(response.data.msg || '删除订单失败')\n            }\n          } catch (error) {\n            console.error('删除订单失败:', error)\n            uni.showToast({\n              title: error.message || '删除失败',\n              icon: 'none'\n            })\n          } finally {\n            uni.hideLoading()\n          }\n        }\n      }\n    })\n  }\n  \n  // 跳转到订单详情\n  const navigateToDetail = (orderId) => {\n    uni.navigateTo({\n      url: `/subPackages/partner/order/detail?orderId=${orderId}&companion_id=${companionId.value}`\n    })\n  }\n  \n  // 打开导航\n  const openLocation = (order) => {\n    if (order.user_latitude && order.user_longitude) {\n      uni.openLocation({ \n        latitude: Number(order.user_latitude), //要去的纬度\n        longitude: Number(order.user_longitude), //要去的经度 \n        address: order.service_address, //要去的具体地址 \n      })\n    } else {\n      uni.showToast({\n        title: '暂无位置信息',\n        icon: 'none'\n      })\n    }\n  }\n  \n  // 格式化时间\n  const formatTime = (timeStr) => {\n    const date = new Date(timeStr)\n    \n    // 格式化为 YYYY-MM-DD HH:mm 格式\n    const year = date.getFullYear()\n    const month = String(date.getMonth() + 1).padStart(2, '0')\n    const day = String(date.getDate()).padStart(2, '0')\n    const hours = String(date.getHours()).padStart(2, '0')\n    const minutes = String(date.getMinutes()).padStart(2, '0')\n    \n    return `${year}-${month}-${day} ${hours}:${minutes}`\n  }\n  \n  // 格式化服务时间\n  const formatServiceTime = (timeStr) => {\n    if (!timeStr) return '待确认'\n    \n    const date = new Date(timeStr)\n    \n    // 格式化为 MM-DD HH:mm 格式\n    const month = String(date.getMonth() + 1).padStart(2, '0')\n    const day = String(date.getDate()).padStart(2, '0')\n    const hours = String(date.getHours()).padStart(2, '0')\n    const minutes = String(date.getMinutes()).padStart(2, '0')\n    \n    return `${month}-${day} ${hours}:${minutes}`\n  }\n\n  // 格式化服务日期和时间\n  const formatServiceDateTime = (serviceDate, serviceTime) => {\n    if (!serviceDate && !serviceTime) return '待确认'\n    \n    let result = ''\n    \n    // 处理服务日期\n    if (serviceDate) {\n      const date = new Date(serviceDate)\n      const year = date.getFullYear()\n      const month = String(date.getMonth() + 1).padStart(2, '0')\n      const day = String(date.getDate()).padStart(2, '0')\n      const weekday = ['周日', '周一', '周二', '周三', '周四', '周五', '周六'][date.getDay()]\n      result += `${year}-${month}-${day} ${weekday}`\n    }\n    \n    // 处理时间段\n    if (serviceTime) {\n      if (result) {\n        result += ' '\n      }\n      result += serviceTime\n    }\n    \n    return result || '待确认'\n  }\n  </script>\n  \n  <style lang=\"scss\" scoped>\n  .order-container {\n    height: 100vh;\n    background-color: #F7F8FA;\n    display: flex;\n    flex-direction: column;\n    overflow: hidden;\n  }\n  \n  /* 状态筛选栏 */\n  .status-filter {\n    background: #FFFFFF;\n    border-bottom: 1rpx solid #f0f0f0;\n    flex-shrink: 0;\n  }\n  \n  .filter-scroll {\n    white-space: nowrap;\n  }\n  \n  .filter-tabs {\n    display: flex;\n    padding: 0rpx 10rpx 24rpx 0;\n    justify-content: space-around;\n  }\n  \n  .filter-tab {\n    display: flex;\n    align-items: center;\n    padding: 12rpx 16rpx;\n    transition: all 0.3s ease;\n    position: relative;\n    flex: 1;\n    justify-content: center;\n  }\n  \n  .filter-tab.active::after {\n    content: '';\n    position: absolute;\n    bottom: 0;\n    left: 50%;\n    transform: translateX(-50%);\n    width: 50rpx;\n    height: 6rpx;\n    background: #7363FF;\n    border-radius: 3rpx;\n  }\n  \n  .tab-text {\n    font-size: 28rpx;\n    font-weight: 500;\n    color: #666666;\n    transition: color 0.3s ease;\n  }\n  \n  .filter-tab.active .tab-text {\n    color: #7363FF;\n    font-weight: 600;\n  }\n  \n  /* 订单列表滑动容器 */\n  .order-content {\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n    overflow: hidden;\n  }\n  \n  .order-swiper {\n    flex: 1;\n    height: 100%;\n  }\n  \n  .order-scroll-view {\n    height: 100%;\n    padding:0 24rpx;\n    box-sizing: border-box;\n  }\n  \n  /* 空状态 */\n  .empty-state {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    padding: 120rpx 0;\n  }\n  \n  .empty-image {\n    width: 200rpx;\n    height: 200rpx;\n    margin-bottom: 32rpx;\n    opacity: 0.6;\n  }\n  \n  .empty-text {\n    font-size: 32rpx;\n    color: #999999;\n    margin-bottom: 16rpx;\n  }\n  \n  .empty-desc {\n    font-size: 26rpx;\n    color: #cccccc;\n  }\n  \n  /* 订单卡片 */\n  .order-cards {\n    display: flex;\n    flex-direction: column;\n    gap: 20rpx;\n    margin-top: 20rpx;\n  }\n  \n  .order-card {\n    background: #FFFFFF;\n    border-radius: 16rpx;\n    padding: 24rpx;\n\n  }\n  \n  /* 订单头部 */\n  .order-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: flex-start;\n    margin-bottom: 20rpx;\n    padding-bottom: 20rpx;\n    border-bottom: 1rpx solid #f0f0f0;\n  }\n  \n  .order-info {\n    flex: 1;\n  }\n  \n\n  \n  .order-time {\n    font-size: 26rpx;\n    color: #999999;\n  }\n  \n  .order-status {\n    font-size: 24rpx;\n    font-weight: 500;\n  }\n  \n  .status-pending {\n    color: #ff6b35;\n  }\n  \n  .status-to-serve {\n    color: #007bff;\n  }\n  \n  .status-in-progress {\n    color: #28a745;\n  }\n  \n  .status-completed {\n    color: #6c757d;\n  }\n  \n  .status-cancelled {\n    color: #b0b0b0;\n  }\n  \n  .status-refunded {\n    color: #00bcd4;\n  }\n  \n  .status-refunding {\n    color: #ff9800;\n  }\n  \n  /* 客户信息 */\n  .customer-info {\n    display: flex;\n    align-items: center;\n    margin-bottom: 20rpx;\n    padding-bottom: 20rpx;\n    border-bottom: 1rpx solid #f0f0f0;\n  }\n  \n  .customer-avatar {\n    width: 80rpx;\n    height: 80rpx;\n    border-radius: 50%;\n    margin-right: 16rpx;\n  }\n  \n  .customer-details {\n    flex: 1;\n  }\n  \n  .customer-name {\n    font-size: 28rpx;\n    color: #1A1A1A;\n    font-weight: 500;\n    margin-bottom: 4rpx;\n    display: block;\n  }\n  \n  .customer-phone {\n    font-size: 24rpx;\n    color: #666666;\n  }\n  \n  /* 服务信息 */\n  .service-info {\n    display: flex;\n    margin-bottom: 20rpx;\n    padding-bottom: 20rpx;\n    border-bottom: 1rpx solid #f0f0f0;\n  }\n  \n  .service-image {\n    width: 120rpx;\n    height: 120rpx;\n    border-radius: 12rpx;\n    margin-right: 20rpx;\n    flex-shrink: 0;\n  }\n  \n  .service-details {\n    flex: 1;\n  }\n  \n  .service-name {\n    font-size: 28rpx;\n    color: #1A1A1A;\n\n    margin-bottom: 8rpx;\n    display: block;\n  }\n  \n  .service-meta {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 8rpx;\n  }\n  \n  .service-price {\n    font-size: 26rpx;\n    color: #1a1a1a;\n  }\n  \n  .service-duration {\n    font-size: 26rpx;\n    color: #1a1a1a;\n  }\n  \n  .service-amount {\n    display: flex;\n    align-items: center;\n    margin-top: 8rpx;\n  }\n  \n  .amount-label {\n    font-size: 26rpx;\n    color: #666666;\n  }\n  \n  .amount-value {\n    font-size: 28rpx;\n    color: #f43f5e;\n    font-weight: 600;\n  }\n  \n  /* 服务地址和时间 */\n  .service-location-time {\n    margin-bottom: 20rpx;\n    padding-bottom: 20rpx;\n    border-bottom: 1rpx solid #f0f0f0;\n  }\n  \n  .location-info,\n  .time-info {\n    display: flex;\n    align-items: center;\n    margin-bottom: 16rpx;\n  }\n  \n  .location-info:last-child,\n  .time-info:last-child {\n    margin-bottom: 0;\n  }\n  \n  .location-label,\n  .time-label {\n    font-size: 26rpx;\n    color: #666666;\n    min-width: 140rpx;\n    flex-shrink: 0;\n  }\n  \n  .location-value,\n  .time-value {\n    font-size: 26rpx;\n    color: #1a1a1a;\n    flex: 1;\n    word-break: break-all;\n    line-height: 1.4;\n  }\n  \n  .location-value-container {\n    display: flex;\n    align-items: center;\n    flex: 1;\n    gap: 16rpx;\n  }\n  \n  .location-value-container .location-value {\n    flex: 1;\n    min-width: 0;\n  }\n  \n  .location-actions {\n    display: flex;\n    align-items: center;\n    flex-shrink: 0;\n  }\n  \n  .nav-btn {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    padding: 8rpx 16rpx;\n    background: linear-gradient(135deg, #7363FF 0%, #FF69DE 100%);\n    border-radius: 20rpx;\n    transition: all 0.3s ease;\n    \n    &:active {\n      transform: scale(0.95);\n    }\n  }\n  \n  .nav-text {\n    font-size: 22rpx;\n    color: #FFFFFF;\n    font-weight: 500;\n  }\n  \n  /* 操作按钮 */\n  .order-actions {\n    display: flex;\n    gap: 16rpx;\n    justify-content: flex-end;\n  }\n  \n  .action-btn {\n    padding: 16rpx 32rpx;\n    border-radius: 99999rpx;\n    font-size: 26rpx;\n    font-weight: 500;\n    transition: all 0.3s ease;\n    border: 1rpx solid transparent;\n    box-sizing: border-box;\n    height: 72rpx;\n\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  }\n  \n  .action-btn.primary {\n  background: #7363FF;\n  color: #FFFFFF;\n  border-color: #7363FF;\n}\n\n.action-btn.primary:active {\n  background: #6354e6;\n  transform: scale(0.96);\n}\n\n.action-btn.depart {\n  background: #4CAF50;\n  color: #FFFFFF;\n  border-color: #4CAF50;\n}\n\n.action-btn.depart:active {\n  background: #45a049;\n  transform: scale(0.96);\n}\n  \n  .action-btn.secondary {\n    background: #FFFFFF;\n    color: #666666;\n    border-color: #e9ecef;\n  }\n  \n  .action-btn.secondary:active {\n    background: #f8f9fa;\n    transform: scale(0.96);\n  }\n\n  .action-btn.info {\n    background: transparent;\n    color: #999999;\n    border-color: transparent;\n    cursor: default;\n    padding: 16rpx 0;\n  }\n\n  .action-btn.info:active {\n    background: transparent;\n    transform: none;\n  }\n\n  /* 提示容器 */\n  .tip-container {\n    display: flex;\n    justify-content: flex-end;\n    margin-bottom: 20rpx;\n  }\n\n  /* 自动开始服务提示 */\n  .auto-start-tip {\n    background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);\n    border: 1rpx solid #ffc107;\n    border-radius: 12rpx;\n    padding: 12rpx 16rpx;\n    display: inline-flex;\n    align-items: center;\n    justify-content: center;\n    max-width: fit-content;\n    gap: 8rpx;\n  }\n\n  .tip-icon {\n    width: 34rpx;\n    height: 34rpx;\n    flex-shrink: 0;\n  }\n\n  .tip-text {\n    font-size: 24rpx;\n    color: #856404;\n    font-weight: 500;\n    text-align: center;\n    line-height: 1.4;\n    white-space: nowrap;\n  }\n  \n  /* 加载更多 */\n  .load-more {\n    display: flex;\n    justify-content: center;\n    padding: 32rpx 0;\n  }\n  \n  .loading-text {\n    font-size: 26rpx;\n    color: #999999;\n  }\n</style>","import MiniProgramPage from '/Users/xiaoqiang/Documents/friemd/firend-loving-app/subPackages/partner/order/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["currentStatus","ref","currentTabIndex","isRefreshing","isLoading","isLoadingMore","hasMore","page","pageSize","companionId","orderListCache","orderListData","swiperChangeTimer","onUnmounted","statusTabs","onLoad","options","uni","statusIndex","tab","loadOrderList","watch","newStatus","oldStatus","switchStatus","status","error","onSwiperChange","e","index","getTabOrderList","params","response","getCompanionOrderList","list","total","updateCurrentStatusCount","currentTab","onRefresh","resolve","onRefreshRestore","loadMore","getStatusClass","getStatusText","getOrderActions","order","handleOrderAction","action","handleContactCustomer","handleAcceptOrder","handleRejectOrder","handleArrived","handleDepart","handleCallCustomer","handleStartService","handleEndService","handleViewReview","handleRebookService","handleDeleteOrder","res","acceptCompanionOrder","pendingServiceIndex","rejectCompanionOrder","arrivedCompanionOrder","departCompanionOrder","startCompanionService","endCompanionService","deleteData","deleteCompanionOrder","o","navigateToDetail","orderId","openLocation","formatTime","timeStr","date","year","month","day","hours","minutes","formatServiceDateTime","serviceDate","serviceTime","result","weekday","MiniProgramPage"],"mappings":"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"}