{"version":3,"file":"Workbench.js","sources":["subPackages/partner/components/Workbench.vue","/Users/xiaoqiang/Documents/friemd/firend-loving-app/subPackages/partner/components/Workbench.vue?type=component"],"sourcesContent":["<template>\n  <scroll-view class=\"tab-scroll-view\" scroll-y=\"true\">\n    <view class=\"workbench-content\">\n    \n      <!-- 上线/下线状态控制 -->\n      <view class=\"status-control\">\n        <view class=\"status-card\" :class=\"{ 'online': isOnline }\">\n          <!-- 左侧：状态信息和头像 -->\n          <view class=\"status-left\">\n            <!-- 头像显示 -->\n            <view class=\"avatar-container\" v-if=\"applicationInfo && applicationInfo.photos && applicationInfo.photos.length > 0\">\n              <image :src=\"applicationInfo.photos[0]\" class=\"avatar-img\" mode=\"aspectFill\" />\n            </view>\n            \n            <view class=\"status-info\">\n              <view class=\"status-indicator\">\n                <view class=\"status-dot\" :class=\"{ 'active': isOnline }\"></view>\n                <text class=\"status-text\">{{ isOnline ? '已上线' : '已下线' }}</text>\n              </view>\n              <text class=\"status-desc\">{{ isOnline ? '正在接单中' : '暂停接单' }}</text>\n            </view>\n          </view>\n          \n          <!-- 右侧：切换按钮 -->\n          <view class=\"status-right\">\n            <view class=\"toggle-button\" :class=\"{ 'online': isOnline }\" @click=\"toggleStatus\">\n              <view class=\"toggle-icon\">\n                <view class=\"icon-container\">\n                  <view class=\"icon-play\" v-if=\"!isOnline\"></view>\n                  <view class=\"icon-pause\" v-if=\"isOnline\"></view>\n                </view>\n              </view>\n              <text class=\"toggle-text\">{{ isOnline ? '下线' : '上线' }}</text>\n            </view>\n          </view>\n        </view>\n      </view>\n      \n      <!-- 位置管理 -->\n      <view class=\"location-management\">\n        <view class=\"location-card\">\n          <view class=\"location-content\">\n            <view class=\"flex-between\">\n              <view class=\"location-header\">\n              <image class=\"location-icon\" src=\"@/static/icons/partner/dizhi.png\" mode=\"aspectFit\" />\n              <text class=\"location-title\">当前位置</text>\n            </view>\n            <view class=\"location-actions\">\n              <view class=\"action-btn refresh-btn\" @click=\"refreshLocation\">\n                <image class=\"btn-icon\" src=\"@/static/icons/partner/shuaxin.png\" mode=\"aspectFit\" />\n                <text class=\"btn-text\">刷新位置</text>\n              </view>\n              <view class=\"action-btn select-btn\" @click=\"selectLocation\">\n                <image class=\"btn-icon\" src=\"@/static/icons/partner/shoudong.png\" mode=\"aspectFit\" />\n                <text class=\"btn-text\">手动选择</text>\n              </view>\n            </view>\n              </view>\n           \n            <view class=\"location-info\">\n              <text class=\"location-address\">{{ currentLocation || '正在获取位置...' }}</text>\n              <text class=\"location-time\">{{ locationUpdateTime }}</text>\n            </view>\n           \n          </view>\n        </view>\n      </view>\n      \n      <!-- 最近订单 -->\n      <view class=\"recent-orders\">\n        <view class=\"section-header\">\n          <text class=\"section-title\">最近订单</text>\n          <text class=\"view-all\" @click=\"viewAllOrders\">查看全部</text>\n        </view>\n        <view class=\"empty-orders\">\n          <view class=\"empty-icon\">📦</view>\n          <text class=\"empty-text\">暂无订单</text>\n          <text class=\"empty-desc\">开始接单，获得收入</text>\n        </view>\n      </view>\n    </view>\n  </scroll-view>\n</template>\n\n<script setup>\nimport { ref, onMounted } from 'vue'\nimport { getCurrentLocationAddress } from '@/utils/location.js'\n\n// 定义props\nconst props = defineProps({\n  applicationInfo: {\n    type: Object,\n    default: null\n  }\n})\n\n// 状态管理\nconst isOnline = ref(false)\nconst currentLocation = ref('')\nconst locationUpdateTime = ref('')\nconst locationCache = ref({\n  latitude: null,\n  longitude: null,\n  address: ''\n})\n\n// 切换上线/下线状态\nconst toggleStatus = () => {\n  if (!isOnline.value) {\n    // 上线操作\n    uni.showModal({\n      title: '确认上线',\n      content: '上线后将开始接收订单，确认上线吗？',\n      success: (res) => {\n        if (res.confirm) {\n          isOnline.value = true\n          refreshLocation()\n          uni.showToast({\n            title: '已上线，开始接单',\n            icon: 'success'\n          })\n        }\n      }\n    })\n  } else {\n    // 下线操作\n    uni.showModal({\n      title: '确认下线',\n      content: '下线后将停止接收订单，确认下线吗？',\n      success: (res) => {\n        if (res.confirm) {\n          isOnline.value = false\n          uni.showToast({\n            title: '已下线，暂停接单',\n            icon: 'success'\n          })\n        }\n      }\n    })\n  }\n}\n\n// 刷新位置\nconst refreshLocation = () => {\n  uni.showLoading({\n    title: '获取位置中...'\n  })\n  \n  getCurrentLocationAddress()\n    .then(locationInfo => {\n      // 更新位置缓存\n      locationCache.value.latitude = locationInfo.latitude\n      locationCache.value.longitude = locationInfo.longitude\n      locationCache.value.address = locationInfo.address\n      \n      // 更新显示\n      currentLocation.value = locationInfo.address\n      locationUpdateTime.value = new Date().toLocaleTimeString()\n      console.log('位置更新成功', locationInfo)\n      uni.hideLoading()\n      uni.showToast({\n        title: '位置更新成功',\n        icon: 'success'\n      })\n      \n      // 如果用户已上线，更新位置信息到服务器\n      if (isOnline.value) {\n        updateLocationToServer(locationInfo.latitude, locationInfo.longitude, locationInfo.address)\n      }\n    })\n    .catch(err => {\n      uni.hideLoading()\n      uni.showToast({\n        title: '获取位置失败',\n        icon: 'error'\n      })\n      console.error('获取位置失败:', err)\n    })\n}\n\n// 更新位置信息到服务器\nconst updateLocationToServer = (latitude, longitude, address) => {\n  // 调用后端API更新位置信息\n  const requestData = {\n    is_online: isOnline.value ? 1 : 0,\n    latitude: latitude,\n    longitude: longitude,\n    location_text: address\n  }\n  \n  // 这里需要导入API方法\n  // updateCompanionOnlineStatus(requestData)\n  //   .then(res => {\n  //     if (res.code === 0) {\n  //       console.log('位置更新成功:', res)\n  //     } else {\n  //       console.error('位置更新失败:', res.msg)\n  //     }\n  //   })\n  //   .catch(err => {\n  //     console.error('位置更新API调用失败:', err)\n  //   })\n}\n\n// 手动选择位置\nconst selectLocation = () => {\n  // #ifdef MP-WEIXIN\n  uni.chooseLocation({\n    success: (res) => {\n      const address = res.address || res.name || '已选择位置'\n      \n      // 更新位置缓存\n      locationCache.value.latitude = res.latitude\n      locationCache.value.longitude = res.longitude\n      locationCache.value.address = address\n      \n      // 更新显示\n      currentLocation.value = address\n      locationUpdateTime.value = new Date().toLocaleTimeString()\n      \n      // 如果用户已上线，更新位置信息到服务器\n      if (isOnline.value) {\n        updateLocationToServer(res.latitude, res.longitude, address)\n      }\n    },\n    fail: (err) => {\n      if (err.errMsg && err.errMsg.indexOf('cancel') === -1) {\n        uni.showToast({\n          title: '获取位置失败',\n          icon: 'error'\n        })\n        console.error('获取位置失败:', err.errMsg)\n      }\n    }\n  })\n  // #endif\n  // #ifndef MP-WEIXIN\n  uni.showToast({\n    title: '请在微信小程序中使用地图选点',\n    icon: 'none'\n  })\n  // #endif\n}\n\n// 查看全部订单\nconst viewAllOrders = () => {\n  uni.showToast({\n    title: '订单列表功能开发中',\n    icon: 'none'\n  })\n}\n\n// 页面加载时获取位置\nonMounted(() => {\n  refreshLocation()\n})\n</script>\n\n<style lang=\"scss\" scoped>\n.tab-scroll-view {\n  height: 100%;\n  background: #F7F8FA;\n}\n\n.workbench-content {\n  padding: 32rpx;\n}\n\n.workbench-header {\n  margin-bottom: 32rpx;\n}\n\n.workbench-title {\n  font-size: 46rpx;\n  font-weight: 700;\n  color: #1A1A1A;\n  display: block;\n \n}\n\n.workbench-subtitle {\n  font-size: 28rpx;\n  color: #1A1A1A;\n  display: block;\n}\n\n// 状态控制样式\n.status-control {\n  margin-bottom: 32rpx;\n}\n\n.status-card {\n  background: #FFFFFF;\n  border-radius: 20rpx;\n  padding: 32rpx;\n  box-shadow: 0 4rpx 16rpx rgba(0, 0, 0, 0.06);\n  border: 1rpx solid #f0f0f0;\n  transition: all 0.3s ease;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  position: relative;\n  overflow: hidden;\n  \n  &.online {\n    background: linear-gradient(135deg, rgba(115, 99, 255, 0.05) 0%, rgba(255, 105, 222, 0.05) 100%);\n    border-color: #7363FF;\n    \n    &::before {\n      content: '';\n      position: absolute;\n      top: 0;\n      left: 0;\n      right: 0;\n      height: 4rpx;\n      background: linear-gradient(135deg, #7363FF 0%, #FF69DE 100%);\n    }\n  }\n  \n  &:active {\n    transform: translateY(2rpx);\n    box-shadow: 0 2rpx 8rpx rgba(0, 0, 0, 0.1);\n  }\n}\n\n.status-left {\n  display: flex;\n  align-items: center;\n  flex: 1;\n  min-width: 0; // 防止flex子元素溢出\n}\n\n.status-info {\n  margin-left: 20rpx;\n  flex: 1;\n  min-width: 0; // 防止文本溢出\n}\n\n.status-indicator {\n  display: flex;\n  align-items: center;\n  margin-bottom: 8rpx;\n}\n\n.status-dot {\n  width: 16rpx;\n  height: 16rpx;\n  border-radius: 50%;\n  background: #CCCCCC;\n  margin-right: 12rpx;\n  transition: all 0.3s ease;\n  position: relative;\n  \n  &.active {\n    background: #4CAF50;\n    box-shadow: 0 0 8rpx rgba(76, 175, 80, 0.4);\n    \n    &::after {\n      content: '';\n      position: absolute;\n      top: 50%;\n      left: 50%;\n      transform: translate(-50%, -50%);\n      width: 8rpx;\n      height: 8rpx;\n      background: #FFFFFF;\n      border-radius: 50%;\n    }\n  }\n}\n\n.status-text {\n  font-size: 32rpx;\n  font-weight: 600;\n  color: #1A1A1A;\n  white-space: nowrap;\n}\n\n.status-desc {\n  font-size: 24rpx;\n  color: #666666;\n  display: block;\n  white-space: nowrap;\n}\n\n// 头像样式\n.avatar-container {\n  width: 80rpx;\n  height: 80rpx;\n  border-radius: 50%;\n  overflow: hidden;\n  border: 3rpx solid #7363FF;\n  box-shadow: 0 4rpx 12rpx rgba(115, 99, 255, 0.3);\n  flex-shrink: 0;\n  position: relative;\n  \n  &::after {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    border-radius: 50%;\n    box-shadow: inset 0 0 0 1rpx rgba(255, 255, 255, 0.3);\n  }\n}\n\n.avatar-img {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n}\n\n.status-right {\n  display: flex;\n  align-items: center;\n  margin-left: 20rpx;\n  flex-shrink: 0;\n}\n\n.toggle-button {\n  background: linear-gradient(135deg, #7363FF 0%, #FF69DE 100%);\n  border-radius: 50rpx;\n  padding: 20rpx 32rpx;\n  transition: all 0.3s ease;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  min-width: 120rpx;\n  position: relative;\n  overflow: hidden;\n  \n  &::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: -100%;\n    width: 100%;\n    height: 100%;\n    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);\n    transition: left 0.5s ease;\n  }\n  \n  &.online {\n    background: linear-gradient(135deg, #F44336 0%, #FF5722 100%);\n    \n    &::before {\n      left: 100%;\n    }\n    \n    .toggle-icon {\n      transform: scale(1.1);\n    }\n    \n    .icon-play {\n      transform: scale(0.8);\n    }\n    \n    .icon-pause::before,\n    .icon-pause::after {\n      transform: scale(1.2);\n    }\n  }\n  \n  &:active {\n    transform: scale(0.96);\n    \n    &::before {\n      left: 100%;\n    }\n    \n    .toggle-icon {\n      transform: scale(0.9);\n    }\n  }\n}\n\n.toggle-icon {\n  margin-right: 8rpx;\n  transition: transform 0.3s ease;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.icon-container {\n  width: 32rpx;\n  height: 32rpx;\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.icon-play {\n  width: 0;\n  height: 0;\n  border-left: 12rpx solid #FFFFFF;\n  border-top: 8rpx solid transparent;\n  border-bottom: 8rpx solid transparent;\n  margin-left: 2rpx;\n  transition: all 0.3s ease;\n}\n\n.icon-pause {\n  display: flex;\n  gap: 4rpx;\n  align-items: center;\n  justify-content: center;\n}\n\n.icon-pause::before,\n.icon-pause::after {\n  content: '';\n  width: 4rpx;\n  height: 16rpx;\n  background: #FFFFFF;\n  border-radius: 2rpx;\n  transition: all 0.3s ease;\n}\n\n.toggle-text {\n  color: #FFFFFF;\n  font-size: 26rpx;\n  font-weight: 600;\n  text-shadow: 0 1rpx 2rpx rgba(0, 0, 0, 0.1);\n}\n\n// 位置管理样式\n.location-management {\n  margin-bottom: 32rpx;\n}\n\n.location-card {\n  background: #FFFFFF;\n  border-radius: 20rpx;\n  padding: 32rpx;\n  box-shadow: 0 4rpx 16rpx rgba(0, 0, 0, 0.06);\n  border: 1rpx solid #f0f0f0;\n}\n\n.location-content {\n  display: flex;\n  flex-direction: column;\n  gap: 20rpx;\n}\n\n.location-header {\n  display: flex;\n  align-items: center;\n}\n\n.location-icon {\n  width: 32rpx;\n  height: 32rpx;\n  margin-right: 12rpx;\n  display: inline-block;\n  vertical-align: middle;\n}\n\n.location-title {\n  font-size: 28rpx;\n  font-weight: 600;\n  color: #1A1A1A;\n}\n\n.location-info {\n  margin-top: 20rpx;\n}\n\n.location-address {\n  font-size: 26rpx;\n  color: #1A1A1A;\n  display: block;\n  margin-bottom: 8rpx;\n  line-height: 1.4;\n}\n\n.location-time {\n  font-size: 22rpx;\n  color: #999999;\n  display: block;\n}\n\n.location-actions {\n  display: flex;\n  flex-direction: row;\n  gap: 16rpx;\n  margin-top: 8rpx;\n}\n\n.action-btn {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 12rpx 20rpx;\n  border-radius: 10rpx;\n  border: 1rpx solid #E5E5E5;\n  background: #F7F8FA;\n  transition: all 0.2s ease;\n  white-space: nowrap;\n  \n  &:active {\n    transform: scale(0.96);\n    background: #F0F0F0;\n  }\n}\n\n.refresh-btn {\n  border-color: #5AC8FA;\n  background: rgba(90, 200, 250, 0.1);\n}\n\n.select-btn {\n  border-color: #FF9500;\n  background: rgba(255, 149, 0, 0.1);\n}\n\n.btn-icon {\n  width: 28rpx;\n  height: 28rpx;\n  margin-right: 8rpx;\n  display: inline-block;\n  vertical-align: middle;\n}\n\n.btn-text {\n  font-size: 24rpx;\n  color: #1A1A1A;\n  font-weight: 500;\n}\n\n.recent-orders {\n  background: #FFFFFF;\n  border-radius: 20rpx;\n  padding: 32rpx;\n  box-shadow: 0 4rpx 16rpx rgba(0, 0, 0, 0.06);\n  border: 1rpx solid #f0f0f0;\n}\n\n.section-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 24rpx;\n}\n\n.section-title {\n  font-size: 32rpx;\n  font-weight: 600;\n  color: #1A1A1A;\n}\n\n.view-all {\n  font-size: 24rpx;\n  color: #7363FF;\n  font-weight: 500;\n}\n\n.empty-orders {\n  text-align: center;\n  padding: 60rpx 0;\n}\n\n.empty-icon {\n  font-size: 80rpx;\n  margin-bottom: 24rpx;\n  display: block;\n  opacity: 0.6;\n}\n\n.empty-text {\n  font-size: 28rpx;\n  color: #1A1A1A;\n  font-weight: 500;\n  display: block;\n  margin-bottom: 8rpx;\n}\n\n.empty-desc {\n  font-size: 24rpx;\n  color: #666666;\n  display: block;\n}\n</style> ","import Component from '/Users/xiaoqiang/Documents/friemd/firend-loving-app/subPackages/partner/components/Workbench.vue'\nwx.createComponent(Component)"],"names":["ref","uni","getCurrentLocationAddress","onMounted"],"mappings":"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"}