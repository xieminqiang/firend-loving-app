{"version":3,"file":"friend-select.js","sources":["subPackages/friend/friend-select.vue","subPackages/friend/friend-select.vue?type=page"],"sourcesContent":["<template>\n    <view class=\"friends-container\">\n      <!-- 顶部区域 -->\n      <view class=\"header\" :style=\"{ paddingTop: statusBarHeight + 'px' }\">\n        <view class=\"header-top\">\n          <image src=\"@/static/icons/common/arrow-left.png\" class=\"back-icon\" mode=\"aspectFit\" @click=\"handleBack\" />\n          <CitySelector @click=\"showCityPicker = true\" />\n          <view class=\"search-container\" :style=\"{ paddingRight: safeAreaRight + 'px' }\">\n            <image src=\"@/static/icons/friend/search.png\" class=\"search-icon\" mode=\"aspectFit\" />\n            <input v-model=\"search\" class=\"search-input\" placeholder=\"搜索友伴\" @input=\"onSearchInput\" />\n          </view>\n        </view>\n        \n\n        \n  \n      </view>\n  \n      <!-- 友伴列表 -->\n      <view class=\"main-content\">\n        <scroll-view \n          class=\"partner-list\" \n          scroll-y=\"true\"\n          @scrolltolower=\"loadMore\"\n          refresher-enabled\n          :refresher-triggered=\"isRefreshing\"\n          @refresherrefresh=\"onRefresh\"\n        >\n          <!-- 加载状态 -->\n          <view v-if=\"loading && !dataLoaded\" class=\"loading-state\">\n            <view class=\"loading-spinner\"></view>\n            <text class=\"loading-text\">加载中...</text>\n          </view>\n          \n          <!-- 友伴列表 -->\n          <view v-else-if=\"processedPartnersList.length > 0\">\n            <view v-for=\"p in processedPartnersList\" :key=\"p.id\" class=\"partner-card\" @click=\"navigateToDetail(p.id)\">\n              <view class=\"avatar-wrapper\">\n                <image :src=\"p.avatar\" class=\"avatar\" mode=\"aspectFill\" />\n                <view v-if=\"p.online\" class=\"status-dot\"></view>\n              </view>\n              <view class=\"partner-info\">\n                <view class=\"partner-name\">\n                    {{ p.name }}\n                   \n                  </view>\n                <view class=\"flex-between\">\n                  <view class=\"flex\">\n                    <view>\n                    <image src=\"@/static/icons/friend/female.png\" mode=\"aspectFit\" class=\"gender-icon\" v-if=\"p.gender === '女'\" />\n                    <image src=\"@/static/icons/friend/male.png\" class=\"gender-icon\" mode=\"aspectFit\" v-else/>\n                    </view>\n                     <view class=\"partner-meta\">{{ p.age }}  ·  {{p.height }}cm  ·  {{ p.weight  }}kg</view>\n  \n                  </view>\n                  <view class=\"partner-meta-distance\" >\n                    <image src=\"/static/icons/friend/address.png\" class=\"distance-icon\" mode=\"aspectFit\" />\n                    <text>{{ p.distance }}</text>\n                  </view>\n  \n                </view>\n            \n                <view class=\"partner-tags\">\n                  <text v-for=\"(tag, index) in p.visibleTags\" :key=\"index\" class=\"tag\">{{ tag }}</text>\n                  <text v-if=\"p.extraTags > 0\" class=\"more-tags\">+{{ p.extraTags }}</text>\n                </view>\n                <view class=\"partner-actions flex-between\">\n                  <view ></view>\n                  <view class=\"schedule-btn\" @click.stop=\"openServicePopup(p)\">\n                    <text>立即邀约</text>\n                  </view>\n                </view>\n              </view>\n            </view>\n            <view style=\"height: 20rpx;\"></view>\n          </view>\n          \n          <!-- 空状态 - 只在加载完成后且没有数据时显示 -->\n          <view v-else-if=\"dataLoaded && processedPartnersList.length === 0\" class=\"empty-state\">\n            <image src=\"/static/images/empty.png\" class=\"empty-icon\" mode=\"aspectFit\" />\n            <text class=\"empty-text\">暂无友伴</text>\n            <text class=\"empty-desc\">更多精彩友伴即将上线</text>\n          </view>\n        </scroll-view>\n      </view>\n  \n\n  \n      <!-- 城市选择弹窗 -->\n      <CityPicker \n        v-model:visible=\"showCityPicker\" \n        @city-selected=\"onCitySelected\"\n      />\n  \n      <!-- 服务选择弹窗 -->\n      <uni-popup ref=\"servicePopup\" type=\"bottom\" :mask-click=\"true\" @close=\"closeServicePopup\" round=\"20\" :safe-area=\"false\">\n        <view class=\"service-popup-content\">\n          <view class=\"service-popup-header\">\n            <text class=\"service-popup-title\">选择服务项目</text>\n            <view class=\"close-popup-btn\" @click=\"closeServicePopup\">\n              <image src=\"@/static/icons/friend/close.png\" class=\"close-popup-icon\" mode=\"aspectFit\" />\n            </view>\n          </view>\n          <view class=\"service-popup-body\">\n            <scroll-view \n              class=\"service-scroll-view\" \n              scroll-y=\"true\"\n              :scroll-top=\"scrollTop\"\n              :scroll-with-animation=\"true\"\n            >\n              <view v-if=\"currentPartnerServices.length > 0\" class=\"service-list\">\n                <view class=\"service-item\" v-for=\"item in currentPartnerServices\" :key=\"item.title\">\n                  <image :src=\"item.img\" class=\"service-img\" mode=\"aspectFill\" />\n                  <view class=\"service-info\">\n                    <text class=\"service-title\">{{ item.title }}</text>\n                    <view class=\"service-tags\">\n                      <text v-for=\"tag in item.tags\" :key=\"tag\" class=\"service-tag\">{{ tag }}</text>\n                    </view>\n                    <view class=\"service-bottom-row\">\n                      <text class=\"service-price\">{{ item.price }}元/{{ item.unit || '小时' }}起</text>\n                      <view class=\"order-btn\" @click=\"goToSubmit(item)\">去下单</view>\n                    </view>\n                  </view>\n                </view>\n              </view>\n              <view v-else class=\"empty-service-state\">\n                <image src=\"/static/images/empty.png\" class=\"empty-service-icon\" mode=\"aspectFit\" />\n                <text class=\"empty-service-text\">~暂无服务项目~</text>\n              </view>\n            </scroll-view>\n          </view>\n        </view>\n      </uni-popup>\n    </view>\n  </template>\n  \n  <script setup>\n  import { ref, computed, onMounted, onUnmounted } from 'vue'\n  import { searchCompanions, getCityServices } from '@/api/friends.js'\n  import { createOrder, orderParams } from '@/api/order.js'\n  import { useLevelStore } from '@/stores/level.js'\n  import { useCityStore } from '@/stores/city.js'\n  import CitySelector from '@/components/common/CitySelector.vue'\n  import CityPicker from '@/components/common/CityPicker.vue'\n  \n  // 状态栏高度和胶囊按钮信息\n  const statusBarHeight = ref(0)\n  const menuButtonInfo = ref(null)\n  const safeAreaRight = ref(0)\n  \n  // 页面数据\n  const search = ref('')\n  const isRefreshing = ref(false)\n  const showCityPicker = ref(false)\n  const serviceId = ref('') // 接收服务ID参数\n  \n  // 定位相关 - 使用全局store\n  const latitude = computed(() => cityStore.userLocation?.latitude || null)\n  const longitude = computed(() => cityStore.userLocation?.longitude || null)\n  const locationPermission = ref(false)\n  \n  // 获取全局城市store\n  const cityStore = useCityStore()\n  \n  // 城市相关数据 - 使用全局store\n  const cityList = computed(() => cityStore.cityList)\n  const selectedCity = computed(() => cityStore.currentCity)\n  \n\n  \n  // 友伴数据\n  const partnersList = ref([])\n  const total = ref(0)\n  const currentPage = ref(1)\n  const pageSize = ref(20)\n  const loading = ref(false)\n  const hasMore = ref(true)\n  const dataLoaded = ref(false) // 数据是否已加载完成\n  \n  // 获取全局level store\n  const levelStore = useLevelStore()\n  \n  // 处理标签显示\n  const processedPartnersList = computed(function() {\n    return partnersList.value.map(function(partner) {\n      const visibleTags = partner.tags ? partner.tags.slice(0, 3) : []\n      const extraTags = partner.tags && partner.tags.length > 3 ? partner.tags.length - 3 : 0\n      return {\n        ...partner,\n        visibleTags,\n        extraTags\n      }\n    })\n  })\n  \n\n  \n  // 服务选择弹窗相关数据\n  const servicePopup = ref(null)\n  const currentPartnerServices = ref([])\n  const currentPartner = ref(null)\n  const scrollTop = ref(0)\n  \n  // 打开服务选择弹窗\n  const openServicePopup = async (partner) => {\n    currentPartner.value = partner\n    \n    try {\n      // 获取该友伴师的服务信息\n      const requestParams = {\n        city_code: cityStore.currentCityCode,\n        application_id: partner.id\n      }\n      \n      // 添加经纬度参数\n      if (latitude.value && longitude.value) {\n        requestParams.latitude = parseFloat(latitude.value)\n        requestParams.longitude = parseFloat(longitude.value)\n      }\n      \n      const response = await getCityServices(requestParams)\n      \n      if (response.data && response.data.code === 0) {\n        const data = response.data.data\n        if (data && data.services && data.services.length > 0) {\n          currentPartnerServices.value = data.services.map(service => ({\n            title: service.service_name,\n            img: \"https://sygx-server-bucket-admin.oss-cn-shanghai.aliyuncs.com\" + service.service_image_url || '',\n            tags: service.service_tags || [],\n            price: service.price,\n            service_id: service.service_id,\n            price_template_id: service.price_template_id || '',\n            unit: service.unit,\n            min_quantity: service.min_quantity\n          \n          })) \n      \n        } else {\n          currentPartnerServices.value = []\n        }\n      } else {\n        currentPartnerServices.value = []\n      }\n    } catch (error) {\n      console.error('获取服务信息失败:', error)\n      currentPartnerServices.value = []\n    }\n    \n    servicePopup.value.open()\n  }\n  \n  // 关闭服务选择弹窗\n  const closeServicePopup = () => {\n    servicePopup.value.close()\n  }\n  \n  // 跳转到订单提交页面\n  const goToSubmit = (item) => {\n    console.log('选择服务:', item)\n    closeServicePopup()\n    \n    // 构建跳转URL，包含所有必要参数\n    let url = `/subPackages/order/submit?service_id=${item.service_id}&price_template_id=${item.price_template_id || ''}&companion_id=${currentPartner.value.id}&level_order=${currentPartner.value.level_order || ''}&nickname=${currentPartner.value.name}`\n    \n    // 如果是从服务详情页跳转过来的，添加原始服务ID\n    if (serviceId.value) {\n      url += `&original_service_id=${serviceId.value}`\n    }\n    \n    // 跳转到订单提交页面\n    uni.navigateTo({\n      url: url\n    })\n  }\n  \n  // 导航到详情页\n  const navigateToDetail = (partnerId) => {\n    let url = '/subPackages/friend/detail?id=' + partnerId + '&city_code=' + cityStore.currentCityCode\n    \n    // 添加经纬度参数\n    if (latitude.value && longitude.value) {\n      url += '&latitude=' + latitude.value + '&longitude=' + longitude.value\n    }\n    \n    uni.navigateTo({\n      url: url\n    })\n  }\n   \n  // 获取定位权限和位置 - 使用全局store\n  const getLocation = async () => {\n    try {\n      await cityStore.getUserLocation()\n      if (cityStore.userLocation) {\n        locationPermission.value = true\n        console.log('获取位置成功:', cityStore.userLocation)\n        \n        // 定位成功后刷新数据\n        await searchCompanionsData(true)\n      } else {\n        throw new Error('获取位置失败')\n      }\n      \n    } catch (err) {\n      console.error('获取位置失败:', err)\n      locationPermission.value = false\n      \n      // 如果获取位置失败，提示用户去授权\n      uni.showModal({\n        title: '定位权限',\n        content: '需要获取您的位置信息来提供更好的服务，请在设置中开启定位权限',\n        confirmText: '去设置',\n        cancelText: '取消',\n        success: (res) => {\n          if (res.confirm) {\n            // 引导用户去设置页面\n            uni.openSetting({\n              success: (settingRes) => {\n                console.log('设置页面结果:', settingRes)\n                // 如果用户授权了定位权限，重新获取位置\n                if (settingRes.authSetting['scope.userLocation']) {\n                  getLocation()\n                }\n              }\n            })\n          }\n        }\n      })\n    }\n  }\n  \n  // 加载城市列表 - 使用全局store\n  const loadCityList = async () => {\n    await cityStore.loadCityList()\n  }\n  \n  // 搜索伴友师\n  const searchCompanionsData = async (isRefresh = false) => {\n    if (loading.value) return\n    \n    loading.value = true\n    \n    try {\n      const params = {\n        page: isRefresh ? 1 : currentPage.value,\n        page_size: pageSize.value\n      }\n      \n      // 使用全局store的城市代码\n      if (cityStore.currentCityCode) {\n        params.city_code = cityStore.currentCityCode\n      }\n      \n      // 只有当搜索关键词存在时才添加\n      if (search.value && search.value.trim()) {\n          params.nickname = search.value.trim()\n      }\n      \n      // 只有当定位成功时才添加经纬度\n      if (latitude.value && longitude.value) {\n        params.latitude = latitude.value\n        params.longitude = longitude.value\n      }\n      \n      // 如果有服务ID，添加到搜索参数中\n      if (serviceId.value) {\n        params.service_id = serviceId.value\n      }\n      \n\n      \n      console.log('搜索参数:', params)\n      \n      const response = await searchCompanions(params)\n      \n      console.log('API完整响应:', response)\n      \n      if (response.data && response.data.code === 0) {\n        const data = response.data.data\n        if (data && data.list) {\n          const newData = data.list.map(item => ({\n            id: item.id,\n            name: item.nickname,\n            gender: item.gender,\n            age: item.age,\n            height: item.height,\n            weight: item.weight,\n            distance: item.distance,\n            tags: item.tags || [],\n            services: (() => {\n              if (typeof item.services === 'string') {\n                try {\n                  return JSON.parse(item.services)\n                } catch (e) {\n                  console.error('解析services JSON失败:', e)\n                  return []\n                }\n              }\n              return item.services || []\n            })(), // 安全解析JSON字符串数组\n            avatar: item.avatar ,\n            online: item.is_online === 1,\n            bookable: item.can_accept_orders === 'Y'\n          }))\n          \n          if (isRefresh) {\n            partnersList.value = newData\n            currentPage.value = 1\n          } else {\n            partnersList.value = [...partnersList.value, ...newData]\n            currentPage.value++\n          }\n          \n          total.value = data.total || 0\n          hasMore.value = newData.length === pageSize.value\n          \n          console.log('搜索成功，共获取', newData.length, '条数据，总数:', total.value)\n          \n          // 如果没有数据，显示提示\n          if (newData.length === 0 && isRefresh) {\n            // uni.showToast({\n            //   title: '暂无符合条件的伴友师',\n            //   icon: 'none',\n            //   duration: 2000\n            // })\n          }\n        } else {\n          console.log('API返回数据为空')\n          if (isRefresh) {\n            partnersList.value = []\n            total.value = 0\n          }\n         \n        }\n      } else {\n        console.error('API返回错误:', response.data)\n        const errorMsg = response.data?.message || '搜索失败'\n        uni.showToast({\n          title: errorMsg,\n          icon: 'none',\n          duration: 2000\n        })\n        \n        if (isRefresh) {\n          partnersList.value = []\n          total.value = 0\n        }\n      }\n    } catch (error) {\n      console.error('搜索伴友师失败:', error)\n      console.error('错误详情:', error.response || error)\n      \n      let errorMsg = '搜索失败，请重试'\n      if (error.response && error.response.data) {\n        errorMsg = error.response.data.message || errorMsg\n      }\n      \n      uni.showToast({\n        title: errorMsg,\n        icon: 'none',\n        duration: 2000\n      })\n      \n      if (isRefresh) {\n        partnersList.value = []\n        total.value = 0\n      }\n    } finally {\n      loading.value = false\n      dataLoaded.value = true // 标记数据已加载完成\n    }\n  }\n  \n  // 加载更多\n  const loadMore = () => {\n    if (!loading.value && hasMore.value) {\n      searchCompanionsData(false)\n    }\n  }\n  \n  // 下拉刷新\n  const onRefresh = async () => {\n    isRefreshing.value = true\n    await searchCompanionsData(true)\n        // 模拟加载时间，确保用户能看到刷新动画\n      await new Promise(resolve => setTimeout(resolve, 800))\n    isRefreshing.value = false\n  }\n  \n  // 监听搜索输入\n  const onSearchInput = () => {\n    // 防抖搜索\n    clearTimeout(searchTimer)\n    searchTimer = setTimeout(() => {\n      searchCompanionsData(true)\n    }, 500)\n  }\n  \n  let searchTimer = null\n  \n  // 返回按钮处理\n  const handleBack = () => {\n    uni.navigateBack({\n      delta: 1\n    })\n  }\n  \n  // 城市选择相关方法 - 使用全局store\n  // 选择城市（单选）- 直接生效\n  const onCitySelected = async (index) => {\n    // 提供触觉反馈\n    uni.vibrateShort({\n      type: 'light'\n    })\n    \n    // 重新搜索数据\n    await searchCompanionsData(true)\n  }\n  \n  \n  \n  onMounted(async () => {\n    // 获取页面参数\n    const pages = getCurrentPages()\n    const currentPage = pages[pages.length - 1]\n    const options = currentPage.options || {}\n    \n    // 接收service_id参数\n    if (options.service_id) {\n      serviceId.value = options.service_id\n      console.log('接收到的服务ID:', serviceId.value)\n    }\n    \n    // 获取状态栏高度和胶囊按钮信息\n    const systemInfo = uni.getSystemInfoSync()\n    statusBarHeight.value = systemInfo.statusBarHeight\n    \n    // 获取胶囊按钮信息（小程序特有）\n    // #ifdef MP-WEIXIN\n    const menuButtonInfo = uni.getMenuButtonBoundingClientRect()\n    menuButtonInfo.value = menuButtonInfo\n    \n    // 计算安全区域右边距\n    const screenWidth = systemInfo.screenWidth\n    const menuButtonRight = menuButtonInfo.right\n    safeAreaRight.value = screenWidth - menuButtonRight + 24 // 24rpx的额外间距\n    // #endif\n    \n    // 确保服务等级列表已加载\n    await levelStore.fetchServiceLevels()\n    \n    // 初始化城市数据（获取位置和加载城市列表）\n    await cityStore.initCityData()\n    \n    // 加载初始数据\n    await searchCompanionsData(true)\n  })\n  \n  onUnmounted(() => {\n    if (searchTimer) {\n      clearTimeout(searchTimer)\n    }\n  })\n  </script>\n  \n  <style lang=\"scss\" scoped>\n  @import \"@/styles/variables.scss\";\n  \n  .friends-container {\n    height: 100vh;\n    background-color: #F7F8FA;\n    display: flex;\n    flex-direction: column;\n  }\n  \n  .header {\n    background: linear-gradient(135deg, #FFFFFF 0%, rgba(247, 248, 250, 0.95) 100%);\n    padding: 20rpx 24rpx;\n    border-bottom: none;\n    box-shadow: 0 6rpx 24rpx rgba(130, 160, 216, 0.05);\n    border-radius: 0 0 32rpx 32rpx;\n    position: relative;\n    overflow: hidden;\n    backdrop-filter: blur(20rpx);\n    -webkit-backdrop-filter: blur(20rpx);\n  }\n  \n  .header-top {\n    display: flex;\n    align-items: center;\n    gap: 12rpx;\n    margin-bottom: 20rpx;\n  }\n  \n  .back-icon {\n    width: 48rpx;\n    height: 48rpx;\n    padding: 8rpx;\n    box-sizing: border-box;\n  }\n  \n  \n  \n  .search-container {\n    width: 350rpx;\n    position: relative;\n    display: flex;\n    align-items: center;\n    min-width: 0; /* 防止flex子元素溢出 */\n    \n    /* 小程序胶囊按钮适配 */\n    /* #ifdef MP-WEIXIN */\n    box-sizing: border-box;\n    /* #endif */\n  }\n  \n  .search-icon {\n    position: absolute;\n    left: 16rpx;\n    top: 50%;\n    transform: translateY(-50%);\n    width: 28rpx;\n    height: 28rpx;\n    opacity: 0.5;\n  }\n  \n  .search-input {\n    width: 100%;\n    padding: 0rpx 16rpx 0rpx 48rpx;\n    border: none;\n    background: rgba(115, 99, 255, 0.08);\n    border-radius: 32rpx;\n    font-size: 24rpx;\n    color: #1A1A1A;\n    height: 64rpx;\n    box-sizing: border-box;\n    line-height: 64rpx;\n    \n    &::placeholder {\n      color: rgba(115, 99, 255, 0.6);\n      font-size: 24rpx;\n    }\n  }\n  \n\n  \n  \n  \n  .main-content {\n    flex: 1;\n    display: flex;\n    overflow: hidden;\n    box-sizing: border-box;\n  }\n  \n  .partner-list {\n    flex: 1;\n    box-sizing: border-box;\n  }\n  \n  .partner-card {\n    display: flex;\n    padding: 24rpx;\n    background: #FFFFFF;\n    border-radius: 24rpx;\n    margin: 20rpx;\n    box-sizing: border-box;\n    box-shadow: 0 4rpx 16rpx rgba(115, 99, 255, 0.08);\n    border: 1rpx solid rgba(115, 99, 255, 0.05);\n  }\n  \n  .avatar-wrapper {\n    position: relative;\n    margin-right: 24rpx;\n  }\n  \n  .avatar {\n    width: 160rpx;\n    height: 200rpx;\n    border-radius: 16rpx;\n  }\n  \n  .status-dot {\n    position: absolute;\n    top: 8rpx;\n    right: 8rpx;\n    width: 16rpx;\n    height: 16rpx;\n    background: #4CAF50;\n    border-radius: 50%;\n    border: 2rpx solid #FFFFFF;\n  }\n  \n  .partner-info {\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n    justify-content: space-between;\n  }\n  \n  .partner-name-row {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    margin-bottom: 8rpx;\n  }\n  \n  .partner-name {\n    font-size: 28rpx;\n    font-weight: 600;\n    color: #1A1A1A;\n    display: flex;\n    align-items: center;\n    gap: 8rpx;\n  }\n  \n  .gender-icon {\n    width: 28rpx;\n    height: 28rpx;\n    margin-right: 6rpx;\n  }\n  \n  .partner-meta {\n    font-size: 22rpx;\n    color: #666666;\n  \n  }\n  .partner-meta-distance {\n    font-size: 20rpx;\n    color: #007BFF;\n    display: flex;\n    align-items: center;\n    gap: 6rpx;\n  }\n  \n  .distance-icon {\n    width: 20rpx;\n    height: 20rpx;\n  }\n  .partner-tags {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 8rpx;\n    margin-bottom: 16rpx;\n  }\n  \n  .tag {\n    font-size: 20rpx;\n    color: #7363FF;\n    background: rgba(115, 99, 255, 0.1);\n    padding: 4rpx 12rpx;\n    border-radius: 12rpx;\n    border: 1rpx solid rgba(115, 99, 255, 0.2);\n  }\n  \n  .more-tags {\n    font-size: 20rpx;\n    color: #999999;\n    background: rgba(153, 153, 153, 0.1);\n    padding: 4rpx 12rpx;\n    border-radius: 12rpx;\n  }\n  \n  .partner-actions {\n    display: flex;\n    gap: 12rpx;\n  }\n  \n  .schedule-btn {\n    width: auto;\n    min-width: 160rpx;\n    height: 64rpx;\n    border-radius: 32rpx;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-size: 24rpx;\n    font-weight: 600;\n    transition: all 0.3s ease;\n    background: linear-gradient(135deg, #7363FF 0%, #FF69DE 100%);\n    color: #FFFFFF;\n    box-shadow: 0 4rpx 12rpx rgba(115, 99, 255, 0.3);\n    padding: 0 32rpx;\n    \n    &:active {\n      transform: scale(0.95);\n    }\n  }\n  \n\n  \n  \n  \n  /* 空状态样式 */\n  .empty-state {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    padding: 260rpx 60rpx;\n    text-align: center;\n  }\n  \n  .empty-icon {\n    width: 200rpx;\n    height: 200rpx;\n    margin-bottom: 32rpx;\n    opacity: 0.6;\n  }\n  \n  .empty-text {\n    font-size: 32rpx;\n    color: #1A1A1A;\n    font-weight: 600;\n    margin-bottom: 16rpx;\n  }\n  \n  .empty-desc {\n    font-size: 24rpx;\n    color: #666666;\n    line-height: 1.4;\n  }\n  \n  /* 加载状态样式 */\n  .loading-state {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    padding: 120rpx 60rpx;\n    text-align: center;\n  }\n  \n  .loading-spinner {\n    width: 60rpx;\n    height: 60rpx;\n    border: 6rpx solid #f0f0f0;\n    border-top: 6rpx solid #7363ff;\n    border-radius: 50%;\n    animation: spin 1s linear infinite;\n    margin-bottom: 32rpx;\n  }\n  \n  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n  }\n  \n  .loading-text {\n    font-size: 28rpx;\n    color: #666666;\n    font-weight: 500;\n  }\n  \n  /* 服务选择弹窗样式 */\n  .service-popup-content {\n    width: 100%;\n    height: 100%;\n    display: flex;\n    flex-direction: column;\n    background-color: #FFFFFF;\n    border-radius: 24rpx 24rpx 0 0;\n    overflow: hidden;\n  }\n  \n  .service-popup-header {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    padding: 32rpx;\n    border-bottom: 1rpx solid rgba(115, 99, 255, 0.1);\n  }\n  \n  .service-popup-title {\n    font-size: 32rpx;\n    font-weight: 600;\n    color: #1A1A1A;\n  }\n  \n  .close-popup-btn {\n    padding: 8rpx;\n  }\n  \n  .close-popup-icon {\n    width: 32rpx;\n    height: 32rpx;\n  }\n  \n  .service-popup-body {\n    flex: 1;\n    padding: 24rpx 32rpx;\n    box-sizing: border-box;\n  }\n  \n  .service-scroll-view {\n    height: 600rpx;\n    width: 100%;\n  }\n  \n  .service-list {\n    display: flex;\n    flex-direction: column;\n    gap: 20rpx;\n    padding-bottom: 20rpx;\n  }\n  \n  .service-item {\n    display: flex;\n    align-items: center;\n  \n  \n    box-sizing: border-box;\n  }\n  \n  .service-img {\n    width: 120rpx;\n    height: 120rpx;\n    border-radius: 12rpx;\n    margin-right: 20rpx;\n  }\n  \n  .service-info {\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n    justify-content: space-between;\n  }\n  \n  .service-title-row {\n    display: flex;\n    align-items: center;\n    gap: 8rpx;\n  }\n  \n  .service-title {\n    font-size: 24rpx;\n    font-weight: 500;\n    color: #1A1A1A;\n  }\n  \n  .service-tags {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 8rpx;\n    margin-top: 8rpx;\n  }\n  \n  .service-tag {\n    font-size: 18rpx;\n    color: #7363FF;\n    background: rgba(115, 99, 255, 0.1);\n    padding: 4rpx 12rpx;\n    border-radius: 12rpx;\n    border: 1rpx solid rgba(115, 99, 255, 0.2);\n  }\n  \n  .service-bottom-row {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    margin-top: 8rpx;\n  }\n  \n  .service-price {\n    font-size: 24rpx;\n    color: #f43f5e;\n    font-weight: 600;\n  }\n  \n  .order-btn {\n    width: 160rpx;\n    height: 64rpx;\n    border-radius: 32rpx;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-size: 24rpx;\n    font-weight: 600;\n    background: linear-gradient(135deg, #7363FF 0%, #FF69DE 100%);\n    color: #FFFFFF;\n    box-shadow: 0 4rpx 12rpx rgba(115, 99, 255, 0.3);\n  }\n  \n  .empty-service-state {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    padding: 120rpx 60rpx;\n    text-align: center;\n  }\n  \n  .empty-service-icon {\n    width: 200rpx;\n    height: 200rpx;\n    margin-bottom: 32rpx;\n    opacity: 0.6;\n  }\n  \n  .empty-service-text {\n    font-size: 32rpx;\n    color: #1A1A1A;\n    font-weight: 600;\n    margin-bottom: 16rpx;\n  }\n  \n  </style> ","import MiniProgramPage from '/Users/xiaoqiang/Documents/friemd/firend-loving-app/subPackages/friend/friend-select.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","computed","useCityStore","useLevelStore","getCityServices","uni","searchCompanions","onMounted","currentPage","onUnmounted"],"mappings":";;;;;;;;;;;;;;;AA8IE,MAAM,eAAe,MAAW;AAChC,MAAM,aAAa,MAAW;;;;AAG9B,UAAM,kBAAkBA,cAAG,IAAC,CAAC;AACNA,kBAAAA,IAAI,IAAI;AAC/B,UAAM,gBAAgBA,cAAG,IAAC,CAAC;AAG3B,UAAM,SAASA,cAAG,IAAC,EAAE;AACrB,UAAM,eAAeA,cAAG,IAAC,KAAK;AAC9B,UAAM,iBAAiBA,cAAG,IAAC,KAAK;AAChC,UAAM,YAAYA,cAAG,IAAC,EAAE;AAGxB,UAAM,WAAWC,cAAAA,SAAS,MAAA;;AAAM,8BAAU,iBAAV,mBAAwB,aAAY;AAAA,KAAI;AACxE,UAAM,YAAYA,cAAAA,SAAS,MAAA;;AAAM,8BAAU,iBAAV,mBAAwB,cAAa;AAAA,KAAI;AAC/CD,kBAAAA,IAAI,KAAK;AAGpC,UAAM,YAAYE,YAAAA,aAAc;AAGfD,2BAAS,MAAM,UAAU,QAAQ;AAC7BA,2BAAS,MAAM,UAAU,WAAW;AAKzD,UAAM,eAAeD,cAAG,IAAC,EAAE;AAC3B,UAAM,QAAQA,cAAG,IAAC,CAAC;AACnB,UAAM,cAAcA,cAAG,IAAC,CAAC;AACzB,UAAM,WAAWA,cAAG,IAAC,EAAE;AACvB,UAAM,UAAUA,cAAG,IAAC,KAAK;AACzB,UAAM,UAAUA,cAAG,IAAC,IAAI;AACxB,UAAM,aAAaA,cAAG,IAAC,KAAK;AAG5B,UAAM,aAAaG,aAAAA,cAAe;AAGlC,UAAM,wBAAwBF,cAAAA,SAAS,WAAW;AAChD,aAAO,aAAa,MAAM,IAAI,SAAS,SAAS;AAC9C,cAAM,cAAc,QAAQ,OAAO,QAAQ,KAAK,MAAM,GAAG,CAAC,IAAI,CAAE;AAChE,cAAM,YAAY,QAAQ,QAAQ,QAAQ,KAAK,SAAS,IAAI,QAAQ,KAAK,SAAS,IAAI;AACtF,eAAO;AAAA,UACL,GAAG;AAAA,UACH;AAAA,UACA;AAAA,QACD;AAAA,MACP,CAAK;AAAA,IACL,CAAG;AAKD,UAAM,eAAeD,cAAG,IAAC,IAAI;AAC7B,UAAM,yBAAyBA,cAAG,IAAC,EAAE;AACrC,UAAM,iBAAiBA,cAAG,IAAC,IAAI;AAC/B,UAAM,YAAYA,cAAG,IAAC,CAAC;AAGvB,UAAM,mBAAmB,OAAO,YAAY;AAC1C,qBAAe,QAAQ;AAEvB,UAAI;AAEF,cAAM,gBAAgB;AAAA,UACpB,WAAW,UAAU;AAAA,UACrB,gBAAgB,QAAQ;AAAA,QACzB;AAGD,YAAI,SAAS,SAAS,UAAU,OAAO;AACrC,wBAAc,WAAW,WAAW,SAAS,KAAK;AAClD,wBAAc,YAAY,WAAW,UAAU,KAAK;AAAA,QACrD;AAED,cAAM,WAAW,MAAMI,YAAe,gBAAC,aAAa;AAEpD,YAAI,SAAS,QAAQ,SAAS,KAAK,SAAS,GAAG;AAC7C,gBAAM,OAAO,SAAS,KAAK;AAC3B,cAAI,QAAQ,KAAK,YAAY,KAAK,SAAS,SAAS,GAAG;AACrD,mCAAuB,QAAQ,KAAK,SAAS,IAAI,cAAY;AAAA,cAC3D,OAAO,QAAQ;AAAA,cACf,KAAK,kEAAkE,QAAQ,qBAAqB;AAAA,cACpG,MAAM,QAAQ,gBAAgB,CAAE;AAAA,cAChC,OAAO,QAAQ;AAAA,cACf,YAAY,QAAQ;AAAA,cACpB,mBAAmB,QAAQ,qBAAqB;AAAA,cAChD,MAAM,QAAQ;AAAA,cACd,cAAc,QAAQ;AAAA,YAElC,EAAY;AAAA,UAEZ,OAAe;AACL,mCAAuB,QAAQ,CAAE;AAAA,UAClC;AAAA,QACT,OAAa;AACL,iCAAuB,QAAQ,CAAE;AAAA,QAClC;AAAA,MACF,SAAQ,OAAO;AACdC,sBAAAA,oEAAc,aAAa,KAAK;AAChC,+BAAuB,QAAQ,CAAE;AAAA,MAClC;AAED,mBAAa,MAAM,KAAM;AAAA,IAC1B;AAGD,UAAM,oBAAoB,MAAM;AAC9B,mBAAa,MAAM,MAAO;AAAA,IAC3B;AAGD,UAAM,aAAa,CAAC,SAAS;AAC3BA,oBAAAA,MAAY,MAAA,OAAA,+CAAA,SAAS,IAAI;AACzB,wBAAmB;AAGnB,UAAI,MAAM,wCAAwC,KAAK,UAAU,sBAAsB,KAAK,qBAAqB,EAAE,iBAAiB,eAAe,MAAM,EAAE,gBAAgB,eAAe,MAAM,eAAe,EAAE,aAAa,eAAe,MAAM,IAAI;AAGvP,UAAI,UAAU,OAAO;AACnB,eAAO,wBAAwB,UAAU,KAAK;AAAA,MAC/C;AAGDA,oBAAAA,MAAI,WAAW;AAAA,QACb;AAAA,MACN,CAAK;AAAA,IACF;AAGD,UAAM,mBAAmB,CAAC,cAAc;AACtC,UAAI,MAAM,mCAAmC,YAAY,gBAAgB,UAAU;AAGnF,UAAI,SAAS,SAAS,UAAU,OAAO;AACrC,eAAO,eAAe,SAAS,QAAQ,gBAAgB,UAAU;AAAA,MAClE;AAEDA,oBAAAA,MAAI,WAAW;AAAA,QACb;AAAA,MACN,CAAK;AAAA,IACF;AAkDD,UAAM,uBAAuB,OAAO,YAAY,UAAU;;AACxD,UAAI,QAAQ;AAAO;AAEnB,cAAQ,QAAQ;AAEhB,UAAI;AACF,cAAM,SAAS;AAAA,UACb,MAAM,YAAY,IAAI,YAAY;AAAA,UAClC,WAAW,SAAS;AAAA,QACrB;AAGD,YAAI,UAAU,iBAAiB;AAC7B,iBAAO,YAAY,UAAU;AAAA,QAC9B;AAGD,YAAI,OAAO,SAAS,OAAO,MAAM,KAAI,GAAI;AACrC,iBAAO,WAAW,OAAO,MAAM,KAAM;AAAA,QACxC;AAGD,YAAI,SAAS,SAAS,UAAU,OAAO;AACrC,iBAAO,WAAW,SAAS;AAC3B,iBAAO,YAAY,UAAU;AAAA,QAC9B;AAGD,YAAI,UAAU,OAAO;AACnB,iBAAO,aAAa,UAAU;AAAA,QAC/B;AAIDA,sBAAAA,MAAY,MAAA,OAAA,+CAAA,SAAS,MAAM;AAE3B,cAAM,WAAW,MAAMC,YAAgB,iBAAC,MAAM;AAE9CD,sBAAAA,MAAY,MAAA,OAAA,+CAAA,YAAY,QAAQ;AAEhC,YAAI,SAAS,QAAQ,SAAS,KAAK,SAAS,GAAG;AAC7C,gBAAM,OAAO,SAAS,KAAK;AAC3B,cAAI,QAAQ,KAAK,MAAM;AACrB,kBAAM,UAAU,KAAK,KAAK,IAAI,WAAS;AAAA,cACrC,IAAI,KAAK;AAAA,cACT,MAAM,KAAK;AAAA,cACX,QAAQ,KAAK;AAAA,cACb,KAAK,KAAK;AAAA,cACV,QAAQ,KAAK;AAAA,cACb,QAAQ,KAAK;AAAA,cACb,UAAU,KAAK;AAAA,cACf,MAAM,KAAK,QAAQ,CAAE;AAAA,cACrB,WAAW,MAAM;AACf,oBAAI,OAAO,KAAK,aAAa,UAAU;AACrC,sBAAI;AACF,2BAAO,KAAK,MAAM,KAAK,QAAQ;AAAA,kBAChC,SAAQ,GAAG;AACVA,kCAAAA,oEAAc,sBAAsB,CAAC;AACrC,2BAAO,CAAE;AAAA,kBACV;AAAA,gBACF;AACD,uBAAO,KAAK,YAAY,CAAE;AAAA,cACxC,GAAgB;AAAA;AAAA,cACJ,QAAQ,KAAK;AAAA,cACb,QAAQ,KAAK,cAAc;AAAA,cAC3B,UAAU,KAAK,sBAAsB;AAAA,YACjD,EAAY;AAEF,gBAAI,WAAW;AACb,2BAAa,QAAQ;AACrB,0BAAY,QAAQ;AAAA,YAChC,OAAiB;AACL,2BAAa,QAAQ,CAAC,GAAG,aAAa,OAAO,GAAG,OAAO;AACvD,0BAAY;AAAA,YACb;AAED,kBAAM,QAAQ,KAAK,SAAS;AAC5B,oBAAQ,QAAQ,QAAQ,WAAW,SAAS;AAE5CA,gCAAA,MAAA,OAAA,+CAAY,YAAY,QAAQ,QAAQ,WAAW,MAAM,KAAK;AAG9D,gBAAI,QAAQ,WAAW,KAAK,WAAW;AAAA,YAMtC;AAAA,UACX,OAAe;AACLA,0BAAAA,MAAA,MAAA,OAAA,+CAAY,WAAW;AACvB,gBAAI,WAAW;AACb,2BAAa,QAAQ,CAAE;AACvB,oBAAM,QAAQ;AAAA,YACf;AAAA,UAEF;AAAA,QACT,OAAa;AACLA,wBAAc,MAAA,MAAA,SAAA,+CAAA,YAAY,SAAS,IAAI;AACvC,gBAAM,aAAW,cAAS,SAAT,mBAAe,YAAW;AAC3CA,wBAAAA,MAAI,UAAU;AAAA,YACZ,OAAO;AAAA,YACP,MAAM;AAAA,YACN,UAAU;AAAA,UACpB,CAAS;AAED,cAAI,WAAW;AACb,yBAAa,QAAQ,CAAE;AACvB,kBAAM,QAAQ;AAAA,UACf;AAAA,QACF;AAAA,MACF,SAAQ,OAAO;AACdA,sBAAAA,MAAc,MAAA,SAAA,+CAAA,YAAY,KAAK;AAC/BA,0FAAc,SAAS,MAAM,YAAY,KAAK;AAE9C,YAAI,WAAW;AACf,YAAI,MAAM,YAAY,MAAM,SAAS,MAAM;AACzC,qBAAW,MAAM,SAAS,KAAK,WAAW;AAAA,QAC3C;AAEDA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,UACN,UAAU;AAAA,QAClB,CAAO;AAED,YAAI,WAAW;AACb,uBAAa,QAAQ,CAAE;AACvB,gBAAM,QAAQ;AAAA,QACf;AAAA,MACP,UAAc;AACR,gBAAQ,QAAQ;AAChB,mBAAW,QAAQ;AAAA,MACpB;AAAA,IACF;AAGD,UAAM,WAAW,MAAM;AACrB,UAAI,CAAC,QAAQ,SAAS,QAAQ,OAAO;AACnC,6BAAqB,KAAK;AAAA,MAC3B;AAAA,IACF;AAGD,UAAM,YAAY,YAAY;AAC5B,mBAAa,QAAQ;AACrB,YAAM,qBAAqB,IAAI;AAE7B,YAAM,IAAI,QAAQ,aAAW,WAAW,SAAS,GAAG,CAAC;AACvD,mBAAa,QAAQ;AAAA,IACtB;AAGD,UAAM,gBAAgB,MAAM;AAE1B,mBAAa,WAAW;AACxB,oBAAc,WAAW,MAAM;AAC7B,6BAAqB,IAAI;AAAA,MAC1B,GAAE,GAAG;AAAA,IACP;AAED,QAAI,cAAc;AAGlB,UAAM,aAAa,MAAM;AACvBA,oBAAAA,MAAI,aAAa;AAAA,QACf,OAAO;AAAA,MACb,CAAK;AAAA,IACF;AAID,UAAM,iBAAiB,OAAO,UAAU;AAEtCA,oBAAAA,MAAI,aAAa;AAAA,QACf,MAAM;AAAA,MACZ,CAAK;AAGD,YAAM,qBAAqB,IAAI;AAAA,IAChC;AAIDE,kBAAAA,UAAU,YAAY;AAEpB,YAAM,QAAQ,gBAAiB;AAC/B,YAAMC,eAAc,MAAM,MAAM,SAAS,CAAC;AAC1C,YAAM,UAAUA,aAAY,WAAW,CAAE;AAGzC,UAAI,QAAQ,YAAY;AACtB,kBAAU,QAAQ,QAAQ;AAC1BH,sBAAY,MAAA,MAAA,OAAA,+CAAA,aAAa,UAAU,KAAK;AAAA,MACzC;AAGD,YAAM,aAAaA,cAAG,MAAC,kBAAmB;AAC1C,sBAAgB,QAAQ,WAAW;AAInC,YAAM,iBAAiBA,cAAG,MAAC,gCAAiC;AAC5D,qBAAe,QAAQ;AAGvB,YAAM,cAAc,WAAW;AAC/B,YAAM,kBAAkB,eAAe;AACvC,oBAAc,QAAQ,cAAc,kBAAkB;AAItD,YAAM,WAAW,mBAAoB;AAGrC,YAAM,UAAU,aAAc;AAG9B,YAAM,qBAAqB,IAAI;AAAA,IACnC,CAAG;AAEDI,kBAAAA,YAAY,MAAM;AAChB,UAAI,aAAa;AACf,qBAAa,WAAW;AAAA,MACzB;AAAA,IACL,CAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjjBH,GAAG,WAAW,eAAe;"}