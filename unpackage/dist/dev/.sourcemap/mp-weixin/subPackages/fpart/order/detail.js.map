{"version":3,"file":"detail.js","sources":["subPackages/fpart/order/detail.vue","subPackages/fpart/order/detail.vue?type=page"],"sourcesContent":["<template>\n  <view class=\"order-detail-container\">\n    <scroll-view \n      scroll-y=\"true\" \n      class=\"scroll-content\" \n    >\n\n\n      <!-- 服务信息 -->\n      <view class=\"service-section\">\n        <view class=\"section-header\">\n          <text class=\"section-title\">服务信息</text>\n        </view>\n        \n        <view class=\"service-card\">\n          <view class=\"service-info\">\n            <image :src=\"$imgBaseUrl + orderDetail.service_image_url\" class=\"service-image\" mode=\"aspectFill\" />\n            <view class=\"service-details\">\n              <text class=\"service-name\">{{ orderDetail.service_name }}</text>\n              <view class=\"service-meta\">\n                <text class=\"service-price\">¥{{ orderDetail.unit_price }}/{{ orderDetail.unit }}</text>\n                <text class=\"service-quantity\">x{{ orderDetail.quantity }}</text>\n              </view>\n              <view class=\"service-amount\">\n                <view></view>\n                 <view>\n                  <text class=\"amount-label\">订单金额：</text>\n                  <text class=\"amount-value\">¥{{ orderDetail.total_amount }}</text>\n                 </view>\n              </view>\n            </view>\n          </view>\n          \n          <!-- 服务地址和时间 -->\n          <view class=\"service-details-info\">\n            <view class=\"detail-item\">\n              <text class=\"detail-label\">服务信息：</text>\n              <view class=\"customer-info\">\n                <text class=\"detail-value\">{{ orderDetail?.user?.nick_name }} {{ orderDetail?.user?.phone }}</text>\n              </view>\n            </view>\n            <view class=\"detail-item\">\n              <text class=\"detail-label\">服务地址：</text>\n              <view class=\"detail-value-container\">\n                <text class=\"detail-value\">{{ orderDetail.service_address }}</text>\n                <view class=\"location-actions\" v-if=\"[2, 3, 4, 5, 11].includes(orderDetail.status)\">\n                  <view class=\"nav-btn\" @click=\"openLocation(orderDetail)\">\n                    <text class=\"nav-text\">导航</text>\n                  </view>\n                </view>\n              </view>\n            </view>\n            <view class=\"detail-item\">\n              <text class=\"detail-label\">预约时间：</text>\n              <text class=\"detail-value\">{{ formatServiceDateTime(orderDetail.service_date, orderDetail.service_time) }}</text>\n            </view>\n          </view>\n        </view>\n      </view>\n\n      <!-- 订单信息 -->\n      <view class=\"order-info-section\">\n        <view class=\"section-header\">\n          <text class=\"section-title\">订单信息</text>\n        </view>\n        \n        <view class=\"detail-card\">\n          <view class=\"detail-item\">\n            <text class=\"detail-label\">订单号：</text>\n            <view class=\"detail-value-container\">\n              <text class=\"detail-value-order\">{{ orderDetail.order_no}}</text>\n              <image \n                src=\"/static/icons/common/copy.png\" \n                class=\"copy-icon\" \n                @click=\"copyOrderNo(orderDetail.order_no)\"\n                mode=\"aspectFit\"\n              />\n            </view>\n          </view>\n          <view v-if=\"orderDetail.start_time\" class=\"detail-item\">\n            <text class=\"detail-label\">开始时间：</text>\n            <text class=\"detail-value\">{{ formatTime(orderDetail.start_time) }}</text>\n          </view>\n          <view v-if=\"orderDetail.end_time\" class=\"detail-item\">\n            <text class=\"detail-label\">结束时间：</text>\n            <text class=\"detail-value\">{{ formatTime(orderDetail.end_time) }}</text>\n          </view>\n          <view class=\"detail-item\">\n            <text class=\"detail-label\">下单时间：</text>\n            <text class=\"detail-value\">{{ formatTime(orderDetail.created_at) }}</text>\n          </view>\n          <view v-if=\"orderDetail.payment_time\" class=\"detail-item\">\n            <text class=\"detail-label\">支付时间：</text>\n            <text class=\"detail-value\">{{ formatTime(orderDetail.payment_time) }}</text>\n          </view>\n          <view v-if=\"orderDetail.remark\" class=\"detail-item\">\n            <text class=\"detail-label\">备注：</text>\n            <text class=\"detail-value remark-text\">{{ orderDetail.remark }}</text>\n          </view>\n        </view>\n      </view>\n    </scroll-view>\n\n    <!-- 操作按钮 -->\n    <view class=\"action-buttons\">\n      <view class=\"action-container\">\n        <view \n          v-for=\"(action, index) in getOrderActions(orderDetail.status, orderDetail)\" \n          :key=\"index\"\n          class=\"action-btn\"\n          :class=\"action.type\"\n          @click=\"handleOrderAction(action.action, orderDetail)\"\n        >\n          <text class=\"action-text\">{{ action.text }}</text>\n        </view>\n      </view>\n    </view>\n  </view>\n</template>\n\n<script setup>\nimport { ref, onMounted } from 'vue'\nimport { onLoad } from '@dcloudio/uni-app'\nimport { \n  getCompanionOrderDetail,\n  acceptCompanionOrder,\n  rejectCompanionOrder,\n  arrivedCompanionOrder,\n  departCompanionOrder,\n  startCompanionService,\n  endCompanionService,\n  deleteCompanionOrder\n} from '@/api/order.js'\nimport { useUserStore } from '@/stores/user.js'\n// 用户状态管理\nconst userStore = useUserStore()\n// 订单详情数据\nconst orderDetail = ref({})\nconst orderId = ref(null)\nconst companionId = ref(null)\n\n\n\n// 页面加载\nonLoad((options) => {\n  // 检查登录状态\n  if (!userStore.userInfo || Object.keys(userStore.userInfo).length === 0 || !userStore.token) {\n    uni.showToast({\n      title: '请先登录',\n      icon: 'none'\n    })\n    setTimeout(() => {\n      uni.navigateTo({\n        url: '/subPackages/login/index'\n      })\n    }, 1500)\n    return\n  }\n  \n  if (options.orderId) {\n    orderId.value = options.orderId\n  }\n  if (options.companion_id) {\n      companionId.value = options.companion_id\n  }\n  loadOrderDetail()\n})\n\n// 加载订单详情\nconst loadOrderDetail = async () => {\n  try {\n    uni.showLoading({ title: '加载中...' })\n    \n    const response = await getCompanionOrderDetail({ \n      order_id: Number(orderId.value),\n      companion_id: Number(companionId.value)\n    })\n    \n    if (response.data.code === 0) {\n      // 合并订单信息和日志数据\n      orderDetail.value = {\n        ...response.data.data.order,\n        logs: response.data.data.logs || []\n      }\n    } else {\n      throw new Error(response.data.msg || '获取订单详情失败')\n    }\n  } catch (error) {\n    console.error('加载订单详情失败:', error)\n    uni.showToast({\n      title: error.message || '加载失败',\n      icon: 'none'\n    })\n  } finally {\n    uni.hideLoading()\n  }\n}\n\n\n\n// 获取状态样式类\nconst getStatusClass = (status) => {\n  const statusMap = {\n    1: 'status-pending',      // 待付款\n    2: 'status-to-serve',     // 待服务（已支付待确认）\n    3: 'status-to-serve',     // 待服务（已确认待到达）\n    4: 'status-to-serve',     // 待服务（已到达待开始）\n    5: 'status-in-progress',  // 进行中\n    6: 'status-completed',    // 已完成\n    7: 'status-cancelled',    // 已取消\n    8: 'status-cancelled',    // 已取消（原已退款）\n    9: 'status-cancelled',    // 已取消（原退款中）\n    11: 'status-to-serve'     // 待服务（已确认待开始出发）\n  }\n  return statusMap[status] || 'status-default'\n}\n\n// 获取状态文本\nconst getStatusText = (status) => {\n  const statusMap = {\n    1: '待付款',\n    2: '等待接单',\n    3: '我已出发',\n    4: '已到达，等待开始服务',\n    5: '服务中',\n    6: '已完成',\n    7: '已取消',\n    8: '已取消',\n    9: '已取消',\n    11: '待服务'\n  }\n  return statusMap[status] || '未知状态'\n}\n\n// 获取订单操作按钮\nconst getOrderActions = (status, order) => {\n  const actionMap = {\n    2: [ // 已支付待确认\n      { text: '拒绝', action: 'reject', type: 'secondary' },\n      { text: '接单', action: 'accept', type: 'primary' }\n    ],\n    3: [ // 已确认待到达\n      { text: '电话联系', action: 'contact', type: 'secondary' },\n      { text: '我已到达服务地点', action: 'arrived', type: 'primary' }\n    ],\n    4: [ // 已到达待开始\n      { text: '电话联系', action: 'call', type: 'secondary' }\n    ],\n    5: [ // 服务中\n      { text: '电话联系', action: 'contact', type: 'secondary' },\n      { text: '结束服务', action: 'end', type: 'primary' }\n    ],\n    6: [ // 已完成\n      ...(order.is_comment === 1 ? [{ text: '查看评价', action: 'review', type: 'secondary' }] : []),\n      { text: '删除订单', action: 'delete', type: 'secondary' }\n    ],\n    7: [ // 已取消\n      { text: '删除订单', action: 'delete', type: 'secondary' }\n    ],\n    8: [ // 已取消（原已退款）\n      { text: '删除订单', action: 'delete', type: 'secondary' }\n    ],\n    9: [ // 已取消（原退款中）\n      { text: '订单已取消，给客户退款中', action: 'info', type: 'info' }\n    ],\n    11: [ // 已确认待开始出发\n      { text: '电话联系', action: 'contact', type: 'secondary' },\n      { text: '我已出发', action: 'depart', type: 'depart' }\n    ]\n  }\n  return actionMap[status] || []\n}\n\n// 处理订单操作\nconst handleOrderAction = (action, order) => {\n  switch (action) {\n    case 'contact':\n      handleContactCustomer(order)\n      break\n    case 'accept':\n      handleAcceptOrder(order)\n      break\n    case 'reject':\n      handleRejectOrder(order)\n      break\n    case 'arrived':\n      handleArrived(order)\n      break\n    case 'depart':\n      handleDepart(order)\n      break\n    case 'call':\n      handleCallCustomer(order)\n      break\n    case 'start':\n      handleStartService(order)\n      break\n    case 'end':\n      handleEndService(order)\n      break\n    case 'review':\n      handleViewReview(order)\n      break\n    case 'rebook':\n      handleRebookService(order)\n      break\n    case 'delete':\n      handleDeleteOrder(order)\n      break\n    case 'info':\n      // 信息提示，不执行任何操作\n      break\n  }\n}\n\n// 电话联系客户\nconst handleContactCustomer = (order) => {\n  if (order.user && order.user.phone) {\n    uni.showModal({\n      title: '电话联系',\n      content: `是否拨打客户 ${order.user.nick_name} 的电话？`,\n      confirmText: '拨打',\n      cancelText: '取消',\n      success: (res) => {\n        if (res.confirm) {\n          uni.makePhoneCall({\n            phoneNumber: order.user.phone\n          })\n        }\n      }\n    })\n  }\n}\n\n// 接单\nconst handleAcceptOrder = (order) => {\n  uni.showModal({\n    title: '确认接单',\n    content: '确定要接受这个订单吗？',\n    confirmText: '接单',\n    cancelText: '取消',\n    success: async (res) => {\n      if (res.confirm) {\n        try {\n          uni.showLoading({\n            title: '处理中...'\n          })\n          \n          const response = await acceptCompanionOrder({ \n            order_id: order.id,\n            companion_id: Number(companionId.value)\n          })\n          \n          if (response.data.code === 0) {\n            uni.showToast({\n              title: '接单成功',\n              icon: 'success'\n            })\n            \n            // 刷新订单详情\n            setTimeout(() => {\n              loadOrderDetail()\n            }, 1500)\n          } else {\n            throw new Error(response.data.msg || '接单失败')\n          }\n        } catch (error) {\n          console.error('接单失败:', error)\n          uni.showToast({\n            title: error.message || '接单失败',\n            icon: 'none'\n          })\n        } finally {\n          uni.hideLoading()\n        }\n      }\n    }\n  })\n}\n\n// 拒绝订单\nconst handleRejectOrder = (order) => {\n  uni.showModal({\n    title: '拒绝订单',\n    content: '确定要拒绝这个订单吗？',\n    confirmText: '拒绝',\n    cancelText: '取消',\n    success: async (res) => {\n      if (res.confirm) {\n        try {\n          uni.showLoading({\n            title: '处理中...'\n          })\n          \n          const response = await rejectCompanionOrder({ \n            order_id: order.id,\n            companion_id: Number(companionId.value)\n          })\n          \n          if (response.data.code === 0) {\n            uni.showToast({\n              title: '已拒绝订单',\n              icon: 'success'\n            })\n            \n            // 刷新订单详情\n            setTimeout(() => {\n              loadOrderDetail()\n            }, 1500)\n          } else {\n            throw new Error(response.data.msg || '拒绝订单失败')\n          }\n        } catch (error) {\n          console.error('拒绝订单失败:', error)\n          uni.showToast({\n            title: error.message || '操作失败',\n            icon: 'none'\n          })\n        } finally {\n          uni.hideLoading()\n        }\n      }\n    }\n  })\n}\n\n// 我已到达\nconst handleArrived = (order) => {\n  uni.showModal({\n    title: '确认到达',\n    content: '确认您已到达服务地点？',\n    confirmText: '确认',\n    cancelText: '取消',\n    success: async (res) => {\n      if (res.confirm) {\n        try {\n          uni.showLoading({\n            title: '更新中...'\n          })\n          \n          const response = await arrivedCompanionOrder({ \n            order_id: order.id,\n            companion_id: Number(companionId.value)\n          })\n          \n          if (response.data.code === 0) {\n            uni.showToast({\n              title: '已确认到达',\n              icon: 'success'\n            })\n            \n            // 刷新订单详情\n            setTimeout(() => {\n              loadOrderDetail()\n            }, 1500)\n          } else {\n            throw new Error(response.data.msg || '确认到达失败')\n          }\n        } catch (error) {\n          console.error('确认到达失败:', error)\n          uni.showToast({\n            title: error.message || '操作失败',\n            icon: 'none'\n          })\n        } finally {\n          uni.hideLoading()\n        }\n      }\n    }\n  })\n}\n\n// 电话联系客户\nconst handleCallCustomer = (order) => {\n  if (order.user && order.user.phone) {\n    uni.showModal({\n      title: '电话联系',\n      content: `是否拨打客户 ${order.user.nick_name} 的电话？`,\n      confirmText: '拨打',\n      cancelText: '取消',\n      success: (res) => {\n        if (res.confirm) {\n          uni.makePhoneCall({\n            phoneNumber: order.user.phone\n          })\n        }\n      }\n    })\n  }\n}\n\n// 我已出发\nconst handleDepart = (order) => {\n  uni.showModal({\n    title: '确认出发',\n    content: '确认您已开始出发前往服务地点？',\n    confirmText: '确认',\n    cancelText: '取消',\n    success: async (res) => {\n      if (res.confirm) {\n        try {\n          uni.showLoading({\n            title: '更新中...'\n          })\n          \n          const response = await departCompanionOrder({ \n            order_id: order.id,\n            companion_id: Number(companionId.value)\n          })\n          \n          if (response.data.code === 0) {\n            uni.showToast({\n              title: '已确认出发',\n              icon: 'success'\n            })\n            \n            // 刷新订单详情\n            setTimeout(() => {\n              loadOrderDetail()\n            }, 1500)\n          } else {\n            throw new Error(response.data.msg || '确认出发失败')\n          }\n        } catch (error) {\n          console.error('确认出发失败:', error)\n          uni.showToast({\n            title: error.message || '操作失败',\n            icon: 'none'\n          })\n        } finally {\n          uni.hideLoading()\n        }\n      }\n    }\n  })\n}\n\n// 开始服务\nconst handleStartService = (order) => {\n  uni.showModal({\n    title: '开始服务',\n    content: '确定要开始服务吗？',\n    confirmText: '开始',\n    cancelText: '取消',\n    success: async (res) => {\n      if (res.confirm) {\n        try {\n          uni.showLoading({\n            title: '更新中...'\n          })\n          \n          const response = await startCompanionService({ \n            order_id: order.id,\n            companion_id: Number(companionId.value)\n          })\n          \n          if (response.data.code === 0) {\n            uni.showToast({\n              title: '服务已开始',\n              icon: 'success'\n            })\n            \n            // 刷新订单详情\n            setTimeout(() => {\n              loadOrderDetail()\n            }, 1500)\n          } else {\n            throw new Error(response.data.msg || '开始服务失败')\n          }\n        } catch (error) {\n          console.error('开始服务失败:', error)\n          uni.showToast({\n            title: error.message || '操作失败',\n            icon: 'none'\n          })\n        } finally {\n          uni.hideLoading()\n        }\n      }\n    }\n  })\n}\n\n// 结束服务\nconst handleEndService = (order) => {\n  uni.showModal({\n    title: '结束服务',\n    content: '确定要结束服务吗？',\n    confirmText: '结束',\n    cancelText: '取消',\n    success: async (res) => {\n      if (res.confirm) {\n        try {\n          uni.showLoading({\n            title: '更新中...'\n          })\n          \n          const response = await endCompanionService({ \n            order_id: order.id,\n            companion_id: Number(companionId.value)\n          })\n          \n          if (response.data.code === 0) {\n            uni.showToast({\n              title: '服务已结束',\n              icon: 'success'\n            })\n            \n            // 刷新订单详情\n            setTimeout(() => {\n              loadOrderDetail()\n            }, 1500)\n          } else {\n            throw new Error(response.data.msg || '结束服务失败')\n          }\n        } catch (error) {\n          console.error('结束服务失败:', error)\n          uni.showToast({\n            title: error.message || '操作失败',\n            icon: 'none'\n          })\n        } finally {\n          uni.hideLoading()\n        }\n      }\n    }\n  })\n}\n\n// 查看评价\nconst handleViewReview = (order) => {\n  uni.navigateTo({\n    url: `/subPackages/fpart/order/partner-evaluate?orderId=${order.id}&companion_id=${companionId.value}`\n  })\n}\n\n// 再次服务\nconst handleRebookService = (order) => {\n  uni.navigateTo({\n    url: `/subPackages/fpart/rebook?orderId=${order.id}`\n  })\n}\n\n// 删除订单\nconst handleDeleteOrder = (order) => {\n  uni.showModal({\n    title: '删除订单',\n    content: '确定要删除这个订单吗？删除后不可恢复。',\n    confirmText: '删除',\n    cancelText: '取消',\n    success: async (res) => {\n      if (res.confirm) {\n        try {\n          uni.showLoading({\n            title: '删除中...'\n          })\n          \n          const response = await deleteCompanionOrder({ \n            order_id: order.id,\n            companion_id: Number(companionId.value)\n          })\n          \n          if (response.data.code === 0) {\n            uni.showToast({\n              title: '订单已删除',\n              icon: 'success'\n            })\n            \n            // 返回上一页\n            setTimeout(() => {\n              uni.navigateBack()\n            }, 1500)\n          } else {\n            throw new Error(response.data.msg || '删除订单失败')\n          }\n        } catch (error) {\n          console.error('删除订单失败:', error)\n          uni.showToast({\n            title: error.message || '删除失败',\n            icon: 'none'\n          })\n        } finally {\n          uni.hideLoading()\n        }\n      }\n    }\n  })\n}\n\n// 格式化时间\nconst formatTime = (timeStr) => {\n  if (!timeStr) return ''\n  \n  const date = new Date(timeStr)\n  const year = date.getFullYear()\n  const month = String(date.getMonth() + 1).padStart(2, '0')\n  const day = String(date.getDate()).padStart(2, '0')\n  const hours = String(date.getHours()).padStart(2, '0')\n  const minutes = String(date.getMinutes()).padStart(2, '0')\n  \n  return `${year}-${month}-${day} ${hours}:${minutes}`\n}\n\n// 复制订单号\nconst copyOrderNo = (orderNo) => {\n  if (!orderNo) {\n    uni.showToast({\n      title: '订单号为空',\n      icon: 'none'\n    })\n    return\n  }\n  \n  uni.setClipboardData({\n    data: orderNo,\n    success: () => {\n      uni.showToast({\n        title: '订单号已复制',\n        icon: 'success'\n      })\n    },\n    fail: () => {\n      uni.showToast({\n        title: '复制失败',\n        icon: 'none'\n      })\n    }\n  })\n}\n\n// 打开导航\nconst openLocation = (order) => {\n  if (order.user_latitude && order.user_longitude) {\n    uni.openLocation({ \n      latitude: Number(order.user_latitude), //要去的纬度\n      longitude: Number(order.user_longitude), //要去的经度 \n      address: order.service_address, //要去的具体地址 \n    })\n  } else {\n    uni.showToast({\n      title: '暂无位置信息',\n      icon: 'none'\n    })\n  }\n}\n\n// 格式化服务日期和时间\nconst formatServiceDateTime = (serviceDate, serviceTime) => {\n  if (!serviceDate && !serviceTime) return '待确认'\n  \n  let result = ''\n  \n  // 处理服务日期\n  if (serviceDate) {\n    const date = new Date(serviceDate)\n    const year = date.getFullYear()\n    const month = String(date.getMonth() + 1).padStart(2, '0')\n    const day = String(date.getDate()).padStart(2, '0')\n    const weekday = ['周日', '周一', '周二', '周三', '周四', '周五', '周六'][date.getDay()]\n    result += `${year}-${month}-${day} ${weekday}`\n  }\n  \n  // 处理时间段\n  if (serviceTime) {\n    if (result) {\n      result += ' '\n    }\n    result += serviceTime\n  }\n  \n  return result || '待确认'\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.order-detail-container {\n  min-height: 100vh;\n  background-color: #F7F8FA;\n  padding-bottom: calc(120rpx + env(safe-area-inset-bottom));\n}\n\n.scroll-content {\n  height: calc(100vh - 120rpx);\n  padding-bottom: 20rpx;\n}\n\n.section-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 30rpx;\n}\n\n.section-title {\n  font-size: 28rpx;\n  font-weight: 500;\n  color: #1A1A1A;\n}\n\n/* 服务信息 */\n.service-section {\n  background: #FFFFFF;\n  margin: 20rpx;\n  border-radius: 20rpx;\n  padding: 30rpx;\n}\n\n.service-card {\n  margin-top: 24rpx;\n}\n\n.service-info {\n  display: flex;\n  gap: 20rpx;\n}\n\n.service-image {\n  width: 120rpx;\n  height: 120rpx;\n  border-radius: 12rpx;\n  flex-shrink: 0;\n}\n\n.service-details {\n  flex: 1;\n}\n\n.service-name {\n  font-size: 28rpx;\n  color: #1A1A1A;\n  font-weight: 500;\n  display: block;\n  margin-bottom: 12rpx;\n}\n\n.service-meta {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 12rpx;\n}\n\n.service-price {\n  font-size: 26rpx;\n  color: #666666;\n}\n\n.service-quantity {\n  font-size: 26rpx;\n  color: #666666;\n}\n\n.service-amount {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n}\n\n.amount-label {\n  font-size: 26rpx;\n  color: #666666;\n}\n\n.amount-value {\n  font-size: 28rpx;\n  color: #f43f5e;\n  font-weight: 600;\n}\n\n/* 服务详情信息 */\n.service-details-info {\n  margin-top: 24rpx;\n  padding-top: 24rpx;\n  border-top: 1rpx solid #f0f0f0;\n}\n\n/* 订单信息 */\n.order-info-section {\n  background: #FFFFFF;\n  margin: 20rpx;\n  border-radius: 16rpx;\n  padding: 20rpx;\n}\n\n.detail-card {\n  margin-top: 24rpx;\n}\n\n.detail-item {\n  display: flex;\n  margin-bottom: 16rpx;\n}\n\n.detail-item:last-child {\n  margin-bottom: 0;\n}\n\n.detail-label {\n  font-size: 24rpx;\n  color: #666666;\n  min-width: 140rpx;\n}\n\n.detail-value-container {\n  display: flex;\n  align-items: center;\n  flex: 1;\n  gap: 16rpx;\n}\n\n.detail-value-container .detail-value {\n  flex: 1;\n  min-width: 0;\n}\n\n.detail-value {\n  font-size: 24rpx;\n  color: #1A1A1A;\n  flex: 1;\n}\n\n.detail-value-order {\n  font-size: 24rpx;\n  color: #1A1A1A;\n}\n\n.location-actions {\n  display: flex;\n  align-items: center;\n  margin-left: 16rpx;\n  flex-shrink: 0;\n}\n\n.nav-btn {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 8rpx 16rpx;\n  background: linear-gradient(135deg, #7363FF 0%, #FF69DE 100%);\n  border-radius: 20rpx;\n  transition: all 0.3s ease;\n  \n  &:active {\n    transform: scale(0.95);\n  }\n}\n\n.nav-text {\n  font-size: 22rpx;\n  color: #FFFFFF;\n  font-weight: 500;\n}\n\n.copy-icon {\n  width: 28rpx;\n  height: 28rpx;\n  flex-shrink: 0;\n  opacity: 0.6;\n  transition: opacity 0.2s ease;\n}\n\n.copy-icon:active {\n  opacity: 1;\n  transform: scale(0.9);\n}\n\n/* 客户信息样式 */\n.customer-info {\n  display: flex;\n  align-items: center;\n  flex: 1;\n  gap: 12rpx;\n}\n\n/* 操作按钮 */\n.action-buttons {\n  position: fixed;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  background: linear-gradient(180deg, rgba(255, 255, 255, 0.95) 0%, white 100%);\n  backdrop-filter: blur(20rpx);\n  -webkit-backdrop-filter: blur(20rpx);\n  padding: 24rpx;\n  padding-bottom: calc(24rpx + env(safe-area-inset-bottom));\n  border-top: 1rpx solid rgba(115, 99, 255, 0.1);\n  z-index: 100;\n}\n\n.action-container {\n  display: flex;\n  gap: 16rpx;\n  justify-content: flex-end;\n}\n\n.action-btn {\n  padding: 16rpx 32rpx;\n  border-radius: 99999rpx;\n  font-size: 26rpx;\n  font-weight: 500;\n  transition: all 0.3s ease;\n  border: 1rpx solid transparent;\n  box-sizing: border-box;\n  height: 72rpx;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  min-width: 120rpx;\n  position: relative;\n}\n\n.action-btn.primary {\n  background: #7363FF;\n  color: #FFFFFF;\n  border-color: #7363FF;\n}\n\n.action-btn.primary:active {\n  background: #6354e6;\n  transform: scale(0.96);\n}\n\n.action-btn.secondary {\n  background: #FFFFFF;\n  color: #666666;\n  border-color: #e9ecef;\n}\n\n.action-btn.secondary:active {\n  background: #f8f9fa;\n  transform: scale(0.96);\n}\n\n.action-btn.depart {\n  background: #4CAF50;\n  color: #FFFFFF;\n  border-color: #4CAF50;\n}\n\n.action-btn.depart:active {\n  background: #45a049;\n  transform: scale(0.96);\n}\n\n.action-btn.info {\n  background: transparent;\n  color: #999999;\n  border-color: transparent;\n  cursor: default;\n  padding: 16rpx 0;\n}\n\n.action-btn.info:active {\n  background: transparent;\n  transform: none;\n}\n</style>","import MiniProgramPage from '/Users/xiaoqiang/Documents/friemd/firend-loving-app/subPackages/fpart/order/detail.vue'\nwx.createPage(MiniProgramPage)"],"names":["userStore","useUserStore","orderDetail","ref","orderId","companionId","onLoad","options","uni","loadOrderDetail","response","getCompanionOrderDetail","error","getOrderActions","status","order","handleOrderAction","action","handleContactCustomer","handleAcceptOrder","handleRejectOrder","handleArrived","handleDepart","handleCallCustomer","handleStartService","handleEndService","handleViewReview","handleRebookService","handleDeleteOrder","res","acceptCompanionOrder","rejectCompanionOrder","arrivedCompanionOrder","departCompanionOrder","startCompanionService","endCompanionService","deleteCompanionOrder","formatTime","timeStr","date","year","month","day","hours","minutes","copyOrderNo","orderNo","openLocation","formatServiceDateTime","serviceDate","serviceTime","result","weekday","MiniProgramPage"],"mappings":"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"}