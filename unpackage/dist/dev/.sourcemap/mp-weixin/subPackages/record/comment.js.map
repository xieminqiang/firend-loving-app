{"version":3,"file":"comment.js","sources":["subPackages/record/comment.vue","subPackages/record/comment.vue?type=page"],"sourcesContent":["<template>\n\t<view class=\"comment\">\n\t\t<view class=\"comment_top\">\n\t\t\t<!-- 头部信息 -->\n\t\t\t<view class=\"top\">\n\t\t\t\t<view class=\"top-left\">\n\t\t\t\t\t<!-- 头像 -->\n\t\t\t\t\t<view class=\"avatar\" @click=\"toDetail()\">\n\t\t\t\t\t\t<u-avatar :src=\"$imgBaseUrl + userInfoComment.head_img\" size=\"38\" shape=\"circle\" mode=\"aspectFill\"></u-avatar>\n\t\t\t\t\t</view>\n\t\t\t\t\t<!-- 介绍 -->\n\t\t\t\t\t<view class=\"info\">\n\t\t\t\t\t\t<view class=\"info-one\">\n\t\t\t\t\t\t\t<view class=\"name\">{{ userInfoComment.nick_name }}</view>\n\t\t\t\t\t\t\t<template v-if=\"userInfoComment.icon_list\">\n\t\t\t\t\t\t\t\t<view class=\"flex\">\n\t\t\t\t\t\t\t\t\t<block v-for=\"item in userInfoComment.icon_list\" :key=\"item\">\n\t\t\t\t\t\t\t\t\t\t<view class=\"introduce\" :style=\"{background:`${item.icon?.color}`}\">\n\t\t\t\t\t\t\t\t\t\t\t<image v-if=\"item.icon.icon\" class=\"image\" :src=\"item.icon?.icon\"\n\t\t\t\t\t\t\t\t\t\t\t\tmode=\"widthFix\">\n\t\t\t\t\t\t\t\t\t\t\t</image>\n\t\t\t\t\t\t\t\t\t\t\t<text class=\"introduce-title\">{{ item.data }}</text>\n\t\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t\t</block>\n\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t\t<!-- 立即邀约按钮 -->\n\t\t\t\t<!-- <view class=\"invite-btn\" @tap=\"handleInvite()\">\n\t\t\t\t\t立即邀约\n\t\t\t\t</view> -->\n\t\t\t</view>\n\t\t</view>\n\n\t\t<view class=\"flex-box\">\n\t\t\t<scroll-view :scroll-top=\"scrollTop\" scroll-y=\"true\" class=\"scroll-Y\" scroll-anchoring\n\t\t\t\t:lower-threshold=\"300\" :scroll-with-animation=\"true\" :show-scrollbar=\"true\" :enable-back-to-top=\"true\"\n\t\t\t\t@scroll=\"handleScroll\" @scrolltolower=\"lowerComment\">\n\t\t\t\t<!-- 动态内容 -->\n\t\t\t\t<view class=\"moment-content\">\n\t\t\t\t\t<view class=\"moment-text\">{{ momentsInfoComment.content }}</view>\n\t\t\t\t\t\n\t\t\t\t\t<!-- 图片/视频展示 -->\n\t\t\t\t\t<view v-if=\"momentsInfoComment.file_list && momentsInfoComment.file_list.length > 0\" class=\"moment-media\">\n\t\t\t\t\t\t<PictureDisplay :list=\"momentsInfoComment.file_list\" :topicList=\"momentsInfoComment.topic_list\"></PictureDisplay>\n\t\t\t\t\t</view>\n\t\t\t\t\t\n\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t<view class=\"moment-actions\">\n\t\t\t\t\t\t<view class=\"action-item\" @tap=\"handlePraise({target_id: momentsInfoComment.moments_id})\">\n\t\t\t\t\t\t\t<image v-if=\"!momentsInfoComment.is_praised\" src=\"@/static/square/love.png\" class=\"action-icon\"></image>\n\t\t\t\t\t\t\t<image v-if=\"momentsInfoComment.is_praised\" src=\"@/static/square/active-love.png\" class=\"action-icon\"></image>\n\t\t\t\t\t\t\t<text class=\"action-text\">{{ momentsInfoComment.praise_num || 0 }}</text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t<!-- \t<view class=\"action-item\" @tap=\"handleSayHello(userInfoComment.user_id)\">\n\t\t\t\t\t\t\t<image src=\"@/static/square/em@3x.png\" class=\"action-icon\"></image>\n\t\t\t\t\t\t\t<text class=\"action-text\">打招呼</text>\n\t\t\t\t\t\t</view> -->\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t<!-- 评论区 -->\n\t\t\t\t<view v-if=\"commentDataLoaded\" class=\"comment-section\">\n\t\t\t\t\t<view class=\"title\">\n\t\t\t\t\t\t<text>全部评论({{ totalComment }}条)</text>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view v-if=\"totalComment == 0\" class=\"no-record\">\n\t\t\t\t\t\t<image class=\"no-record-image\" src=\"~@/static/square/no-record.png\" mode=\"\"></image>\n\t\t\t\t\t\t<view class=\"no-record-title\">还没有评论丫，抢先发表一下吧！</view>\n\t\t\t\t\t</view>\n\n\t\t\t\t\t<view v-else class=\"comment-list\">\n\t\t\t\t\t\t<view class=\"comment-item\" v-for=\"item in commentListData\" :key=\"item.comments_id\">\n\t\t\t\t\t\t\t<!-- 一级评论 -->\n\t\t\t\t\t\t\t<view class=\"main\" @tap=\"reply(item)\">\n\t\t\t\t\t\t\t\t<view class=\"left\" @tap.stop=\"toDetailItem(item)\">\n\t\t\t\t\t\t\t\t\t<u-avatar :src=\"$imgBaseUrl + (momentsInfoComment.user_id === item.user_id ? userInfoComment.head_img : item.head_img)\" size=\"32\" shape=\"circle\" mode=\"aspectFill\"></u-avatar>\n\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t<view class=\"right\">\n\t\t\t\t\t\t\t\t\t<view class=\"username\">\n\t\t\t\t\t\t\t\t\t\t<text>{{momentsInfoComment.user_id === item.user_id ? userInfoComment.nick_name : item.nick_name}}</text>\n\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t\t<view class=\"comment-content\">\n\t\t\t\t\t\t\t\t\t\t<text>{{item.content}}</text>\n\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t\t<view class=\"option\">\n\t\t\t\t\t\t\t\t\t\t<view class=\"left\">\n\t\t\t\t\t\t\t\t\t\t\t<text class=\"time\">{{item.content_time}}</text>\n\t\t\t\t\t\t\t\t\t\t\t<text class=\"reply-btn\" @tap=\"reply(item)\">回复</text>\n\t\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t</view>\n\n\t\t\t\t\t\t\t<!-- 二级评论 -->\n\t\t\t\t\t\t\t<view class=\"reply-list\" v-for=\"it in item.comments_list\" :key=\"it.comments_id\">\n\t\t\t\t\t\t\t\t<view class=\"reply-item\" @tap=\"reply(it)\">\n\t\t\t\t\t\t\t\t\t<view class=\"left\" @tap.stop=\"toDetailItem(it)\">\n\t\t\t\t\t\t\t\t\t\t<u-avatar :src=\"$imgBaseUrl + (momentsInfoComment.user_id === it.user_id ? userInfoComment.head_img : it.head_img)\" size=\"22\" shape=\"circle\"></u-avatar>\n\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t\t<view class=\"right\">\n\t\t\t\t\t\t\t\t\t\t<view class=\"username\">\n\t\t\t\t\t\t\t\t\t\t\t<text class=\"reply-username\">{{momentsInfoComment.user_id === it.user_id ? userInfoComment.nick_name : it.nick_name}}</text>\n\t\t\t\t\t\t\t\t\t\t\t<image src=\"@/static/square/reply@3x.png\" mode=\"aspectFill\"></image>\n\t\t\t\t\t\t\t\t\t\t\t<text class=\"main-username\">{{momentsInfoComment.user_id === it.reply_user_id ? userInfoComment.nick_name : it.reply_nick_name}}</text>\n\t\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t\t\t<view class=\"comment-content\">\n\t\t\t\t\t\t\t\t\t\t\t<text>{{it.content}}</text>\n\t\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t\t\t<view class=\"option\">\n\t\t\t\t\t\t\t\t\t\t\t<view class=\"left\">\n\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"time\">{{it.content_time}}</text>\n\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"reply-btn\" @tap=\"reply(it)\">回复</text>\n\t\t\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t</view>\n\n\t\t\t\t\t\t\t<view v-if=\"item.has_more\" class=\"expand\" @tap=\"handleHasMore(item)\">\n\t\t\t\t\t\t\t\t<view class=\"line\"></view>\n\t\t\t\t\t\t\t\t<text>展开更多回复</text>\n\t\t\t\t\t\t\t\t<u-icon name=\"arrow-down\" color=\"#7363FF\" size=\"14\"></u-icon>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t</scroll-view>\n\t\t\t<view @touchmove.prevent class=\"chatting\" @tap=\"handleShowOneReply\">\n\t\t\t\t<u-input :placeholder=\"replyCommentsName\" border=\"surround\" :value=\"rplContent\" @focus=\"handleFocus\"\n\t\t\t\t\t@blur=\"handleBlur\" fontSize='24rpx' color='#1a1a1a' shape='circle' :adjustPosition=\"true\" disabled\n\t\t\t\t\t:customStyle=\"{\n\t\t\t\t\t\t\tpaddingLeft:'24rpx',\n\t\t\t\t\t\t\tbackground:'#F2F2F2'\n\t\t\t\t\t\t}\">\n\t\t\t\t</u-input>\n\t\t\t</view>\n\t\t</view>\n\t</view>\n\n\t<!-- 评论回复弹框 -->\n\t<u-popup \n\t\t:show=\"showOneReply\" \n\t\tround=\"10\" \n\t\t@close=\"handleClosePopup\"\n\t\t:closeOnClickOverlay=\"true\"\n\t\t:closeOnClickModal=\"true\"\n\t\t:zIndex=\"999\"\n\t\t:overlay=\"true\"\n\t\t:overlayStyle=\"{ backgroundColor: 'rgba(0, 0, 0, 0.5)' }\"\n\t\t:duration=\"300\"\n\t\t:mode=\"'bottom'\"\n\t\t:safeAreaInsetBottom=\"true\"\n\t\t:customStyle=\"{\n\t\t\ttransition: 'all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n\t\t\ttransform: showOneReply ? 'translateY(0)' : 'translateY(100%)'\n\t\t}\"\n\t>\n\t\t<view @touchmove.prevent class=\"popup-container\">\n\t\t\t<!-- 拖拽指示条 -->\n\t\t\t<view class=\"drag-indicator\" @touchstart=\"handleDragStart\" @touchmove=\"handleDragMove\" @touchend=\"handleDragEnd\"></view>\n\t\t\t\n\t\t\t<!-- 输入区域 -->\n\t\t\t<view class=\"popup-input-area\">\n\t\t\t\t<view class=\"input-wrapper\">\n\t\t\t\t\t<u-input \n\t\t\t\t\t\t:focus=\"showOneReply && inputFocus\" \n\t\t\t\t\t\t:placeholder=\"replyCommentsName\" \n\t\t\t\t\t\tborder=\"surround\" \n\t\t\t\t\t\tv-model=\"rplContent\"\n\t\t\t\t\t\t@focus=\"handleInputFocus\" \n\t\t\t\t\t\t@blur=\"handleInputBlur\" \n\t\t\t\t\t\t@input=\"handleInputChange\"\n\t\t\t\t\t\tfontSize='24rpx' \n\t\t\t\t\t\tcolor='#1a1a1a' \n\t\t\t\t\t\tshape='circle'\n\t\t\t\t\t\t:adjustPosition=\"true\" \n\t\t\t\t\t\t:customStyle=\"{\n\t\t\t\t\t\t\tpaddingLeft:'24rpx',\n\t\t\t\t\t\t\tbackground:'#F2F2F2',\n\t\t\t\t\t\t\ttransition: 'all 0.2s ease'\n\t\t\t\t\t\t}\"\n\t\t\t\t\t>\n\t\t\t\t\t</u-input>\n\t\t\t\t\t\n\t\t\t\t\t<!-- 发送按钮 -->\n\t\t\t\t\t<view \n\t\t\t\t\t\tclass=\"send-btn\" \n\t\t\t\t\t\t:class=\"{ 'send-btn-active': rplContent.trim() }\"\n\t\t\t\t\t\t@tap=\"handleReleaseComment\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<text class=\"send-text\">发送</text>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\t</u-popup>\n</template>\n\n<script setup>\n\timport {\n\t\tref,\n\t\tgetCurrentInstance,\n\t} from 'vue'\n\timport {\n\t\tonLoad,\n\t} from '@dcloudio/uni-app'\n\timport { getMomentsDetail, pushMomentComment, getMomentCommentList, getMoreMomentCommentList, praiseMoment } from '@/api/discover.js'\n\timport PictureDisplay from '@/components/common/PictureDisplay.vue'\n\n\tconst $instance = ref(getCurrentInstance().proxy)\n\n\t// 定义props\n\tconst props = defineProps({\n\t\tuserLocation: {\n\t\t\ttype: Object,\n\t\t\tdefault: null\n\t\t},\n\t\tcityStore: {\n\t\t\ttype: Object,\n\t\t\tdefault: null\n\t\t}\n\t})\n\n\tconst scrollTop = ref(0)\n\tconst oldScrollTop = ref(0)\n\n\t// 动态id\n\tconst momentsId = ref('')\n\n\t// 分页页数\n\tconst pageComment = ref(1)\n\n\t// 全部评论条数\n\tconst totalComment = ref(0)\n\n\t// 评论数据是否已加载\n\tconst commentDataLoaded = ref(false)\n\n\t// 用户信息\n\tconst userInfoComment = ref({})\n\n\t// 评论数据\n\tconst commentListData = ref([])\n\n\t// 评论数据\n\tconst momentsInfoComment = ref([])\n\n\t// 评论内容\n\tconst rplContent = ref('')\n\n\t// 被评论用户的id\n\tconst replyCommentsId = ref('')\n\n\t// 回复对象名称\n\tconst replyCommentsName = ref('友好发言，文明聊天')\n\n\t// 一级评论框\n\tconst showOneReply = ref(false)\n\t\n\t// 输入框聚焦状态\n\tconst inputFocus = ref(false)\n\t\n\t// 拖拽相关状态\n\tconst dragStartY = ref(0)\n\tconst dragCurrentY = ref(0)\n\tconst isDragging = ref(false)\n\n\tonLoad((options) => {\n\t\tconst eventChannel = $instance.value.getOpenerEventChannel();\n\t\teventChannel.on('getRecord', async (data) => {\n\t\t\tmomentsId.value = data.data.moments_info.moments_id\n\t\t\tgetData(1)\n\t\t})\n\t\treplyCommentsId.value = ''\n\t\treplyCommentsName.value = '友好发言，文明聊天'\n\t})\n\n\t// 获取数据 - 调用真实接口\n\tconst getData = async (val) => {\n\t\ttry {\n\t\t\tconst response = await getMomentsDetail({\n\t\t\t\tmoments_id: momentsId.value\n\t\t\t})\n\t\t\t\n\t\t\tif (response.data && response.data.code === 0) {\n\t\t\t\tconst data = response.data.data\n\t\t\t\t\n\t\t\t\t// 更新用户信息\n\t\t\t\tif (data.companion_info) {\n\t\t\t\t\tuserInfoComment.value = {\n\t\t\t\t\t\tuser_id: data.companion_info.id,\n\t\t\t\t\t\tnick_name: data.companion_info.nickname,\n\t\t\t\t\t\thead_img: data.companion_info.avatar,\n\t\t\t\t\t\ticon_list: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ticon: { \n\t\t\t\t\t\t\t\t\tcolor: data.companion_info.gender === '女' ? 'rgba(252, 139, 198, 1)' : 'rgba(19, 98, 235, 1)', \n\t\t\t\t\t\t\t\t\ticon: data.companion_info.gender === '女' ? '/static/find/nd_icon.png' : '/static/find/nand_icon.png' \n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tdata: `${data.companion_info.age}岁`\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ticon: { color: 'rgba(62, 178, 240, 1)' },\n\t\t\t\t\t\t\t\tdata: `${data.companion_info.height}cm`\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ticon: { color: 'linear-gradient(180deg, rgba(155, 59, 235, 1) 0%, rgba(230, 126, 188, 1) 100%)' },\n\t\t\t\t\t\t\t\tdata: `${data.companion_info.weight}kg`\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// 更新动态信息\n\t\t\t\tif (data.moments_info) {\n\t\t\t\t\tmomentsInfoComment.value = data.moments_info\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// 获取评论列表\n\t\t\t\tgetCommentData(1)\n\t\t\t\t\n\t\t\t} else {\n\t\t\t\tconsole.error('获取动态详情失败:', response.data?.message)\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: '获取动态详情失败',\n\t\t\t\t\ticon: 'none'\n\t\t\t\t})\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tconsole.error('获取动态详情出错:', error)\n\t\t\tuni.showToast({\n\t\t\t\ttitle: '网络错误，请重试',\n\t\t\t\ticon: 'none'\n\t\t\t})\n\t\t}\n\t}\n\n\t// 获取评论数据\n\tconst getCommentData = async (page) => {\n\t\ttry {\n\t\t\tconst response = await getMomentCommentList({\n\t\t\t\tmoments_id: momentsId.value,\n\t\t\t\tpage: page,\n\t\t\t\tpage_size: 10\n\t\t\t})\n\t\t\t\n\t\t\tif (response.data && response.data.code === 0) {\n\t\t\t\tconst data = response.data.data\n\t\t\t\t\n\t\t\t\tif (page === 1) {\n\t\t\t\t\tcommentListData.value = data.comments_list || []\n\t\t\t\t\ttotalComment.value = data.total || 0\n\t\t\t\t\tcommentDataLoaded.value = true\n\t\t\t\t} else {\n\t\t\t\t\tif (data.comments_list && data.comments_list.length > 0) {\n\t\t\t\t\t\tcommentListData.value.push(...data.comments_list)\n\t\t\t\t\t\tpageComment.value = data.page\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconsole.error('获取评论列表失败:', response.data?.message)\n\t\t\t\t// 如果接口失败，使用模拟数据作为备用\n\t\t\t\tuseMockCommentData()\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tconsole.error('获取评论列表出错:', error)\n\t\t\t// 如果接口失败，使用模拟数据作为备用\n\t\t\tuseMockCommentData()\n\t\t}\n\t}\n\n\t\n\tconst useMockCommentData = () => {\n\t\tcommentListData.value = []\n\t\ttotalComment.value = 0\n\t\tcommentDataLoaded.value = true\n\t}\n\n\t// 监听页面滚动到底部\n\tconst lowerComment = () => {\n\t\tconsole.log('监听页面滚动到底部');\n\t\tgetCommentData(pageComment.value + 1)\n\t}\n\n\t// 获取被评论用户的ID \n\tconst reply = (val) => {\n\t\treplyCommentsId.value = val.comments_id\n\t\treplyCommentsName.value = '回复@' + val.nick_name\n\t\tshowOneReply.value = true\n\t}\n\n\t// 发布\n\tconst handleReleaseComment = async () => {\n\n\t\t\n\t\t\n\t\t\n\t\t// 更严格的验证逻辑\n\t\tconst trimmedContent = rplContent.value || ''\n\t\tif (!trimmedContent) {\n\t\t\tconsole.log('输入内容为空，显示错误提示')\n\t\t\tuni.showToast({\n\t\t\t\ttitle: '请输入评论内容',\n\t\t\t\ticon: 'none',\n\t\t\t\tduration: 1000\n\t\t\t});\n\t\t\treturn\n\t\t}\n\t\t\n\t\ttry {\n\t\t\tconst params = {\n\t\t\t\tmoments_id: momentsId.value,\n\t\t\t\tcontent: rplContent.value\n\t\t\t}\n\t\t\t\n\t\t\t// 如果是回复评论，添加回复评论ID\n\t\t\tif (replyCommentsId.value) {\n\t\t\t\tparams.reply_comments_id = replyCommentsId.value\n\t\t\t}\n\t\t\t\n\t\t\tconst response = await pushMomentComment(params)\n\t\t\t\n\t\t\tif (response.data && response.data.code === 0) {\n\t\t\t\tconst newComment = response.data.data.res_data\n\t\t\t\t\n\t\t\t\tif (replyCommentsId.value) {\n\t\t\t\t\t// 回复评论\n\t\t\t\t\tcommentListData.value.forEach((item) => {\n\t\t\t\t\t\tif (item.comments_id == newComment.parent_id) {\n\t\t\t\t\t\t\titem.comments_list.push(newComment)\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\treplyCommentsId.value = ''\n\t\t\t\t\treplyCommentsName.value = '友好发言，文明聊天'\n\t\t\t\t} else {\n\t\t\t\t\t// 直接评论\n\t\t\t\t\tcommentListData.value.unshift(newComment)\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// 更新总评论数\n\t\t\t\ttotalComment.value = newComment.total\n\t\t\t\tmomentsInfoComment.value.comments_num = newComment.total\n\t\t\t\t\n\t\t\t\t// 清空输入框\n\t\t\t\trplContent.value = ''\n\t\t\t\thandleClosePopup()\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: '评论成功!',\n\t\t\t\t\ticon: 'none',\n\t\t\t\t\tduration: 500\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: response.data?.message || '评论失败!',\n\t\t\t\t\ticon: 'none',\n\t\t\t\t\tduration: 1000\n\t\t\t\t});\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tconsole.error('发布评论出错:', error)\n\t\t\tuni.showToast({\n\t\t\t\ttitle: '网络错误，请重试',\n\t\t\t\ticon: 'none',\n\t\t\t\tduration: 1000\n\t\t\t});\n\t\t}\n\t}\n\n\t// 是否展开更多\n\tconst handleHasMore = async (val) => {\n\t\tconsole.log('展开更多回复', val)\n\t\ttry {\n\t\t\tconst response = await getMoreMomentCommentList({\n\t\t\t\tcomments_id: val.comments_id,\n\t\t\t\tpage: 1,\n\t\t\t\tpage_size: 10\n\t\t\t})\n\t\t\t\n\t\t\tif (response.data && response.data.code === 0) {\n\t\t\t\tconst data = response.data.data\n\t\t\t\tval.comments_list = data.more_list || []\n\t\t\t\tval.has_more = data.has_more || false\n\t\t\t} else {\n\t\t\t\tconsole.error('获取更多回复失败:', response.data?.message)\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tconsole.error('获取更多回复出错:', error)\n\t\t}\n\t}\n\n\tconst handleScroll = (e) => {\n\t\toldScrollTop.value = e.detail.scrollTop\n\t}\n\n\t// 关闭键盘\n\tconst handleBlur = () => {\n\t}\n\n\t// 聚焦键盘\n\tconst handleFocus = (e) => {\n\t}\n\t\n\t// 输入框聚焦\n\tconst handleInputFocus = (e) => {\n\t\tinputFocus.value = true\n\t}\n\t\n\t// 输入框失焦\n\tconst handleInputBlur = (e) => {\n\t\tinputFocus.value = false\n\t}\n\t\n\t// 输入框内容变化\n\tconst handleInputChange = (value) => {\n\t\tconsole.log('handleInputChange 被调用，接收到的值:', value)\n\t\trplContent.value = value\n\t\tconsole.log('rplContent 更新为:', rplContent.value)\n\t}\n\t\n\t// 拖拽开始\n\tconst handleDragStart = (e) => {\n\t\tisDragging.value = true\n\t\tdragStartY.value = e.touches[0].clientY\n\t\tdragCurrentY.value = e.touches[0].clientY\n\t}\n\t\n\t// 拖拽移动\n\tconst handleDragMove = (e) => {\n\t\tif (!isDragging.value) return\n\t\t\n\t\tdragCurrentY.value = e.touches[0].clientY\n\t\tconst deltaY = dragCurrentY.value - dragStartY.value\n\t\t\n\t\t// 只允许向下拖拽关闭\n\t\tif (deltaY > 0) {\n\t\t\te.preventDefault()\n\t\t}\n\t}\n\t\n\t// 拖拽结束\n\tconst handleDragEnd = (e) => {\n\t\tif (!isDragging.value) return\n\t\t\n\t\tconst deltaY = dragCurrentY.value - dragStartY.value\n\t\t\n\t\t// 如果向下拖拽超过50px，则关闭弹框\n\t\tif (deltaY > 50) {\n\t\t\thandleClosePopup()\n\t\t}\n\t\t\n\t\tisDragging.value = false\n\t\tdragStartY.value = 0\n\t\tdragCurrentY.value = 0\n\t}\n\n\t// 去详情\n\tconst toDetail = () => {\n\t\tuni.navigateTo({\n\t\t\turl: '/pages/detail/detail',\n\t\t\tanimationType: 'slide-in-bottom',\n\t\t\tanimationDuration: 200,\n\t\t\tsuccess(res) {\n\t\t\t\tres.eventChannel.emit('getUserId', {\n\t\t\t\t\tval: userInfoComment.value.user_id,\n\t\t\t\t})\n\t\t\t}\n\t\t})\n\t}\n\n\tconst toDetailItem = (item) => {\n\t\tuni.navigateTo({\n\t\t\turl: '/pages/detail/detail',\n\t\t\tanimationType: 'slide-in-bottom',\n\t\t\tanimationDuration: 200,\n\t\t\tsuccess(res) {\n\t\t\t\tres.eventChannel.emit('getUserId', {\n\t\t\t\t\tval: item.user_id,\n\t\t\t\t})\n\t\t\t}\n\t\t})\n\t}\n\n\tconst toBack = () => {\n\t\tuni.navigateBack({\n\t\t\tdelta: 1\n\t\t})\n\t}\n\n\t// 喜欢用户 - 模拟功能\n\tconst likePerson = () => {\n\t\tmomentsInfoComment.value.is_liked = true\n\t\tuni.showToast({\n\t\t\ttitle: '喜欢成功!',\n\t\t\ticon: 'none',\n\t\t\tduration: 1000\n\t\t});\n\t}\n\n\t// 回复一级评论\n\tconst handleShowOneReply = () => {\n\t\tshowOneReply.value = true\n\t\t// 延迟聚焦，确保弹框完全显示后再聚焦\n\t\tsetTimeout(() => {\n\t\t\tinputFocus.value = true\n\t\t}, 350)\n\t}\n\t\n\t// 关闭弹框\n\tconst handleClosePopup = () => {\n\t\tinputFocus.value = false\n\t\tshowOneReply.value = false\n\t\t// 清空输入内容\n\t\trplContent.value = ''\n\t\treplyCommentsId.value = ''\n\t\treplyCommentsName.value = '友好发言，文明聊天'\n\t}\n\n\tconst handleSayHello = (val) => {\n\t\tuni.showToast({\n\t\t\ttitle: '打招呼功能开发中',\n\t\t\ticon: 'none',\n\t\t\tduration: 1000\n\t\t});\n\t}\n\t\n\t// 安全的数字加减工具函数，处理字符串类型的数字\n\tconst safeNumberOperation = (value, operation = 'add', amount = 1) => {\n\t\t// 将字符串转换为数字，如果转换失败则默认为0\n\t\tconst numValue = parseInt(value) || 0\n\t\t\n\t\tif (operation === 'add') {\n\t\t\treturn numValue + amount\n\t\t} else if (operation === 'subtract') {\n\t\t\treturn Math.max(0, numValue - amount) // 确保不会小于0\n\t\t}\n\t\t\n\t\treturn numValue\n\t}\n\n\t// 点赞功能\n\tconst handlePraise = async (val) => {\n\t\ttry {\n\t\t\t// 先更新本地状态，提供即时反馈\n\t\t\tconst wasPraised = momentsInfoComment.value.is_praised\n\t\t\tmomentsInfoComment.value.is_praised = !wasPraised\n\t\t\t\n\t\t\tif (momentsInfoComment.value.is_praised) {\n\t\t\t\tmomentsInfoComment.value.praise_num = safeNumberOperation(momentsInfoComment.value.praise_num, 'add', 1)\n\t\t\t} else {\n\t\t\t\tmomentsInfoComment.value.praise_num = safeNumberOperation(momentsInfoComment.value.praise_num, 'subtract', 1)\n\t\t\t}\n\t\t\t\n\t\t\t// 调用API接口\n\t\t\tconst response = await praiseMoment({\n\t\t\t\ttarget_id: val.target_id\n\t\t\t})\n\t\t\t\n\t\t\tif (response.data && response.data.code === 0) {\n\t\t\t\t// API调用成功，本地状态已经更新\n\t\t\t\tconsole.log('点赞成功')\n\t\t\t} else {\n\t\t\t\t// API调用失败，回滚本地状态\n\t\t\t\tmomentsInfoComment.value.is_praised = wasPraised\n\t\t\t\tif (wasPraised) {\n\t\t\t\t\tmomentsInfoComment.value.praise_num = safeNumberOperation(momentsInfoComment.value.praise_num, 'add', 1)\n\t\t\t\t} else {\n\t\t\t\t\tmomentsInfoComment.value.praise_num = safeNumberOperation(momentsInfoComment.value.praise_num, 'subtract', 1)\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: '点赞失败，请重试',\n\t\t\t\t\ticon: 'none'\n\t\t\t\t})\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tconsole.error('点赞失败:', error)\n\t\t\t// 发生错误，回滚本地状态\n\t\t\tconst wasPraised = momentsInfoComment.value.is_praised\n\t\t\tmomentsInfoComment.value.is_praised = !wasPraised\n\t\t\tif (wasPraised) {\n\t\t\t\tmomentsInfoComment.value.praise_num = safeNumberOperation(momentsInfoComment.value.praise_num, 'add', 1)\n\t\t\t} else {\n\t\t\t\tmomentsInfoComment.value.praise_num = safeNumberOperation(momentsInfoComment.value.praise_num, 'subtract', 1)\n\t\t\t}\n\t\t\t\n\t\t\tuni.showToast({\n\t\t\t\ttitle: '网络错误，请重试',\n\t\t\t\ticon: 'none'\n\t\t\t})\n\t\t}\n\t}\n\n\t// 立即邀约\n\tconst handleInvite = async () => {\n\t\ttry {\n\t\t\t// 获取友伴师信息\n\t\t\tconst companionInfo = userInfoComment.value\n\t\t\tif (!companionInfo || !companionInfo.user_id) {\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: '用户信息不完整',\n\t\t\t\t\ticon: 'none'\n\t\t\t\t})\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\t// 模拟服务区域（实际应该从API获取）\n\t\t\tconst serviceAreas = ['110100', '310100', '440100'] // 北京、上海、广州\n\t\t\t\n\t\t\t// 如果只有一个服务区域，直接使用\n\t\t\tif (serviceAreas.length === 1) {\n\t\t\t\tconst cityCode = serviceAreas[0]\n\t\t\t\tawait navigateToDetail(companionInfo.user_id, cityCode)\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\t// 使用传入的定位信息\n\t\t\tif (props.userLocation) {\n\t\t\t\t// 有定位，计算最近的城市\n\t\t\t\tconst nearestCityCode = await findNearestCity(serviceAreas, props.userLocation.latitude, props.userLocation.longitude)\n\t\t\t\tawait navigateToDetail(companionInfo.user_id, nearestCityCode, props.userLocation.latitude, props.userLocation.longitude)\n\t\t\t} else {\n\t\t\t\t// 没有定位，使用第一个服务区域\n\t\t\t\tconst cityCode = serviceAreas[0]\n\t\t\t\tawait navigateToDetail(companionInfo.user_id, cityCode)\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tconsole.error('邀约失败:', error)\n\t\t\tuni.showToast({\n\t\t\t\ttitle: '邀约失败，请重试',\n\t\t\t\ticon: 'none'\n\t\t\t})\n\t\t}\n\t}\n\n\t// 根据服务区域找到最近的城市\n\tconst findNearestCity = async (serviceAreas, userLat, userLng) => {\n\t\t// 确保城市列表已加载\n\t\tif (props.cityStore && props.cityStore.cityList.length === 0) {\n\t\t\tawait props.cityStore.loadCityList()\n\t\t}\n\t\tconsole.log('城市列表:', props.cityStore?.cityList)\n\t\tconsole.log('城市列表serviceAreas:', serviceAreas)\n\t\t// 从城市列表中找到服务区域对应的城市\n\t\tconst serviceCities = props.cityStore?.cityList.filter(city => \n\t\t\tserviceAreas.includes(city.code.toString())\n\t\t) || []\n\t\t\n\t\tif (serviceCities.length === 0) {\n\t\t\tconsole.warn('未找到对应的服务城市，使用第一个服务区域')\n\t\t\treturn serviceAreas[0]\n\t\t}\n\t\t\n\t\t// 如果只有一个服务城市，直接返回\n\t\tif (serviceCities.length === 1) {\n\t\t\treturn serviceCities[0].code\n\t\t}\n\t\t\n\t\t// 计算距离，找到最近的城市\n\t\tlet nearestCity = serviceCities[0]\n\t\tlet minDistance = Infinity\n\t\t\n\t\tserviceCities.forEach(city => {\n\t\t\tif (city.latitude && city.longitude) {\n\t\t\t\tconst distance = props.cityStore?.calculateDistance(\n\t\t\t\t\tuserLat,\n\t\t\t\t\tuserLng,\n\t\t\t\t\tcity.latitude,\n\t\t\t\t\tcity.longitude\n\t\t\t\t) || Infinity\n\t\t\t\t\n\t\t\t\tif (distance < minDistance) {\n\t\t\t\t\tminDistance = distance\n\t\t\t\t\tnearestCity = city\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t\t\n\t\tconsole.log(`选择最近的服务城市: ${nearestCity.name}, 距离: ${minDistance.toFixed(2)}km`)\n\t\treturn nearestCity.code\n\t}\n\n\t// 跳转到详情页面\n\tconst navigateToDetail = async (partnerId, cityCode, latitude = null, longitude = null) => {\n\t\tlet url = '/subPackages/py/detail?id=' + partnerId + '&city_code=' + cityCode\n\t\t\n\t\t// 添加经纬度参数\n\t\tif (latitude && longitude) {\n\t\t\turl += '&latitude=' + latitude + '&longitude=' + longitude\n\t\t}\n\t\t\n\t\tuni.navigateTo({\n\t\t\turl: url\n\t\t})\n\t}\n</script>\n\n<style lang=\"scss\" scoped>\n\t.comment {\n\t\theight: 100vh;\n\t\toverflow: hidden !important;\n\t\tdisplay: flex;\n\t\tbackground: #fff;\n\t\tflex-direction: column;\n\t}\n\n\t.comment_top {\n\t\tbackground-color: #fff;\n\t}\n\n\n\t.top {\n\t\tpadding: 24rpx;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: space-between;\n\n\t\t.top-left {\n\t\t\tdisplay: flex;\n\t\t\talign-items: center;\n\t\t}\n\n\t\t.info { \n\t\t\t.info-one {\n\t\t\t\tdisplay: flex;\n\t\t\t     flex-direction: column;\n               \n\t\t\t\t.name {\n\t\t\t\t\tmargin-left: 20rpx;\n\t\t\t\t\tfont-size: 24rpx;\n\t\t\t\t\tfont-weight: 700;\n\t\t\t\t\tcolor: rgba(0, 0, 0, 1);\n\t\t\t\t}\n\n\t\t\t\t.introduce {\n\t\t\t\t\tmargin-left: 12rpx;\n\t\t\t\t\tpadding: 4rpx 10rpx;\n\t\t\t\t\theight: 28rpx;\n\t\t\t\t\tborder-radius: 19rpx;\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\tflex-direction: row;\n\t\t\t\t\tjustify-content: space-evenly;\n\t\t\t\t\talign-items: center;\n\n\t\t\t\t\t.image {\n\t\t\t\t\t\tmargin-right: 5rpx;\n\t\t\t\t\t\twidth: 20rpx;\n\t\t\t\t\t\theight: 20rpx;\n\t\t\t\t\t}\n\n\t\t\t\t\t.introduce-title {\n\t\t\t\t\t\tfont-size: 16rpx;\n\t\t\t\t\t\tfont-weight: 500;\n\t\t\t\t\t\tcolor: rgba(255, 255, 255, 1);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t.like {\n\t\t\twidth: 84rpx;\n\t\t\tpadding: 10rpx 0rpx;\n\t\t\tborder-radius: 23rpx;\n\t\t\tborder: 1px solid rgba(204, 204, 204, 1);\n\t\t\tdisplay: flex;\n\t\t\tflex-direction: row;\n\t\t\tjustify-content: center;\n\t\t\talign-items: center;\n\t\t\tfont-size: 20rpx;\n\t\t\tfont-weight: 700;\n\t\t\tcolor: #fff;\n\t\t\tbackground: #7363FF;\n\t\t}\n\n\t\t.invite-btn {\n\t\t\tbackground: linear-gradient(135deg, #7363FF 0%, #FF69DE 100%);\n\t\t\tcolor: white;\n\t\t\tborder-radius: 32rpx;\n\t\t\tpadding: 12rpx 24rpx;\n\t\t\tfont-size: 24rpx;\n\t\t\tfont-weight: 700;\n\t\t}\n\t}\n\n\t.flex-box {\n\t\theight: 0;\n\t\tflex: 1;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t}\n\n\t.scroll-Y {\n\t\theight: 0;\n\t\tflex: 1;\n\t}\n\n\t// 动态内容\n\t.moment-content {\n\t\tpadding: 24rpx;\n\t\tborder-bottom: 1rpx solid #F2F2F2;\n\n\t\t.moment-text {\n\t\t\tfont-size: 24rpx;\n\t\t\tcolor: #1a1a1a;\n\t\t\tline-height: 1.5;\n\t\t\tmargin-bottom: 20rpx;\n\t\t}\n\n\t\t.moment-media {\n\t\t\tmargin: 20rpx 0;\n\t\t}\n\n\t\t.moment-topics {\n\t\t\tmargin: 20rpx 0;\n\t\t\tdisplay: flex;\n\t\t\tflex-wrap: wrap;\n\t\t\tgap: 12rpx;\n\n\t\t\t.topic-item {\n\t\t\t\tdisplay: flex;\n\t\t\t\talign-items: center;\n\t\t\t\tpadding: 8rpx 16rpx;\n\t\t\t\tbackground: rgba(115, 99, 255, 0.1);\n\t\t\t\tborder-radius: 20rpx;\n\t\t\t\tborder: 1rpx solid rgba(115, 99, 255, 0.3);\n\n\t\t\t\t.topic-icon {\n\t\t\t\t\twidth: 24rpx;\n\t\t\t\t\theight: 24rpx;\n\t\t\t\t\tmargin-right: 8rpx;\n\t\t\t\t}\n\n\t\t\t\t.topic-text {\n\t\t\t\t\tfont-size: 20rpx;\n\t\t\t\t\tcolor: #7363FF;\n\t\t\t\t\tfont-weight: 500;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t.moment-actions {\n\t\t\tdisplay: flex;\n\t\t\talign-items: center;\n\t\t\tgap: 40rpx;\n\n\t\t\t.action-item {\n\t\t\t\tdisplay: flex;\n\t\t\t\talign-items: center;\n\t\t\t\tgap: 8rpx;\n\n\t\t\t\t.action-icon {\n\t\t\t\t\twidth: 32rpx;\n\t\t\t\t\theight: 32rpx;\n\t\t\t\t}\n\n\t\t\t\t.action-text {\n\t\t\t\t\tfont-size: 20rpx;\n\t\t\t\t\tcolor: #999;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t@mixin comment-item {\n\t\tdisplay: flex;\n\n\t\t.left {\n\t\t\tmargin-right: 12rpx;\n\t\t}\n\n\t\t.right {\n\t\t\tflex: 1;\n\t\t\tdisplay: flex;\n\t\t\tflex-direction: column;\n\t\t\talign-items: flex-start;\n\n\t\t\t.username {\n\t\t\t\tdisplay: flex;\n\t\t\t\talign-items: center;\n\t\t\t\tmargin-bottom: 8rpx;\n\t\t\t\tfont-size: 20rpx;\n\t\t\t\tcolor: #999;\n\n\t\t\t\timage {\n\t\t\t\t\ttransform: translateY(2rpx);\n\t\t\t\t\twidth: 11rpx;\n\t\t\t\t\theight: 13.5rpx;\n\t\t\t\t\tmargin: 0 12rpx;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t.comment-content {\n\t\t\t\tmargin-bottom: 12rpx;\n\t\t\t\twidth: 550rpx;\n\t\t\t\tword-wrap: break-word;\n\t\t\t\tfont-size: 24rpx;\n\t\t\t\tcolor: #1a1a1a;\n\t\t\t}\n\n\t\t\t.option {\n\t\t\t\tdisplay: flex;\n\t\t\t\tjustify-content: space-between;\n\t\t\t\talign-items: center;\n\t\t\t\twidth: 100%;\n\n\t\t\t\t.time {\n\t\t\t\t\tmargin-right: 20rpx;\n\t\t\t\t\tfont-size: 20rpx;\n\t\t\t\t\tcolor: #999;\n\t\t\t\t}\n\n\t\t\t\t.reply-btn {\n\t\t\t\t\tfont-size: 20rpx;\n\t\t\t\t\tcolor: #666;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// 评论区\n\t.comment-section {\n\t\tpadding: 0 24rpx;\n\t\t margin-top: 24rpx;\n         box-sizing: border-box;\n\t\t.title {\n\t\t\tmargin-bottom: 20rpx;\n\t\t\tfont-size: 24rpx;\n\t\t\tfont-weight: 500;\n\t\t}\n\n\t\t.comment-list {\n\t\t\tpadding-bottom: 180rpx;\n\t\t\tdisplay: flex;\n\t\t\tflex-direction: column;\n\n\t\t\t.comment-item {\n\t\t\t\tmargin-bottom: 32rpx;\n\n\t\t\t\t.main {\n\t\t\t\t\t@include comment-item;\n\t\t\t\t\tmargin-bottom: 16rpx;\n\n\t\t\t\t\t&:active {\n\t\t\t\t\t\tbackground: linear-gradient(90deg, rgba(242, 242, 242, 0) 0%, rgba(242, 242, 242, 1) 54.17%, rgba(242, 242, 242, 0) 100%);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t.reply-list {\n\t\t\t\t\tmargin-top: 16rpx;\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\tflex-direction: column;\n\t\t\t\t\tmargin-left: 76rpx;\n\n\t\t\t\t\t.reply-item {\n\t\t\t\t\t\t@include comment-item;\n\t\t\t\t\t\tmargin-bottom: 16rpx;\n\n\t\t\t\t\t\t&:active {\n\t\t\t\t\t\t\tbackground: linear-gradient(90deg, rgba(242, 242, 242, 0) 0%, rgba(242, 242, 242, 1) 54.17%, rgba(242, 242, 242, 0) 100%);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t.expand {\n\t\tmargin-top: 32rpx;\n\t\tmargin-left: 76rpx;\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\twidth: 210rpx;\n\n\t\t.line {\n\t\t\twidth: 44rpx;\n\t\t\theight: 2rpx;\n\t\t\tbackground-color: #7363FF;\n\t\t}\n\n\t\ttext {\n\t\t\tfont-size: 20rpx;\n\t\t\tcolor: #7363FF;\n\t\t}\n\t}\n\n\t// 聊天框\n\t.chatting {\n\t\tbox-sizing: border-box;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: space-between;\n\t\twidth: 100%;\n\t\tpadding: 16rpx 22rpx 34rpx;\n\t\tbackground-color: #ffffff;\n\t\tbox-shadow: 0px -0.2px 0.5px rgba(229, 229, 229, 1);\n\t\tborder-top: 2rpx solid #fff;\n\n\t\t:deep(.u-input) {\n\t\t\tbox-sizing: border-box;\n\t\t\tflex: 1;\n\t\t\theight: 68rpx;\n\t\t}\n\n\t\t.send-btn-show {\n\t\t\twidth: 100rpx;\n\t\t\theight: 56rpx;\n\t\t\tbackground-color: #7363FF;\n\t\t\tborder-radius: 36rpx;\n\t\t\tcolor: #fff;\n\t\t\tfont-size: 24rpx;\n\t\t\tfont-weight: 500;\n\t\t\ttext-align: center;\n\t\t\t\tmargin-left: 20rpx;\n\t\t\tline-height: 56rpx; \n\t\t}\n\t}\n\n\t.no-record {\n\t\tmargin-top: 46rpx;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\n\t\t.no-record-image {\n\t\t\twidth: 140rpx;\n\t\t\theight: 140rpx;\n\t\t}\n\n\t\t.no-record-title {\n\t\t\tmargin-top: 12rpx;\n\t\t\tfont-size: 20rpx;\n\t\t\tfont-weight: 400;\n\t\t\tcolor: rgba(153, 153, 153, 1);\n\t\t}\n\t}\n\n\t.nav-com-left {\n\t\twidth: 170rpx;\n\n\t\t.nav-com-image {\n\t\t\twidth: 48rpx;\n\t\t\theight: 48rpx;\n\t\t}\n\t}\n\n\t// 弹框容器样式\n\t.popup-container {\n\t\tbackground: #fff;\n\t\tborder-radius: 20rpx 20rpx 0 0;\n\t\toverflow: hidden;\n\t\tposition: relative;\n\t}\n\n\t// 拖拽指示条\n\t.drag-indicator {\n\t\twidth: 60rpx;\n\t\theight: 6rpx;\n\t\tbackground: #E5E5E5;\n\t\tborder-radius: 3rpx;\n\t\tmargin: 16rpx auto 24rpx;\n\t\ttransition: all 0.2s ease;\n\t\t\n\t\t&:active {\n\t\t\tbackground: #C0C0C0;\n\t\t\ttransform: scale(1.1);\n\t\t}\n\t}\n\n\t// 弹框输入区域\n\t.popup-input-area {\n\t\tpadding: 0 24rpx 40rpx;\n\t\tbackground: #fff;\n\t}\n\n\t.input-wrapper {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 16rpx;\n\t\tposition: relative;\n\t}\n\n\t// 发送按钮样式\n\t.send-btn {\n\t\twidth: 100rpx;\n\t\theight: 56rpx;\n\t\tborder-radius: 36rpx;\n\t\tbackground: #E5E5E5;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\ttransition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);\n\t\ttransform: scale(0.9);\n\t\topacity: 0.6;\n\t\t\n\t\t.send-text {\n\t\t\tfont-size: 24rpx;\n\t\t\tcolor: #999;\n\t\t\tfont-weight: 500;\n\t\t\ttransition: all 0.3s ease;\n\t\t}\n\t\t\n\t\t&.send-btn-active {\n\t\t\tbackground: linear-gradient(135deg, #7363FF 0%, #FF69DE 100%);\n\t\t\ttransform: scale(1);\n\t\t\topacity: 1;\n\t\t\tbox-shadow: 0 4rpx 12rpx rgba(115, 99, 255, 0.3);\n\t\t\t\n\t\t\t.send-text {\n\t\t\t\tcolor: #fff;\n\t\t\t\tfont-weight: 600;\n\t\t\t}\n\t\t}\n\t\t\n\t\t&:active {\n\t\t\ttransform: scale(0.95);\n\t\t}\n\t}\n\n\t// 弹框动画效果\n\t:deep(.u-popup) {\n\t\t.u-popup__content {\n\t\t\ttransition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94) !important;\n\t\t}\n\t\t\n\t\t.u-popup__overlay {\n\t\t\ttransition: all 0.3s ease !important;\n\t\t}\n\t}\n\n\t// 输入框聚焦时的样式\n\t:deep(.u-input) {\n\t\t&.u-input--focus {\n\t\t\tbackground: #fff !important;\n\t\t\tbox-shadow: 0 0 0 2rpx rgba(115, 99, 255, 0.2) !important;\n\t\t\ttransform: scale(1.02);\n\t\t}\n\t}\n</style>","import MiniProgramPage from '/Users/xiaoqiang/Documents/friemd/firend-loving-app/subPackages/record/comment.vue'\nwx.createPage(MiniProgramPage)"],"names":["PictureDisplay","$instance","ref","getCurrentInstance","scrollTop","oldScrollTop","momentsId","pageComment","totalComment","commentDataLoaded","userInfoComment","commentListData","momentsInfoComment","rplContent","replyCommentsId","replyCommentsName","showOneReply","inputFocus","dragStartY","dragCurrentY","isDragging","onLoad","options","data","getData","val","response","getMomentsDetail","getCommentData","uni","_a","error","page","getMomentCommentList","useMockCommentData","lowerComment","reply","handleReleaseComment","params","pushMomentComment","newComment","item","handleClosePopup","handleHasMore","getMoreMomentCommentList","handleScroll","e","handleBlur","handleFocus","handleInputFocus","handleInputBlur","handleInputChange","value","handleDragStart","handleDragMove","handleDragEnd","toDetail","res","toDetailItem","handleShowOneReply","safeNumberOperation","operation","amount","numValue","handlePraise","wasPraised","praiseMoment","MiniProgramPage"],"mappings":"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"}