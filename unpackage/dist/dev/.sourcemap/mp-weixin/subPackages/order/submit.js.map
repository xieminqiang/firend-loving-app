{"version":3,"file":"submit.js","sources":["subPackages/order/submit.vue","subPackages/order/submit.vue?type=page"],"sourcesContent":["<template>\n  <view class=\"submit-order-container\">\n    <scroll-view \n      scroll-y=\"true\" \n      class=\"scroll-content\" \n    >\n      <!-- 地址选择 -->\n      <view class=\"section-card\">\n        <view class=\"section-item\" @click=\"selectAddress\">\n          <view class=\"item-left\">\n            <image src=\"/static/icons/friend/yuan_dingwei.png\" class=\"item-icon\" mode=\"aspectFit\" />\n            <text class=\"item-text\" :class=\"{ 'selected': selectedAddress !== '请选择地址' }\">{{ selectedAddress }}</text>\n          </view>\n          <image src=\"/static/icons/common/arrow-right.png\" class=\"arrow-icon\" mode=\"aspectFit\" />\n        </view>\n      </view>\n\n      <!-- 服务时间和出行方式 -->\n      <view class=\"section-card\">\n        <view class=\"section-item\" @click=\"selectServiceTime\">\n          <view class=\"item-left\">\n            <text class=\"item-text\">服务时间</text>\n          </view>\n          <view class=\"item-right\">\n            <text class=\"time-text\">{{ serviceTime }}</text>\n            <image src=\"/static/icons/common/arrow-right.png\" class=\"arrow-icon\" mode=\"aspectFit\" />\n          </view>\n        </view>\n        <view class=\"section-item\">\n          <view class=\"item-left\">\n            <text class=\"item-text\">出行方式</text>\n          </view>\n          <view class=\"item-right\">\n            <view class=\"radio-group\">\n              <view class=\"radio-item\" @click=\"selectTravelMethod('taxi')\">\n                <view class=\"radio-circle\" :class=\"{ active: travelMethod === 'taxi' }\">\n                  <view v-if=\"travelMethod === 'taxi'\" class=\"radio-dot\"></view>\n                </view>\n                <text class=\"radio-text\">出租车</text>\n              </view>\n            </view>\n          </view>\n        </view>\n      </view>\n\n      <!-- 服务项目 -->\n      <view class=\"section-card \" v-if=\"serviceInfo?.service\">\n        <view class=\"service-item\">\n          <image :src=\"$imgBaseUrl + serviceInfo?.service?.image_url\" class=\"service-img\" mode=\"aspectFill\" />\n          <view class=\"service-info\">\n            <text class=\"service-title\">{{ serviceInfo?.service?.name }}</text>\n            <view class=\"service-price-row\">\n              <text class=\"service-price\">¥{{ serviceInfo?.price_info?.unit_price }}</text>\n              <text class=\"service-duration\">/ {{ serviceInfo?.price_info?.unit}}</text>\n            </view>\n            <text class=\"service-provider\">友伴达人: {{ params.nickname}}</text>\n          </view>\n          <view class=\"quantity-selector\">\n            <view \n              class=\"quantity-btn minus\" \n              :class=\"{ disabled: quantity <= (serviceInfo?.price_info?.min_quantity || 1) }\"\n              @click=\"decreaseQuantity\"\n            >\n              <image src=\"/static/icons/friend/del_icon.png\" class=\"quantity-icon\" mode=\"aspectFit\" />\n            </view>\n            <text class=\"quantity-text\">{{ quantity }}</text>\n            <view class=\"quantity-btn plus\" @click=\"increaseQuantity\">\n              <image src=\"/static/icons/friend/add_icon.png\" class=\"quantity-icon\" mode=\"aspectFit\" />\n            </view>\n          </view>\n        </view>\n      </view>\n\n      <!-- 费用 -->\n      <view class=\"section-card\">\n                <view class=\"section-item\">\n          <view class=\"item-left\">\n            <text class=\"item-text\">往返车费</text>\n          </view>\n          <view class=\"item-right\">\n            <text class=\"fare-text\">¥{{ roundTripFare.toFixed(2) }}</text>\n          </view>\n        </view>\n        <view class=\"fare-detail\">\n          <text class=\"fare-detail-text\">全程共{{ totalDistance }}km，出租出行收取来回车费，1km内，起步10元。里程计价1.5元/km</text>\n         \n        </view>\n      </view>\n\n      <!-- 订单备注 -->\n      <view class=\"section-card\">\n        <view class=\"section-item\">\n          <view class=\"item-left\">\n            <text class=\"item-text\">订单备注</text>\n          </view>\n          <view class=\"item-right\">\n            <input \n              v-model=\"orderNotes\" \n              placeholder=\"请输入备注信息\" \n              class=\"notes-input\"\n              maxlength=\"200\"\n            />\n          </view>\n        </view>\n      </view>\n    </scroll-view>\n\n    <!-- 底部提交按钮 -->\n    <view class=\"action-buttons\">\n      <view class=\"action-container\">\n        <view class=\"price-summary\">\n          <text class=\"total-price\">合计: ¥{{ totalPrice.toFixed(2) }}</text>\n        </view>\n        <view class=\"submit-btn\" @click=\"submitOrder\">\n          提交订单\n        </view>\n      </view>\n    </view>\n\n        <!-- 时间选择弹框 -->\n    <uni-popup ref=\"timePickerPopup\" type=\"bottom\" :mask-click=\"true\" @close=\"showTimePicker = false\" round=\"20\">\n      <view class=\"time-picker-content\">\n        <!-- 日期导航栏 -->\n        <view class=\"day-filter\">\n          <scroll-view \n            class=\"day-scroll\" \n            scroll-x=\"true\" \n            show-scrollbar=\"false\" \n            :scroll-left=\"dayScrollLeft\" \n            :scroll-with-animation=\"dayScrollWithAnimation\"\n          >\n            <view class=\"day-tabs\">\n              <view \n                v-for=\"(day, index) in availableSchedule\" \n                :key=\"index\"\n                class=\"day-tab\"\n                :class=\"{ active: selectedDayIndex === index }\"\n                @click=\"switchDay(index)\"\n              >\n                <text class=\"day-name\">{{ day.day_name }}</text>\n                <text class=\"day-date\">{{ day.date }}</text>\n              </view>\n            </view>\n          </scroll-view>\n        </view>\n\n        <!-- 时间段列表 -->\n        <view class=\"time-slots-container\">\n          <view class=\"time-slots-grid\">\n            <view \n              v-for=\"(timeSlot, index) in getCurrentDayTimeSlots()\" \n              :key=\"index\"\n              class=\"time-slot-item\"\n              :class=\"{ \n                'available': timeSlot.status === 1,\n                'unavailable': timeSlot.status === 2,\n                'selected': selectedTimeSlot === timeSlot\n              }\"\n              @click=\"selectTimeSlot(timeSlot)\"\n            >\n              <text class=\"time-text\">{{ timeSlot.time }}</text>\n             \n            </view>\n         \n          </view>\n          <view style=\"height: 40rpx;\"></view>\n        </view>\n\n\n      </view>\n    </uni-popup>\n  </view>\n</template>\n\n<script setup>\nimport { ref, computed, onMounted, nextTick } from 'vue'\nimport { getServiceInfo, calculateDistance, getCompanionAvailableSchedule, createOrderV2, orderParams } from '@/api/order.js'\n\n// 页面参数\nconst params = ref({})\n\n// 表单数据\nconst serviceTime = ref('')\nconst travelMethod = ref('taxi')\nconst quantity = ref(1)\nconst roundTripFare = ref(0.00)\nconst totalDistance = ref(0)\nconst orderNotes = ref('')\n\n// 时间选择相关数据\nconst showTimePicker = ref(false)\nconst availableSchedule = ref([])\nconst selectedDayIndex = ref(0)\nconst selectedTimeSlot = ref(null)\nconst dayScrollLeft = ref(0)\nconst dayScrollWithAnimation = ref(false)\nconst timePickerPopup = ref(null)\n\n// 地址选择相关数据\nconst selectedAddress = ref('请选择地址')\nconst selectedLocation = ref(null)\n\n// 服务信息\nconst serviceInfo = ref({\n\n})\n\n// 计算总价\nconst totalPrice = computed(() => {\n  const servicePrice = serviceInfo.value?.price_info?.unit_price * quantity.value || 0\n  const total = servicePrice + roundTripFare.value\n  return Number(total.toFixed(2))\n})\n\n// 加载服务信息\nconst loadServiceInfo = async () => {\n  try {\n    const { service_id, level_order, companion_id, price_template_id } = params.value\n    \n    if (!service_id || !level_order || !companion_id || !price_template_id) {\n      console.warn('缺少必要的参数')\n      return\n    }\n    \n    const response = await getServiceInfo({\n      service_id: Number(service_id)    ,\n      level_order: Number(level_order),\n      companion_id: Number(companion_id),\n      price_template_id: Number(price_template_id)\n    })\n    console.log(\"response.data\",response.data)\n    if (response.data.code === 0) {\n      const data = response.data.data\n      // 更新服务信息\n      serviceInfo.value = data\n      \n      // 设置默认数量为最小数量\n      const minQuantity = data?.price_info?.min_quantity || 1\n      quantity.value = minQuantity\n    } else {\n      throw new Error(response.data.msg || '获取服务信息失败')\n    }\n  } catch (error) {\n    console.error('加载服务信息失败:', error)\n    uni.showToast({\n      title: error.message || '加载服务信息失败',\n      icon: 'none'\n    })\n  }\n}\n\n// 选择地址\nconst selectAddress = () => {\n  // #ifdef MP-WEIXIN\n  uni.chooseLocation({\n    success: async (res) => {\n      const address = res.address || res.name || '已选择位置'\n      console.log('手动选择位置', res)\n      \n      // 更新显示\n      selectedAddress.value = address\n      selectedLocation.value = {\n        latitude: res.latitude,\n        longitude: res.longitude,\n        address: address\n      }\n      \n      // 调用计算距离接口\n      await calculateOrderDistance(res.latitude, res.longitude)\n      \n    },\n    fail: (err) => {\n      if (err.errMsg && err.errMsg.indexOf('cancel') === -1) {\n        uni.showToast({\n          title: '获取位置失败',\n          icon: 'none'\n        })\n        console.error('获取位置失败:', err.errMsg)\n      }\n    }\n  })\n  // #endif\n  // #ifndef MP-WEIXIN\n  uni.showToast({\n    title: '请在微信小程序中使用地图选点',\n    icon: 'none'\n  })\n  // #endif\n}\n\n// 选择服务时间\nconst selectServiceTime = () => {\n  if (availableSchedule.value.length === 0) {\n    uni.showToast({\n      title: '暂无可用时间',\n      icon: 'none'\n    })\n    return\n  }\n  \n  // 自动选择第一个有可用时间段的日期\n  selectedDayIndex.value = getFirstAvailableDayIndex()\n  \n  showTimePicker.value = true\n  \n  // 初始化日期导航滚动位置\n  nextTick(() => {\n    dayScrollWithAnimation.value = false;\n    dayScrollLeft.value = 0;\n    // 打开弹框\n    timePickerPopup.value.open();\n  });\n}\n\n\n\n// 切换选中的日期\nconst switchDay = (index) => {\n  selectedDayIndex.value = index\n  selectedTimeSlot.value = null\n  \n  // 开启滚动动画\n  dayScrollWithAnimation.value = true\n  \n  // 延迟执行滚动，确保DOM更新完成\n  nextTick(() => {\n    // 计算导航项的实际宽度（包括padding）\n    const itemWidth = uni.upx2px(140); // 每个导航项的宽度（rpx转px）\n    const containerWidth = uni.getWindowInfo().windowWidth;\n    const padding = uni.upx2px(40); // 左右padding\n    const availableWidth = containerWidth - padding;\n    \n    // 计算可视区域可以显示的导航项数量（估算值）\n    const visibleItems = Math.floor(availableWidth / itemWidth * 0.8);\n    \n    if (index > 2) {\n      // 计算最佳滚动位置：保持选中项稍微偏左，让用户可以看到右侧还有导航项\n      // 这里我们让选中的导航项位于可视区域的1/3处\n      const scrollPos = Math.max(0, index * itemWidth - visibleItems * itemWidth / 3);\n      dayScrollLeft.value = scrollPos;\n    } else {\n      // 如果是前几个导航项，滚回开始位置\n      dayScrollLeft.value = 0;\n    }\n    \n    // 滚动完成后关闭动画（可选，保持动画开启也可以）\n    setTimeout(() => {\n      dayScrollWithAnimation.value = false;\n    }, 300);\n  });\n}\n\n// 选择时间段\nconst selectTimeSlot = (timeSlot) => {\n  if (timeSlot.status !== 1) return // 只能选择可约的时间段\n  \n  selectedTimeSlot.value = timeSlot\n  const selectedDay = availableSchedule.value[selectedDayIndex.value]\n  serviceTime.value = `${selectedDay.day_name} ${selectedDay.date} ${timeSlot.time}`\n  timePickerPopup.value.close()\n  showTimePicker.value = false\n}\n\n// 获取第一个有可用时间段的日期索引\nconst getFirstAvailableDayIndex = () => {\n  if (availableSchedule.value.length === 0) return 0\n  \n  for (let i = 0; i < availableSchedule.value.length; i++) {\n    const daySchedule = availableSchedule.value[i]\n    const timeSlots = daySchedule?.time_slots || []\n    const hasAvailableSlots = timeSlots.some(slot => slot.status === 1)\n    \n    if (hasAvailableSlots) {\n      return i\n    }\n  }\n  \n  return 0 // 如果没有找到有可用时间段的日期，返回第一个\n}\n\n// 获取当前选中日期的可用时间段\nconst getCurrentDayTimeSlots = () => {\n  if (availableSchedule.value.length === 0) return []\n  return availableSchedule.value[selectedDayIndex.value]?.time_slots || []\n}\n\n// 选择出行方式\nconst selectTravelMethod = (method) => {\n  travelMethod.value = method\n}\n\n// 增加数量\nconst increaseQuantity = () => {\n  quantity.value++\n}\n\n// 减少数量\nconst decreaseQuantity = () => {\n  const minQuantity = serviceInfo.value?.price_info?.min_quantity || 1\n  if (quantity.value > minQuantity) {\n    quantity.value--\n  }\n}\n\n// 计算订单距离\nconst calculateOrderDistance = async (userLatitude, userLongitude) => {\n  try {\n    const requestData = {\n      companion_id: Number(params.value.companion_id),\n      user_latitude: userLatitude,\n      user_longitude: userLongitude\n    }\n    \n    console.log('计算距离请求参数:', requestData)\n    \n    const response = await calculateDistance(requestData)\n    \n    if (response.data && response.data.code === 0) {\n      const result = response.data.data\n      console.log('距离计算结果:', result)\n      \n      // 更新距离和车费信息\n      if (result.distance !== undefined) {\n        totalDistance.value = result.distance\n      }\n      if (result.transport_fee !== undefined) {\n        // 车费 = transport_fee * 2，注意计算精度\n        roundTripFare.value = Number((result.transport_fee * 2).toFixed(2))\n      }\n      \n   \n    } else {\n      console.error('计算距离失败:', response.data?.msg)\n      uni.showToast({\n        title: response.data?.msg || '计算距离失败',\n        icon: 'none'\n      })\n    }\n  } catch (error) {\n    console.error('计算距离接口调用失败:', error)\n    uni.showToast({\n      title: '计算距离失败，请重试',\n      icon: 'none'\n    })\n  }\n}\n\n// 查看计费规则\nconst viewBillingRules = () => {\n  uni.showToast({\n    title: '查看计费规则功能',\n    icon: 'none'\n  })\n}\n\n// 提交订单\nconst submitOrder = async () => {\n  // 验证地址是否已选择\n  if (selectedAddress.value === '请选择地址') {\n    uni.showToast({\n      title: '请先选择服务地址',\n      icon: 'none'\n    })\n    return\n  }\n  \n  // 验证服务时间是否已选择\n  if (!serviceTime.value) {\n    uni.showToast({\n      title: '请先选择服务时间',\n      icon: 'none'\n    })\n    return\n  }\n  \n  // 解析服务时间，提取日期和时间段\n  // 格式可能是 \"周一 2024-01-15 09:00\" 或 \"2024-01-15 09:00\"\n  const timeMatch = serviceTime.value.match(/(\\d{4}-\\d{2}-\\d{2})\\s+(.+)/)\n  if (!timeMatch) {\n    uni.showToast({\n      title: '服务时间格式错误',\n      icon: 'none'\n    })\n    return\n  }\n  \n  const serviceDate = timeMatch[1] // YYYY-MM-DD\n  const serviceTimeSlot = timeMatch[2] // 时间段\n  \n  const orderData = {\n    companion_id: Number(params.value.companion_id),\n    service_id: Number(params.value.service_id),\n    level_order: Number(params.value.level_order),\n    price_template_id: Number(params.value.price_template_id),\n    quantity: quantity.value,\n    service_address: selectedAddress.value,\n    service_date: serviceDate,\n    service_time: serviceTimeSlot,\n    remark: orderNotes.value,\n    user_latitude: selectedLocation.value?.latitude,\n    user_longitude: selectedLocation.value?.longitude\n  }\n  \n  console.log('提交订单数据:', orderData)\n  \n  uni.showLoading({\n    title: '提交中...'\n  })\n  \n  try {\n    // 调用创建订单接口\n    const response = await createOrderV2(orderData)\n    \n    if (response.data.code === 0) {\n      console.log('订单创建成功:', response.data)\n      \n      // 调用订单创建成功接口\n      try {\n        const orderParamsData = {\n          order_id: response.data.data.order_id,\n          payment_method: 1\n        }\n        const paramsResponse = await orderParams(orderParamsData)\n        \n        if (paramsResponse.data.code === 0) {\n          // 调用微信支付\n          uni.requestPayment({\n            provider: 'wxpay',\n            ...paramsResponse.data.data.pay_params,\n            success: (res) => {\n              console.log('支付成功', res);\n              uni.showToast({\n                title: '支付成功',\n                icon: 'success',\n              });\n              // 支付成功后跳转到订单列表，传递刷新参数\n              setTimeout(() => {\n                uni.navigateTo({\n                  url: `/subPackages/order/index?refresh=true`\n                })\n              }, 1500)\n            },\n            fail: (err) => {\n              console.error('支付失败', JSON.stringify(err));\n              uni.showToast({\n                title: '支付失败',\n                icon: 'none'\n              })\n            },\n          });\n        } else {\n          throw new Error(paramsResponse.data.msg || '获取支付参数失败')\n        }\n      } catch (error) {\n        console.error('获取支付参数失败:', error)\n        uni.showToast({\n          title: error.message || '获取支付参数失败',\n          icon: 'none'\n        })\n      }\n    } else {\n      throw new Error(response.data.msg || '创建订单失败')\n    }\n  } catch (error) {\n    console.error('提交订单失败:', error)\n    uni.showToast({\n      title: error.message || '提交订单失败',\n      icon: 'none'\n    })\n  } finally {\n    uni.hideLoading()\n  }\n}\n\nonMounted(() => {\n  // 获取页面参数\n  const pages = getCurrentPages()\n  const currentPage = pages[pages.length - 1]\n  params.value = currentPage.options || {}\n  \n  console.log('订单提交页面参数:', params.value)\n  \n  // 加载服务信息\n  loadServiceInfo()\n  \n  // 调用友伴师可用时间安排接口\n  if (params.value.companion_id) {\n    getCompanionAvailableSchedule(Number(params.value.companion_id))\n      .then(response => {\n        console.log('友伴师可用时间安排:', response)\n        if (response.data && response.data.code === 0) {\n          availableSchedule.value = response.data.data.schedule || []\n          // 自动选择第一个有可用时间段的日期\n          if (availableSchedule.value.length > 0) {\n            selectedDayIndex.value = getFirstAvailableDayIndex()\n          }\n        }\n      })\n      .catch(error => {\n        console.error('获取友伴师可用时间安排失败:', error)\n      })\n  }\n})\n</script>\n\n<style scoped>\n.submit-order-container {\n  min-height: 100vh;\n  background: #f5f5f5;\n  padding-bottom: calc(120rpx + env(safe-area-inset-bottom));\n}\n\n.scroll-content {\n  height: calc(100vh - 120rpx);\n  padding-bottom: 20rpx;\n}\n\n.section-card {\n  background: #fff;\n  margin: 20rpx;\n  border-radius: 16rpx;\n  overflow: hidden;\n\n}\n\n.section-item {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding:  24rpx;\n\n}\n\n.section-item:last-child {\n  border-bottom: none;\n}\n\n.item-left {\n  display: flex;\n  align-items: center;\n  gap: 16rpx;\n}\n\n.item-icon {\n  width: 40rpx;\n  height: 40rpx;\n}\n\n.item-text {\n  font-size: 28rpx;\n  color: #1a1a1a;\n  font-weight: 500;\n}\n\n\n.item-right {\n  display: flex;\n  align-items: center;\n  gap: 12rpx;\n}\n\n.arrow-icon {\n  width: 30rpx;\n  height: 30rpx;\n}\n\n.time-text {\n  font-size: 28rpx;\n  color: #7363FF;\n  font-weight: 500;\n}\n\n.radio-group {\n  display: flex;\n  align-items: center;\n  gap: 16rpx;\n}\n\n.radio-item {\n  display: flex;\n  align-items: center;\n  gap: 8rpx;\n}\n\n.radio-circle {\n  width: 32rpx;\n  height: 32rpx;\n  border: 2rpx solid #ddd;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  position: relative;\n}\n\n.radio-circle.active {\n  border-color: #7363FF;\n}\n\n.radio-dot {\n  width: 16rpx;\n  height: 16rpx;\n  background: #7363FF;\n  border-radius: 50%;\n}\n\n.radio-text {\n  font-size: 28rpx;\n  color: #333;\n}\n\n.service-card {\n  margin-top: 32rpx;\n}\n\n.service-item {\n  display: flex;\n  align-items: center;\n  padding: 24rpx;\n  gap: 20rpx;\n}\n\n.service-img {\n  width: 120rpx;\n  height: 120rpx;\n  border-radius: 12rpx;\n  object-fit: cover;\n}\n\n.service-info {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  gap: 6rpx;\n}\n\n.service-title {\n  font-size: 28rpx;\n  font-weight: 500;\n  color: #1a1a1a;\n}\n\n.service-price-row {\n  display: flex;\n  align-items: center;\n  gap: 8rpx;\n}\n\n.service-price {\n  font-size: 32rpx;\n  color: #ff4757;\n  font-weight: 600;\n}\n\n.service-duration {\n  font-size: 24rpx;\n  color: #666;\n}\n\n.service-provider {\n  font-size: 24rpx;\n  color: #999;\n}\n\n.quantity-selector {\n  display: flex;\n  align-items: center;\n  gap: 16rpx;\n}\n\n.quantity-btn {\n  width: 40rpx;\n  height: 40rpx;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.3s ease;\n}\n\n.quantity-btn.minus {\n  background: #f0f0f0;\n}\n\n.quantity-btn.plus {\n  background: #7363FF;\n}\n\n.quantity-btn:active:not(.disabled) {\n  transform: scale(0.9);\n}\n\n.quantity-btn.disabled {\n  opacity: 0.4;\n  background: #e0e0e0;\n}\n\n.quantity-icon {\n  width: 100%;\n  height: 100%;\n}\n\n.quantity-text {\n  font-size: 28rpx;\n  color: #333;\n  font-weight: 500;\n  min-width: 40rpx;\n  text-align: center;\n}\n\n.fare-text {\n  font-size: 28rpx;\n  color: #ff4757;\n  font-weight: 500;\n}\n\n.fare-detail {\n  padding: 0 24rpx 24rpx 24rpx;\n}\n\n.fare-detail-text {\n  font-size: 24rpx;\n  color: #666;\n  line-height: 1.5;\n}\n\n.fare-link {\n  font-size: 24rpx;\n  color: #7363FF;\n  text-decoration: underline;\n}\n\n.notes-input {\n  flex: 1;\n  font-size: 28rpx;\n  color: #1a1a1a;\n  border: none;\n  outline: none;\n  background: transparent;\n  text-align: right;\n}\n\n.action-buttons {\n  position: fixed;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  background: linear-gradient(180deg, rgba(255, 255, 255, 0.95) 0%, white 100%);\n  backdrop-filter: blur(20rpx);\n  -webkit-backdrop-filter: blur(20rpx);\n  padding: 24rpx;\n  padding-bottom: calc(24rpx + env(safe-area-inset-bottom));\n  border-top: 1rpx solid rgba(115, 99, 255, 0.1);\n  z-index: 100;\n}\n\n.action-container {\n  display: flex;\n  gap: 16rpx;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.price-summary {\n  flex: 1;\n}\n\n.total-price {\n  font-size: 32rpx;\n  color: #ff4757;\n  font-weight: 600;\n}\n\n.submit-btn {\n  background: linear-gradient(135deg, #7363FF 0%, #FF69DE 100%);\n  color: #fff;\n  padding: 16rpx 32rpx;\n  border-radius: 99999rpx;\n  font-size: 26rpx;\n  font-weight: 500;\n  box-shadow: 0 4rpx 12rpx rgba(115, 99, 255, 0.3);\n  transition: all 0.3s ease;\n  border: 1rpx solid transparent;\n  box-sizing: border-box;\n  height: 72rpx;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  min-width: 120rpx;\n}\n\n.submit-btn:active {\n  background: linear-gradient(135deg, #6354e6 0%, #e55cc8 100%);\n  transform: scale(0.96);\n}\n\n/* 时间选择弹框样式 */\n.time-picker-content {\n  background: #ffffff;\n  border-radius: 20rpx 20rpx 0 0;\n  width: 100%;\n  height: 75vh;\n  position: relative;\n  z-index: 1001;\n}\n\n/* uni-popup 弹框圆角样式 */\n:deep(.uni-popup) {\n  border-radius: 20rpx 20rpx 0 0 !important;\n}\n\n\n/* 日期导航栏 */\n.day-filter {\n  background: #FFFFFF;\n  border-bottom: 1rpx solid #f0f0f0;\n  border-radius: 20rpx 20rpx 0 0\n\n}\n\n.day-scroll {\n  white-space: nowrap;\n}\n\n.day-tabs {\n  display: flex;\n  align-items: center;\n  height: 120rpx;\n  white-space: nowrap;\n  padding-left: 10rpx;\n  padding-right: 20rpx;\n  box-sizing: border-box;\n  position: relative;\n}\n\n.day-tab {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  position: relative;\n  padding: 20rpx;\n  box-sizing: border-box;\n  height: 45rpx;\n  flex-shrink: 0;\n  min-width: fit-content;\n}\n\n/* 去掉下划线 */\n\n.day-name {\n  font-size: 26rpx;\n  font-weight: 400;\n  color: #798079;\n  transition: color 0.3s ease;\n}\n\n.day-date {\n  font-size: 20rpx;\n  color: #999999;\n  transition: color 0.3s ease;\n  margin-top: 4rpx;\n}\n\n.day-tab.active .day-name {\n  font-size: 26rpx;\n  font-weight: 700;\n  color: #059C00;\n}\n\n.day-tab.active .day-date {\n  color: #059C00;\n}\n\n/* 时间段容器 */\n.time-slots-container {\n  padding: 32rpx;\n  max-height: 60vh;\n  overflow-y: auto;\n}\n\n.time-slots-grid {\n  display: grid;\n  grid-template-columns: repeat(5, 1fr);\n  gap: 16rpx;\n}\n\n.time-slot-item {\n  background: #f8f9fa;\n  border: 2rpx solid #e9ecef;\n  border-radius: 12rpx;\n  padding: 16rpx 8rpx;\n  text-align: center;\n  transition: all 0.3s ease;\n  cursor: pointer;\n}\n\n.time-slot-item:active {\n  transform: scale(0.95);\n}\n\n.time-slot-item.available {\n  background: #ffffff;\n  border-color: #e9ecef;\n}\n\n.time-slot-item.available:hover {\n  border-color: #7363FF;\n}\n\n.time-slot-item.unavailable {\n  background: #f8f9fa;\n  border-color: #e9ecef;\n  opacity: 0.6;\n  cursor: not-allowed;\n}\n\n.time-slot-item.unavailable .time-text,\n.time-slot-item.unavailable .status-text {\n  color: #cccccc;\n}\n\n.time-slot-item.selected {\n  background: linear-gradient(135deg, #7363FF 0%, #FF69DE 100%);\n  border-color: #7363FF;\n  box-shadow: 0 4rpx 16rpx rgba(115, 99, 255, 0.3);\n}\n\n.time-slot-item.selected .time-text,\n.time-slot-item.selected .status-text {\n  color: #ffffff;\n}\n\n.time-text {\n  font-size: 24rpx;\n  font-weight: 500;\n  color: #1a1a1a;\n  display: block;\n  margin-bottom: 4rpx;\n}\n\n.status-text {\n  font-size: 20rpx;\n  color: #666666;\n  display: block;\n}\n\n\n</style> ","import MiniProgramPage from '/Users/xiaoqiang/Documents/friemd/firend-loving-app/subPackages/order/submit.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","computed","uni","getServiceInfo","nextTick","calculateDistance","createOrderV2","orderParams","onMounted","getCompanionAvailableSchedule"],"mappings":"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"}