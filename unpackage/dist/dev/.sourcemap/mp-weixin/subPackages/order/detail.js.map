{"version":3,"file":"detail.js","sources":["subPackages/order/detail.vue","subPackages/order/detail.vue?type=page"],"sourcesContent":["<template>\n  <view class=\"order-detail-container\">\n    <scroll-view \n      scroll-y=\"true\" \n      class=\"scroll-content\" \n    >\n      <!-- 订单状态进度条 -->\n      <view class=\"status-progress\">\n       <view class=\"progress-header\">\n          <text class=\"progress-title\">订单进度</text>\n          <text class=\"current-status\" :class=\"getStatusClass(orderDetail.status)\">{{ getStatusText(orderDetail.status) }}</text>\n        </view>\n       \n      <view class=\"progress-steps\" v-if=\"userStore.switch == 1\">\n          <view \n            v-for=\"(step, index) in progressSteps\" \n            :key=\"index\"\n            class=\"progress-step\"\n            :class=\"getStepClass(step.status)\"\n          >\n            <view class=\"step-icon\">\n              <text class=\"icon-text\">{{ step.icon }}</text>\n            </view>\n            <view class=\"step-content\">\n              <text class=\"step-title\">{{ step.title }}</text>\n            </view>\n            <view \n              v-if=\"index < progressSteps.length - 1\" \n              class=\"step-connector\"\n              :class=\"getConnectorClass(step.status, progressSteps[index + 1].status)\"\n            ></view>\n          </view>\n        </view>\n      </view>\n\n\n\n      <!-- 服务信息 -->\n      <view class=\"service-section\">\n        <view class=\"section-header\">\n          <text class=\"section-title\">服务信息</text>\n        </view>\n        \n        <view class=\"service-card\">\n          <view class=\"service-info\">\n            <image :src=\"$imgBaseUrl + orderDetail.service_image_url\" class=\"service-image\" mode=\"aspectFill\" />\n            <view class=\"service-details\">\n              <text class=\"service-name\">{{ orderDetail.service_name }}</text>\n              <view class=\"service-meta\">\n                <text class=\"service-price\">¥{{ orderDetail.unit_price }}/{{ orderDetail.unit }}</text>\n                <text class=\"service-quantity\">x{{ orderDetail.quantity }}</text>\n              </view>\n              <view class=\"service-amount\">\n                <view></view>\n                 <view>\n                  <text class=\"amount-label\">订单金额：</text>\n                  <text class=\"amount-value\">¥{{ orderDetail.total_amount }}</text>\n                 </view>\n              </view>\n            </view>\n          </view>\n          \n          <!-- 服务地址和时间 -->\n          <view class=\"service-details-info\">\n            <view class=\"detail-item\">\n              <text class=\"detail-label\">服务信息：</text>\n              <view class=\"companion-info\">\n                <image \n                  :src=\"$imgBaseUrl +  orderDetail?.companion?.avatar\" \n                  class=\"companion-avatar\" \n                  mode=\"aspectFill\"\n                />\n                <text class=\"detail-value\">{{ orderDetail?.companion?.nickname}}</text>\n              </view>\n            </view>\n            <view class=\"detail-item\">\n              <text class=\"detail-label\">预约地址：</text>\n              <text class=\"detail-value\">{{ orderDetail.service_address }}</text>\n            </view>\n            <view class=\"detail-item\">\n              <text class=\"detail-label\">预约时间：</text>\n              <text class=\"detail-value\">{{ formatServiceDateTime(orderDetail.service_date, orderDetail.service_time) }}</text>\n            </view>\n          </view>\n        </view>\n      </view>\n\n      <!-- 订单信息 -->\n      <view class=\"order-info-section\">\n        <view class=\"section-header\">\n          <text class=\"section-title\">订单信息</text>\n        </view>\n        \n        <view class=\"detail-card\">\n          <view class=\"detail-item\">\n            <text class=\"detail-label\">订单号：</text>\n            <view class=\"detail-value-container\">\n              <text class=\"detail-value-order\">{{ orderDetail.order_no}}</text>\n              <image \n                src=\"/static/icons/common/copy.png\" \n                class=\"copy-icon\" \n                @click=\"copyOrderNo(orderDetail.order_no)\"\n                mode=\"aspectFit\"\n              />\n            </view>\n          </view>\n          <view v-if=\"orderDetail.start_time\" class=\"detail-item\">\n            <text class=\"detail-label\">开始时间：</text>\n            <text class=\"detail-value\">{{ formatTime(orderDetail.start_time) }}</text>\n          </view>\n          <view v-if=\"orderDetail.end_time\" class=\"detail-item\">\n            <text class=\"detail-label\">结束时间：</text>\n            <text class=\"detail-value\">{{ formatTime(orderDetail.end_time) }}</text>\n          </view>\n          <view class=\"detail-item\">\n            <text class=\"detail-label\">下单时间：</text>\n            <text class=\"detail-value\">{{ formatTime(orderDetail.created_at) }}</text>\n          </view>\n          <view v-if=\"orderDetail.payment_time\" class=\"detail-item\">\n            <text class=\"detail-label\">支付时间：</text>\n            <text class=\"detail-value\">{{ formatTime(orderDetail.payment_time) }}</text>\n          </view>\n          <view v-if=\"orderDetail.remark\" class=\"detail-item\">\n            <text class=\"detail-label\">备注：</text>\n            <text class=\"detail-value remark-text\">{{ orderDetail.remark }}</text>\n          </view>\n        </view>\n      </view>\n    </scroll-view>\n\n    <!-- 操作按钮 -->\n    <view class=\"action-buttons\">\n      <view class=\"action-container\">\n        <view \n          v-for=\"(action, index) in getOrderActions(orderDetail.status)\" \n          :key=\"index\"\n          class=\"action-btn\"\n          :class=\"action.type\"\n          @click=\"handleOrderAction(action.action, orderDetail)\"\n        >\n          <text class=\"action-text\">{{ action.text }}</text>\n          <!-- #ifdef MP-WEIXIN -->\n          <button v-if=\"action.text === '联系客服'\" open-type=\"contact\" class=\"kf_btn\" @tap.stop></button>\n          <!-- #endif -->\n        </view>\n      </view>\n    </view>\n  </view>\n</template>\n\n<script setup>\nimport { ref, onMounted } from 'vue'\nimport { onLoad } from '@dcloudio/uni-app'\nimport { getOrderDetail, orderParams, cancelOrder, deleteOrder } from '@/api/order.js'\nimport { useCityStore } from '@/stores/city.js'\nimport { useUserStore } from '@/stores/user.js'\n// 用户状态管理\nconst userStore = useUserStore()\n// 订单详情数据\nconst orderDetail = ref({})\nconst orderId = ref(null)\nconst cityStore = useCityStore()\n\n// 进度步骤配置\nconst progressSteps = ref([\n  { title: '友伴接单', icon: '✓', status: 'pending' },\n  { title: '友伴出发', icon: '✓', status: 'pending' },\n  { title: '友伴到达', icon: '✓', status: 'pending' },\n  { title: '开始服务', icon: '✓', status: 'pending' },\n  { title: '服务完成', icon: '✓', status: 'pending' }\n])\n\n// 页面加载\nonLoad((options) => {\n  if (options.orderId) {\n    orderId.value = options.orderId\n    loadOrderDetail()\n  }\n})\n\n// 加载订单详情\nconst loadOrderDetail = async () => {\n  try {\n    uni.showLoading({ title: '加载中...' })\n    \n    const response = await getOrderDetail({ order_id: Number(orderId.value)})\n     console.log(response.data)\n    if (response.data.code === 0) {\n      // 合并订单信息和日志数据\n      orderDetail.value = {\n        ...response.data.data.order,\n        logs: response.data.data.logs || []\n      }\n      updateProgressSteps()\n    } else {\n      throw new Error(response.data.msg || '获取订单详情失败')\n    }\n  } catch (error) {\n    console.error('加载订单详情失败:', error)\n    uni.showToast({\n      title: error.message || '加载失败',\n      icon: 'none'\n    })\n  } finally {\n    uni.hideLoading()\n  }\n}\n\n// 更新进度步骤\nconst updateProgressSteps = () => {\n  const logs = orderDetail.value.logs || []\n\n  // 重置所有步骤为未完成状态\n  progressSteps.value.forEach(step => {\n    step.status = 'pending'\n  })\n\n  // 根据日志数据更新进度步骤\n  // 步骤1：友伴接单11 - 查找状态为11的日志\n  const acceptLog = logs.find(log => log.status === 11)\n  if (acceptLog) {\n    progressSteps.value[0].status = 'completed'\n  }\n  \n  // 步骤2：友伴出发 - 查找状态为3的日志\n  const departLog = logs.find(log => log.status === 3)\n  if (departLog) {\n    progressSteps.value[1].status = 'completed'\n  }\n  \n  // 步骤3：友伴到达 - 查找状态为4的日志\n  const arriveLog = logs.find(log => log.status === 4)\n  if (arriveLog) {\n    progressSteps.value[2].status = 'completed'\n  }\n  \n  // 步骤4：开始服务 - 查找状态为5的日志\n  const startLog = logs.find(log => log.status === 5)\n  if (startLog) {\n    progressSteps.value[3].status = 'completed'\n  }\n  \n  // 步骤5：服务完成 - 查找状态为6的日志\n  const completeLog = logs.find(log => log.status === 6)\n  if (completeLog) {\n    progressSteps.value[4].status = 'completed'\n  }\n}\n\n// 获取步骤样式类\nconst getStepClass = (status) => {\n  return status\n}\n\n// 获取连接线样式类\nconst getConnectorClass = (currentStatus, nextStatus) => {\n  if (currentStatus === 'completed') {\n    return 'completed'\n  }\n  return 'pending'\n}\n\n// 获取状态样式类\nconst getStatusClass = (status) => {\n  const statusMap = {\n    1: 'status-pending',      // 待付款\n    2: 'status-to-serve',     // 待服务（已支付待确认）\n    3: 'status-to-serve',     // 待服务（已确认待到达）\n    4: 'status-to-serve',     // 待服务（已到达待开始）\n    5: 'status-in-progress',  // 进行中\n    6: 'status-completed',    // 已完成\n    7: 'status-cancelled',    // 已取消\n    8: 'status-refunded',     // 已退款\n    9: 'status-refunding',    // 退款中\n    10: 'status-cancelled',   // 超时取消\n    11: 'status-to-serve'     // 待服务（已确认待开始出发）\n  }\n  return statusMap[status] || 'status-default'\n}\n\n// 获取状态文本\nconst getStatusText = (status) => {\n  const statusMap = {\n    1: '待付款',\n    2: '等待接单',\n    3: '友伴已出发',\n    4: '友伴已到达',\n    5: '进行中',\n    6: '已完成',\n    7: '已取消',\n    8: '已退款',\n    9: '退款中',\n    10: '超时取消',\n    11: '已接单，等待出发'\n  }\n  return statusMap[status] || '未知状态'\n}\n\n// 获取订单操作按钮\nconst getOrderActions = (status) => {\n  const actionMap = {\n    1: [ // 待支付\n      { text: '取消订单', action: 'cancel', type: 'secondary' },\n      { text: '立即支付', action: 'pay', type: 'primary' }\n    ],\n    2: [ // 已支付待确认\n      { text: '申请退款', action: 'refund', type: 'secondary' },\n      { text: '联系友伴', action: 'contact', type: 'primary' }\n    ],\n    3: [ // 已出发待到达\n      { text: '申请退款', action: 'refund', type: 'secondary' },\n      { text: '联系友伴', action: 'contact', type: 'primary' }\n    ],\n    4: [ // 已到达待开始\n      { text: '申请退款', action: 'refund', type: 'secondary' },\n      { text: '开始服务', action: 'start', type: 'start' }\n    ],\n    5: [ // 服务中\n      // { text: '续钟', action: 'extend', type: 'primary' },\n      { text: '联系友伴', action: 'contact', type: 'secondary' }\n    ],\n    6: [ // 已完成\n      { text: orderDetail.value.is_comment === 1 ? '查看评价' : '去评价', action: orderDetail.value.is_comment === 1 ? 'viewComment' : 'evaluate', type: 'primary' },\n      { text: '再次预约', action: 'rebook', type: 'secondary' }\n    ],\n    7: [ // 已取消\n      { text: '删除订单', action: 'delete', type: 'secondary' }\n    ],\n    8: [ // 已退款\n      { text: '删除订单', action: 'delete', type: 'secondary' }\n    ],\n    9: [ // 退款中\n      { text: '联系客服', action: 'contact', type: 'primary' }\n    ],\n    10: [ // 订单超时取消\n      { text: '删除订单', action: 'delete', type: 'secondary' }\n    ],\n    11: [ // 已确认待开始出发\n      { text: '申请退款', action: 'refund', type: 'secondary' },\n      { text: '联系友伴', action: 'contact', type: 'primary' }\n    ]\n  }\n  return actionMap[status] || []\n}\n\n// 处理订单操作\nconst handleOrderAction = (action, order) => {\n  switch (action) {\n    case 'cancel':\n      handleCancelOrder(order)\n      break\n    case 'refund':\n      handleApplyRefund(order)\n      break\n    case 'pay':\n      handlePayOrder(order)\n      break\n    case 'contact':\n      // 联系友伴功能已移除\n      uni.showToast({\n        title: '联系功能暂不可用',\n        icon: 'none'\n      })\n      break\n    case 'extend':\n      handleExtendOrder(order)\n      break\n    case 'rebook':\n      handleRebookOrder(order)\n      break\n    case 'delete':\n      handleDeleteOrder(order)\n      break\n    case 'start':\n      handleStartService(order)\n      break\n    case 'evaluate':\n      handleEvaluateOrder(order)\n      break\n    case 'viewComment':\n      handleViewComment(order)\n      break\n  }\n}\n\n\n\n// 取消订单\nconst handleCancelOrder = (order) => {\n  uni.showModal({\n    title: '取消订单',\n    content: '确定要取消这个订单吗？',\n    confirmText: '确定取消',\n    cancelText: '再想想',\n    success: async (res) => {\n      if (res.confirm) {\n        try {\n          // 显示加载提示\n          uni.showLoading({\n            title: '取消中...'\n          })\n          \n          // 调用取消订单API\n          const cancelData = {\n            order_id: order.id,\n            cancel_reason: '用户取消'\n          }\n          \n          const response = await cancelOrder(cancelData)\n          \n          if (response.data.code === 0) {\n            uni.showToast({\n              title: '订单已取消',\n              icon: 'success'\n            })\n            \n            // 通知订单列表页面更新数据\n            uni.$emit('orderStatusChanged', {\n              type: 'cancel',\n              orderId: order.id,\n              status: 7 // 已取消状态\n            })\n            \n            // 刷新订单详情\n            setTimeout(() => {\n              loadOrderDetail()\n            }, 1500)\n          } else {\n            throw new Error(response.data.msg || '取消订单失败')\n          }\n        } catch (error) {\n          console.error('取消订单失败:', error)\n          uni.showToast({\n            title: error.message || '取消订单失败',\n            icon: 'none'\n          })\n        } finally {\n          uni.hideLoading()\n        }\n      }\n    }\n  })\n}\n\n// 申请退款\nconst handleApplyRefund = (order) => {\n  uni.showModal({\n    title: '申请退款',\n    content: '确定要申请退款吗？',\n    confirmText: '申请退款',\n    cancelText: '取消',\n    success: (res) => {\n      if (res.confirm) {\n        // 这里调用申请退款API\n        uni.showToast({\n          title: '退款申请已提交',\n          icon: 'success'\n        })\n      }\n    }\n  })\n}\n\n// 支付订单\nconst handlePayOrder = async (order) => {\n  try {\n    // 显示加载提示\n    uni.showLoading({\n      title: '处理中...'\n    })\n    \n    // 调用支付参数接口\n    const orderParamsData = {\n      order_id: order.id,\n      payment_method: 1\n    }\n    \n    const paramsResponse = await orderParams(orderParamsData)\n    \n    if (paramsResponse.data.code === 0) {\n      // 调用微信支付\n      uni.requestPayment({\n        provider: 'wxpay',\n        ...paramsResponse.data.data.pay_params,\n        success: (res) => {\n          console.log('支付成功', res);\n          uni.showToast({\n            title: '支付成功',\n            icon: 'success',\n          });\n          // 支付成功后刷新订单详情\n          setTimeout(() => {\n            loadOrderDetail()\n          }, 1500)\n        },\n        fail: (err) => {\n          console.error('支付失败', JSON.stringify(err));\n          uni.showToast({\n            title: '支付失败',\n            icon: 'none'\n          })\n        },\n      });\n    } else {\n      throw new Error(paramsResponse.data.msg || '获取支付参数失败')\n    }\n  } catch (error) {\n    console.error('支付失败:', error)\n    uni.showToast({\n      title: error.message || '支付失败',\n      icon: 'none'\n    })\n  } finally {\n    uni.hideLoading()\n  }\n}\n\n// 开始服务\nconst handleStartService = (order) => {\n  uni.showModal({\n    title: '开始服务',\n    content: '确认友伴师已到达并开始服务吗？',\n    confirmText: '开始服务',\n    cancelText: '取消',\n    success: (res) => {\n      if (res.confirm) {\n        // 这里调用开始服务API\n        uni.showToast({\n          title: '服务已开始',\n          icon: 'success'\n        })\n      }\n    }\n  })\n}\n\n// 续钟\nconst handleExtendOrder = (order) => {\n  uni.navigateTo({\n    url: `/subPackages/order/extend?orderId=${order.id}`\n  })\n}\n\n// 再次预约\nconst handleRebookOrder = (order) => {\n  if (order.companion_id) {\n    let url = '/subPackages/friend/detail?id=' + order.companion_id + '&city_code=' + cityStore.currentCityCode\n    \n    uni.navigateTo({\n      url: url\n    })\n  } else {\n    uni.showToast({\n      title: '友伴信息不存在',\n      icon: 'none'\n    })\n  }\n}\n\n// 评价订单\nconst handleEvaluateOrder = (order) => {\n  // 跳转到评价页面，传递必要参数\n  uni.navigateTo({\n    url: `/subPackages/order/evaluate?orderId=${order.id}&serviceName=${encodeURIComponent(order.service_name)}&serviceImage=${encodeURIComponent(order.service_image_url)}`\n  })\n}\n\n// 查看评价\nconst handleViewComment = (order) => {\n  // 跳转到评价详情页面\n  uni.navigateTo({\n    url: `/subPackages/order/evaluate-detail?orderId=${order.id}`\n  })\n}\n\n// 删除订单\nconst handleDeleteOrder = (order) => {\n  uni.showModal({\n    title: '删除订单',\n    content: '确定要删除这个订单吗？删除后不可恢复。',\n    confirmText: '删除',\n    cancelText: '取消',\n    success: async (res) => {\n      if (res.confirm) {\n        try {\n          uni.showLoading({\n            title: '删除中...'\n          })\n          \n          // 调用删除订单API\n          const deleteData = {\n            order_id: order.id\n          }\n          \n          const response = await deleteOrder(deleteData)\n          \n          if (response.data.code === 0) {\n            uni.showToast({\n              title: '订单已删除',\n              icon: 'success'\n            })\n            \n            // 通知订单列表页面更新数据\n            uni.$emit('orderOrderDeleted', {\n              orderId: order.id,\n              status: order.status\n            })\n            \n            // 删除成功后返回上一页\n            setTimeout(() => {\n              uni.navigateBack()\n            }, 1500)\n          } else {\n            throw new Error(response.data.msg || '删除订单失败')\n          }\n        } catch (error) {\n          console.error('删除订单失败:', error)\n          uni.showToast({\n            title: error.message || '删除订单失败',\n            icon: 'none'\n          })\n        } finally {\n          uni.hideLoading()\n        }\n      }\n    }\n  })\n}\n\n// 格式化时间\nconst formatTime = (timeStr) => {\n  if (!timeStr) return ''\n  \n  const date = new Date(timeStr)\n  const year = date.getFullYear()\n  const month = String(date.getMonth() + 1).padStart(2, '0')\n  const day = String(date.getDate()).padStart(2, '0')\n  const hours = String(date.getHours()).padStart(2, '0')\n  const minutes = String(date.getMinutes()).padStart(2, '0')\n  \n  return `${year}-${month}-${day} ${hours}:${minutes}`\n}\n\n// 复制订单号\nconst copyOrderNo = (orderNo) => {\n  if (!orderNo) {\n    uni.showToast({\n      title: '订单号为空',\n      icon: 'none'\n    })\n    return\n  }\n  \n  uni.setClipboardData({\n    data: orderNo,\n    success: () => {\n      uni.showToast({\n        title: '订单号已复制',\n        icon: 'success'\n      })\n    },\n    fail: () => {\n      uni.showToast({\n        title: '复制失败',\n        icon: 'none'\n      })\n    }\n  })\n}\n\n// 格式化服务日期和时间\nconst formatServiceDateTime = (serviceDate, serviceTime) => {\n  if (!serviceDate && !serviceTime) return '待确认'\n  \n  let result = ''\n  \n  // 处理服务日期\n  if (serviceDate) {\n    const date = new Date(serviceDate)\n    const year = date.getFullYear()\n    const month = String(date.getMonth() + 1).padStart(2, '0')\n    const day = String(date.getDate()).padStart(2, '0')\n    const weekday = ['周日', '周一', '周二', '周三', '周四', '周五', '周六'][date.getDay()]\n    result += `${year}-${month}-${day} ${weekday}`\n  }\n  \n  // 处理时间段\n  if (serviceTime) {\n    if (result) {\n      result += ' '\n    }\n    result += serviceTime\n  }\n  \n  return result || '待确认'\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.order-detail-container {\n  min-height: 100vh;\n  background-color: #F7F8FA;\n  padding-bottom: calc(120rpx + env(safe-area-inset-bottom));\n}\n\n.scroll-content {\n  height: calc(100vh - 120rpx);\n  padding-bottom: 20rpx;\n}\n\n/* 订单状态进度条 */\n.status-progress {\n  background: #FFFFFF;\n  margin: 20rpx;\n  border-radius: 20rpx;\n  padding: 30rpx;\n\n}\n\n.progress-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 30rpx;\n}\n\n.progress-title {\n  font-size: 28rpx;\n  font-weight: 500;\n  color: #1A1A1A;\n}\n.section-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 30rpx;\n}\n\n.section-title {\n  font-size: 28rpx;\n  font-weight: 500;\n  color: #1A1A1A;\n}\n\n\n\n.current-status {\n  font-size: 24rpx;\n  font-weight: 400;\n}\n\n/* 状态颜色样式 */\n.current-status.status-pending {\n  color: #ff6b35;\n}\n\n.current-status.status-to-serve {\n  color: #007bff;\n}\n\n.current-status.status-in-progress {\n  color: #28a745;\n}\n\n.current-status.status-completed {\n  color: #6c757d;\n}\n\n.current-status.status-cancelled {\n  color: #b0b0b0;\n}\n\n.current-status.status-refunded {\n  color: #00bcd4;\n}\n\n.current-status.status-refunding {\n  color: #ff9800;\n}\n\n.progress-steps {\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  gap: 8rpx;\n}\n\n.progress-step {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  flex: 1;\n  gap: 16rpx;\n  position: relative;\n}\n\n.step-icon {\n  width: 32rpx;\n  height: 32rpx;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-shrink: 0;\n  position: relative;\n  z-index: 2;\n}\n\n.step-icon .icon-text {\n  font-size: 18rpx;\n  font-weight: bold;\n}\n\n.progress-step.completed .step-icon {\n  background: #4CAF50;\n  color: #FFFFFF;\n}\n\n\n\n.progress-step.pending .step-icon {\n  background: #E0E0E0;\n  color: #999999;\n}\n\n.step-content {\n  text-align: center;\n}\n\n.step-title {\n  font-size: 24rpx;\n  color: #1A1A1A;\n  font-weight: 500;\n  display: block;\n}\n\n.step-connector {\n  position: absolute;\n  top: 16rpx;\n  left: calc(70% + 16rpx);\n  width: 40%;\n  height: 2rpx;\n  background-color: #E0E0E0;\n  z-index: 1;\n}\n\n.step-connector.completed {\n  background-color: #4CAF50;\n}\n\n.step-connector.pending {\n  background-color: #E0E0E0;\n}\n\n\n\n/* 服务信息 */\n.service-section {\n  background: #FFFFFF;\n  margin: 20rpx;\n  border-radius: 20rpx;\n  padding: 30rpx;\n\n}\n\n.service-card {\n  margin-top: 24rpx;\n}\n\n.service-info {\n  display: flex;\n  gap: 20rpx;\n}\n\n.service-image {\n  width: 120rpx;\n  height: 120rpx;\n  border-radius: 12rpx;\n  flex-shrink: 0;\n}\n\n.service-details {\n  flex: 1;\n}\n\n.service-name {\n  font-size: 28rpx;\n  color: #1A1A1A;\n  font-weight: 500;\n  display: block;\n  margin-bottom: 12rpx;\n}\n\n.service-meta {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 12rpx;\n}\n\n.service-price {\n  font-size: 26rpx;\n  color: #666666;\n}\n\n.service-quantity {\n  font-size: 26rpx;\n  color: #666666;\n}\n\n.service-amount {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n}\n\n.amount-label {\n  font-size: 26rpx;\n  color: #666666;\n}\n\n.amount-value {\n  font-size: 28rpx;\n  color: #f43f5e;\n  font-weight: 600;\n}\n\n/* 服务详情信息 */\n.service-details-info {\n  margin-top: 24rpx;\n  padding-top: 24rpx;\n  border-top: 1rpx solid #f0f0f0;\n}\n\n/* 订单信息 */\n.order-info-section {\n  background: #FFFFFF;\n  margin: 20rpx;\n  border-radius: 16rpx;\n  padding: 20rpx;\n\n}\n\n.detail-card {\n  margin-top: 24rpx;\n}\n\n.detail-item {\n  display: flex;\n  margin-bottom: 16rpx;\n}\n\n.detail-item:last-child {\n  margin-bottom: 0;\n}\n\n.detail-label {\n  font-size: 24rpx;\n  color: #666666;\n  min-width: 140rpx;\n\n}\n\n.detail-value-container {\n  display: flex;\n  align-items: center;\n  flex: 1;\n  gap: 16rpx;\n}\n\n.detail-value {\n  font-size: 24rpx;\n  color: #1A1A1A;\n  flex: 1;\n\n}\n.detail-value-order {\n  font-size: 24rpx;\n  color: #1A1A1A;\n\n\n}\n.copy-icon {\n  width: 28rpx;\n  height: 28rpx;\n  flex-shrink: 0;\n  opacity: 0.6;\n  transition: opacity 0.2s ease;\n}\n\n.copy-icon:active {\n  opacity: 1;\n  transform: scale(0.9);\n}\n\n/* 友伴信息样式 */\n.companion-info {\n  display: flex;\n  align-items: center;\n  flex: 1;\n  gap: 12rpx;\n}\n\n.companion-avatar {\n  width: 40rpx;\n  height: 40rpx;\n  border-radius: 50%;\n  flex-shrink: 0;\n}\n\n\n/* 操作按钮 */\n.action-buttons {\n  position: fixed;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  background: linear-gradient(180deg, rgba(255, 255, 255, 0.95) 0%, white 100%);\n  backdrop-filter: blur(20rpx);\n  -webkit-backdrop-filter: blur(20rpx);\n  padding: 24rpx;\n  padding-bottom: calc(24rpx + env(safe-area-inset-bottom));\n  border-top: 1rpx solid rgba(115, 99, 255, 0.1);\n\n  z-index: 100;\n}\n\n.action-container {\n  display: flex;\n  gap: 16rpx;\n  justify-content: flex-end;\n}\n\n.action-btn {\n  padding: 16rpx 32rpx;\n  border-radius: 99999rpx;\n  font-size: 26rpx;\n  font-weight: 500;\n  transition: all 0.3s ease;\n  border: 1rpx solid transparent;\n  box-sizing: border-box;\n  height: 72rpx;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  min-width: 120rpx;\n  position: relative;\n}\n\n.action-btn.primary {\n  background: #7363FF;\n  color: #FFFFFF;\n  border-color: #7363FF;\n}\n\n.action-btn.primary:active {\n  background: #6354e6;\n  transform: scale(0.96);\n}\n\n.action-btn.secondary {\n  background: #FFFFFF;\n  color: #666666;\n  border-color: #e9ecef;\n}\n\n.action-btn.secondary:active {\n  background: #f8f9fa;\n  transform: scale(0.96);\n}\n\n.action-btn.start {\n  background: #F44336;\n  color: #FFFFFF;\n  border-color: #F44336;\n}\n\n.action-btn.start:active {\n  background: #d32f2f;\n  transform: scale(0.96);\n}\n\n.action-btn.danger {\n  background: #F44336;\n  color: #FFFFFF;\n  border-color: #F44336;\n}\n\n.action-btn.danger:active {\n  background: #d32f2f;\n  transform: scale(0.96);\n}\n\n/* 微信客服透明覆盖按钮 */\n.kf_btn {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  width: 100%;\n  height: 100%;\n  margin: 0;\n  padding: 0;\n  background: transparent !important;\n  opacity: 0;\n  border: none;\n  z-index: 5;\n}\n.kf_btn::after {\n  border: none;\n}\n\n\n</style>\n\n\n","import MiniProgramPage from '/Users/xiaoqiang/Documents/friemd/firend-loving-app/subPackages/order/detail.vue'\nwx.createPage(MiniProgramPage)"],"names":["userStore","useUserStore","orderDetail","ref","orderId","cityStore","useCityStore","progressSteps","onLoad","options","loadOrderDetail","uni","response","getOrderDetail","updateProgressSteps","error","logs","step","log","getStepClass","status","getConnectorClass","currentStatus","nextStatus","getStatusClass","getStatusText","getOrderActions","handleOrderAction","action","order","handleCancelOrder","handleApplyRefund","handlePayOrder","handleExtendOrder","handleRebookOrder","handleDeleteOrder","handleStartService","handleEvaluateOrder","handleViewComment","res","cancelData","cancelOrder","orderParamsData","paramsResponse","orderParams","err","url","deleteData","deleteOrder","formatTime","timeStr","date","year","month","day","hours","minutes","copyOrderNo","orderNo","formatServiceDateTime","serviceDate","serviceTime","result","weekday","MiniProgramPage"],"mappings":"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"}